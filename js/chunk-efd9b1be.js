(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-efd9b1be"],{"012be":function(e,t,i){"use strict";i("4988")},"09c1":function(e,t,i){},1431:function(e,t,i){},"1b84":function(e,t,i){"use strict";i("667f")},"1d51":function(e,t,i){"use strict";i("c1c8")},"200a7":function(e,t,i){"use strict";i("62f5")},"29e4":function(e,t,i){"use strict";i("37ae")},"2aa2":function(e,t,i){"use strict";i("a8a4")},"2c92":function(e,t,i){"use strict";i("b94b")},"2e7a":function(e,t,i){"use strict";i("abb3")},"309d":function(e,t,i){},"30b5":function(e,t,i){},"319b":function(e,t,i){},3216:function(e,t,i){"use strict";i("3593")},3277:function(e,t,i){},3464:function(e,t,i){"use strict";i("fea5")},3593:function(e,t,i){},"37ae":function(e,t,i){},3876:function(e,t,i){"use strict";i("6f41")},"3a41":function(e,t,i){},"3e47":function(e,t,i){},"3eb8":function(e,t,i){},"40a8":function(e,t,i){},4125:function(e,t,i){},"46ce":function(e,t,i){"use strict";i("6979")},4988:function(e,t,i){},"4ec7":function(e,t,i){"use strict";i("09c1")},5193:function(e,t,i){},"525b":function(e,t,i){"use strict";i("ca46")},"58ec":function(e,t,i){"use strict";i("309d")},"5c81":function(e,t){e.exports=function(e,t=window.externalPublicPath){var i,s="application/vnd.ms-excel",a=e,n=a.outerHTML.replace(/ /g,"%20");if(t=t?t+".xls":"excel_data.xls",i=document.createElement("a"),document.body.appendChild(i),navigator.msSaveOrOpenBlob){var o=new Blob(["\ufeff",n],{type:s});navigator.msSaveOrOpenBlob(o,t)}else i.href="data:"+s+", "+n,i.download=t,i.click()}},"5f49":function(e,t,i){"use strict";i("afd0")},"5f62":function(e,t,i){"use strict";i("5fbb")},"5fbb":function(e,t,i){},"62f5":function(e,t,i){},"64f0":function(e,t,i){"use strict";i("baab")},"660e":function(e,t,i){},6625:function(e,t,i){},"667f":function(e,t,i){},6979:function(e,t,i){},"6af7":function(e,t,i){"use strict";i("df21")},"6c88":function(e,t,i){},"6e1c":function(e,t,i){},"6f41":function(e,t,i){},7506:function(e,t,i){},7931:function(e,t,i){"use strict";i("3277")},"7adb":function(e,t,i){},"7e07":function(e,t,i){"use strict";i("6625")},8152:function(e,t,i){"use strict";i("3e47")},"870a":function(e,t,i){},8936:function(e,t,i){"use strict";i("7adb")},"8a65":function(e,t,i){},9155:function(e,t,i){"use strict";i("3eb8")},9194:function(e,t,i){},"91d9":function(e,t,i){"use strict";i("660e")},"92bc":function(e,t,i){"use strict";i("ac23")},9454:function(e,t,i){"use strict";i("ffd8")},9684:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container",class:{isDark:e.isDark,activeSidebar:e.activeSidebar}},[e.show?[e.isZenMode?e._e():t("Toolbar"),t("Edit")]:e._e()],2)},a=[],n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"toolbarContainer",class:{isDark:e.isDark}},[t("div",{ref:"toolbarRef",staticClass:"toolbar"},[t("div",{staticClass:"toolbarBtn",on:{click:e.goback}},[t("span",{staticClass:"icon iconfont iconhoutui-shi"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.goback")))])]),t("div",{staticClass:"toolbarBtn",on:{click:function(t){e.historicalDialogVisible=!0}}},[t("span",{staticClass:"icon iconfont iconshuaxin"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.refresh")))])])]),t("NodeImage"),t("NodeHyperlink"),t("NodeIcon"),t("NodeNote"),t("NodeTag"),t("Export"),t("Import",{ref:"ImportRef",on:{sendData:e.handleData}}),t("CaseNavigation",{on:{sendData:e.handleData}}),t("AddCase",{on:{sendData:e.handleData}}),t("Login",{on:{sendData:e.handleData}}),t("Collaborate"),t("Log"),t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"另存为",visible:e.addDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.addDialogVisible=t}}},[t("div",[t("el-container",{staticStyle:{height:"450px",border:"1px solid #eee"}},[t("el-aside",{attrs:{width:"100%"}},[t("el-input",{attrs:{size:"small",placeholder:"输入关键字查询~"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),t("el-tree",{ref:"tree",attrs:{data:e.setTree,"node-key":"id","highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"render-content":e.renderContent,"default-expanded-keys":e.defaultExpandKeys,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}})],1)],1)],1),t("div",{staticStyle:{height:"5px"}}),t("el-button",{staticStyle:{"margin-left":"75%"},attrs:{size:"small",type:"success"},on:{click:e.savaAs}},[e._v("保存")]),t("br"),t("el-link",{attrs:{type:"success"}},[e._v("当前选中："+e._s(this.xuanzhong))])],1),t("el-dialog",{attrs:{title:"提示",visible:e.historicalDialogVisible,width:"25%",center:""},on:{"update:visible":function(t){e.historicalDialogVisible=t}}},[t("span",[e._v("确定恢复到当前版本吗？恢复到当前版本后会覆盖原有数据!")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.historicalDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.clickHistoricalDialogVisible}},[e._v("确 定")])],1)])],1)},o=[],l=(i("d9e2"),i("14d9"),function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"nodeImageDialog",attrs:{title:e.$t("nodeImage.title"),visible:e.dialogVisible,width:e.isMobile?"90%":"50%",top:e.isMobile?"20px":"15vh"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"title"},[e._v("方式一")]),t("ImgUpload",{ref:"ImgUpload",staticStyle:{"margin-bottom":"12px"},model:{value:e.img,callback:function(t){e.img=t},expression:"img"}}),t("div",{staticClass:"title"},[e._v("方式二")]),t("div",{staticClass:"inputBox"},[t("span",{staticClass:"label"},[e._v("请输入图片地址")]),t("el-input",{attrs:{size:"mini",placeholder:"http://xxx.com/xx.jpg"},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.imgUrl,callback:function(t){e.imgUrl=t},expression:"imgUrl"}})],1),t("div",{staticClass:"title"},[e._v("可选")]),t("div",{staticClass:"inputBox"},[t("span",{staticClass:"label"},[e._v(e._s(e.$t("nodeImage.imgTitle")))]),t("el-input",{attrs:{size:"mini"},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.imgTitle,callback:function(t){e.imgTitle=t},expression:"imgTitle"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("dialog.cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("dialog.confirm")))])],1)],1)}),r=[],c=i("5aa9"),d=i("1e42"),h={name:"NodeImage",components:{ImgUpload:c["a"]},data(){return{dialogVisible:!1,img:"",imgUrl:"",imgTitle:"",activeNodes:null,isMobile:Object(d["V"])()}},created(){this.$bus.$on("node_active",this.handleNodeActive),this.$bus.$on("showNodeImage",this.handleShowNodeImage)},beforeDestroy(){this.$bus.$off("node_active",this.handleNodeActive),this.$bus.$off("showNodeImage",this.handleShowNodeImage)},methods:{handleNodeActive(...e){this.activeNodes=[...e[1]]},handleShowNodeImage(){if(this.reset(),this.activeNodes.length>0){let e=this.activeNodes[0],t=e.getData("image")||"";t&&(/^https?:\/\//.test(t)?this.imgUrl=t:this.img=t),this.imgTitle=e.getData("imageTitle")||""}this.dialogVisible=!0},cancel(){this.dialogVisible=!1,this.reset()},reset(){this.img="",this.imgTitle="",this.imgUrl=""},async confirm(){try{if(!this.img&&!this.imgUrl)return this.cancel(),void this.activeNodes.forEach(e=>{e.setImage(null)});let e=null,t="";this.img?(t=this.img,e=await this.$refs.ImgUpload.getSize()):this.imgUrl&&(t=this.imgUrl,e=await Object(d["D"])(t)),this.activeNodes.forEach(i=>{i.setImage({url:t||"none",title:this.imgTitle,width:e.width,height:e.height})}),this.cancel()}catch(e){console.log(e)}}}},u=h,m=(i("6af7"),i("2877")),p=Object(m["a"])(u,l,r,!1,null,"2789f0f2",null),g=p.exports,f=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"nodeHyperlinkDialog",attrs:{title:e.$t("nodeHyperlink.title"),visible:e.dialogVisible,width:e.isMobile?"90%":"50%",top:e.isMobile?"20px":"15vh"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"item"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("nodeHyperlink.link")))]),t("el-input",{attrs:{size:"mini",placeholder:"http://xxxx.com/"},on:{blur:function(t){return e.handleUrl()}},nativeOn:{keyup:function(e){e.stopPropagation()},keydown:function(e){e.stopPropagation()}},model:{value:e.link,callback:function(t){e.link=t},expression:"link"}},[t("el-select",{staticStyle:{width:"80px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.protocol,callback:function(t){e.protocol=t},expression:"protocol"}},[t("el-option",{attrs:{label:"https",value:"https"}}),t("el-option",{attrs:{label:"http",value:"http"}}),t("el-option",{attrs:{label:"无",value:"none"}})],1)],1)],1),t("div",{staticClass:"item"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("nodeHyperlink.name")))]),t("el-input",{attrs:{size:"mini"},nativeOn:{keyup:function(e){e.stopPropagation()},keydown:function(e){e.stopPropagation()}},model:{value:e.linkTitle,callback:function(t){e.linkTitle=t},expression:"linkTitle"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("dialog.cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("dialog.confirm")))])],1)])},b=[],v={name:"NodeHyperlink",data(){return{dialogVisible:!1,link:"",linkTitle:"",activeNodes:[],protocol:"https",isMobile:Object(d["V"])()}},created(){this.$bus.$on("node_active",this.handleNodeActive),this.$bus.$on("showNodeLink",this.handleShowNodeLink)},beforeDestroy(){this.$bus.$off("node_active",this.handleNodeActive),this.$bus.$off("showNodeLink",this.handleShowNodeLink)},methods:{handleNodeActive(...e){if(this.activeNodes=[...e[1]],this.activeNodes.length>0){let e=this.activeNodes[0];this.link=e.getData("hyperlink")||"",this.handleUrl(!0),this.linkTitle=e.getData("hyperlinkTitle")||""}else this.link="",this.linkTitle=""},removeProtocol(e){return e.replace(/^https?:\/\//,"")},handleUrl(e){const t=this.link.match(/^(https?):\/\//);t&&t[1]?this.protocol=t[1]:this.link?e&&(this.protocol="none"):this.protocol="https",this.link=this.removeProtocol(this.link)},handleShowNodeLink(){this.dialogVisible=!0},cancel(){this.dialogVisible=!1},confirm(){this.activeNodes.forEach(e=>{e.setHyperlink(("none"===this.protocol?"":this.protocol+"://")+this.link,this.linkTitle),this.cancel()})}}},y=v,C=(i("1d51"),Object(m["a"])(y,f,b,!1,null,"9b8d7662",null)),w=C.exports,_=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"nodeIconDialog",attrs:{title:e.$t("nodeIcon.title"),visible:e.dialogVisible,width:"500"},on:{"update:visible":function(t){e.dialogVisible=t}}},e._l(e.nodeIconList,(function(i){return t("div",{key:i.name,staticClass:"item"},[t("div",{staticClass:"title"},[e._v(e._s(i.name))]),t("div",{staticClass:"list"},e._l(i.list,(function(s){return t("div",{key:s.name,staticClass:"icon",class:{selected:e.iconList.includes(i.type+"_"+s.name)},domProps:{innerHTML:e._s(e.getHtml(s.icon))},on:{click:function(t){return e.setIcon(i.type,s.name)}}})})),0)])})),0)},x=[],k=i("723f"),S=i("d1f7"),$={name:"NodeIcon",data(){return{nodeIconList:[...k["b"],...S["a"]],dialogVisible:!1,iconList:[],activeNodes:[]}},created(){this.$bus.$on("node_active",this.handleNodeActive),this.$bus.$on("showNodeIcon",this.handleShowNodeIcon)},beforeDestroy(){this.$bus.$off("node_active",this.handleNodeActive),this.$bus.$off("showNodeIcon",this.handleShowNodeIcon)},methods:{handleNodeActive(...e){if(this.activeNodes=[...e[1]],this.activeNodes.length>0){let e=this.activeNodes[0];this.iconList=e.getData("icon")||[]}else this.iconList=[]},handleShowNodeIcon(){this.dialogVisible=!0},getHtml(e){return/^<svg/.test(e)?e:`<img src="${e}" />`},setIcon(e,t){let i=e+"_"+t,s=this.iconList.findIndex(e=>e===i);if(-1!==s)this.iconList.splice(s,1);else{let t=this.iconList.findIndex(t=>t.split("_")[0]===e);-1!==t?this.iconList.splice(t,1,i):this.iconList.push(i)}this.activeNodes.forEach(e=>{e.setIcon([...this.iconList])})}}},D=$,T=(i("3464"),Object(m["a"])(D,_,x,!1,null,"53e7130b",null)),N=T.exports,L=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"nodeNoteDialog",attrs:{title:e.$t("nodeNote.title"),visible:e.dialogVisible,width:e.isMobile?"90%":"50%",top:e.isMobile?"20px":"15vh"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{ref:"noteEditor",staticClass:"noteEditor",on:{keyup:function(e){e.stopPropagation()},keydown:function(e){e.stopPropagation()}}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("dialog.cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("dialog.confirm")))])],1)])},M=[],I=i("5865"),O=(i("f513"),{name:"NodeNote",data(){return{dialogVisible:!1,note:"",activeNodes:[],editor:null,isMobile:Object(d["V"])()}},watch:{dialogVisible(e,t){!e&&t&&this.$bus.$emit("endTextEdit")}},created(){this.$bus.$on("node_active",this.handleNodeActive),this.$bus.$on("showNodeNote",this.handleShowNodeNote)},beforeDestroy(){this.$bus.$off("node_active",this.handleNodeActive),this.$bus.$off("showNodeNote",this.handleShowNodeNote)},methods:{handleNodeActive(...e){if(this.activeNodes=[...e[1]],this.activeNodes.length>0){let e=this.activeNodes[0];this.note=e.getData("note")||""}else this.note=""},handleShowNodeNote(){this.$bus.$emit("startTextEdit"),this.dialogVisible=!0,this.$nextTick(()=>{this.initEditor()})},initEditor(){this.editor||(this.editor=new I["a"]({el:this.$refs.noteEditor,height:"500px",initialEditType:"markdown",previewStyle:"vertical"})),this.editor.setMarkdown(this.note)},cancel(){this.dialogVisible=!1},confirm(){this.note=this.editor.getMarkdown(),this.activeNodes.forEach(e=>{e.setNote(this.note)}),this.cancel()}}}),E=O,P=(i("525b"),Object(m["a"])(E,L,M,!1,null,"95fbddba",null)),F=P.exports,j=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"nodeTagDialog",attrs:{title:e.$t("nodeTag.title"),visible:e.dialogVisible,width:e.isMobile?"90%":"50%",top:e.isMobile?"20px":"15vh"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-input",{attrs:{disabled:e.tagArr.length>=e.max,placeholder:e.$t("nodeTag.addTip")},nativeOn:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.add.apply(null,arguments)},function(e){e.stopPropagation()}],keydown:function(e){e.stopPropagation()}},model:{value:e.tag,callback:function(t){e.tag=t},expression:"tag"}}),t("div",{staticClass:"tagList"},e._l(e.tagArr,(function(i,s){return t("div",{key:s,staticClass:"tagItem",style:{backgroundColor:e.generateColorByContent(i)}},[e._v(" "+e._s(i)+" "),t("div",{staticClass:"delBtn",on:{click:function(t){return e.del(s)}}},[t("span",{staticClass:"iconfont iconshanchu"})])])})),0),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("dialog.cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("dialog.confirm")))])],1)],1)},R=[],z={name:"NodeTag",data(){return{dialogVisible:!1,tagArr:[],tag:"",activeNodes:[],max:5,isMobile:Object(d["V"])()}},watch:{dialogVisible(e,t){!e&&t&&this.$bus.$emit("endTextEdit")}},created(){this.$bus.$on("node_active",this.handleNodeActive),this.$bus.$on("showNodeTag",this.handleShowNodeTag)},beforeDestroy(){this.$bus.$off("node_active",this.handleNodeActive),this.$bus.$off("showNodeTag",this.handleShowNodeTag)},methods:{generateColorByContent:d["A"],handleNodeActive(...e){if(this.activeNodes=[...e[1]],this.activeNodes.length>0){let e=this.activeNodes[0];this.tagArr=e.getData("tag")||[]}else this.tagArr=[],this.tag=""},handleShowNodeTag(){this.$bus.$emit("startTextEdit"),this.dialogVisible=!0},add(){this.tagArr.push(this.tag),this.tag=""},del(e){this.tagArr.splice(e,1)},cancel(){this.dialogVisible=!1},confirm(){this.activeNodes.forEach(e=>{e.setTag(this.tagArr)}),this.cancel()}}},A=z,B=(i("5f49"),Object(m["a"])(A,j,R,!1,null,"593118a2",null)),V=B.exports,H=function(){var e=this,t=e._self._c;return t("el-dialog",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"nodeExportDialog",attrs:{title:e.$t("export.title"),visible:e.dialogVisible,"element-loading-text":e.loadingText,"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",width:e.isMobile?"90%":"50%",top:e.isMobile?"20px":"15vh"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"exportContainer",class:{isDark:e.isDark}},[t("div",{staticClass:"nameInputBox"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("export.filename")))]),t("el-input",{staticStyle:{"max-width":"300px"},attrs:{size:"mini"},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),t("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:["smm","json"].includes(e.exportType),expression:"['smm', 'json'].includes(exportType)"}],staticStyle:{"margin-left":"12px"},model:{value:e.widthConfig,callback:function(t){e.widthConfig=t},expression:"widthConfig"}},[e._v(e._s(e.$t("export.include")))])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:["svg","png","pdf"].includes(e.exportType),expression:"['svg', 'png', 'pdf'].includes(exportType)"}],staticClass:"paddingInputBox"},[t("div",{staticClass:"paddingInputGroup"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("export.paddingX")))]),t("el-input",{staticStyle:{"max-width":"100px"},attrs:{size:"mini"},on:{change:e.onPaddingChange},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.paddingX,callback:function(t){e.paddingX=t},expression:"paddingX"}})],1),t("div",{staticClass:"paddingInputGroup"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("export.paddingY")))]),t("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini"},on:{change:e.onPaddingChange},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.paddingY,callback:function(t){e.paddingY=t},expression:"paddingY"}})],1),t("div",{staticClass:"paddingInputGroup"},[t("span",{staticClass:"name"},[e._v(e._s(this.$t("export.addFooterText")))]),t("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:e.$t("export.addFooterTextPlaceholder")},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.extraText,callback:function(t){e.extraText=t},expression:"extraText"}})],1),t("div",{staticClass:"paddingInputGroup"},[t("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:["png","pdf"].includes(e.exportType),expression:"['png', 'pdf'].includes(exportType)"}],model:{value:e.isTransparent,callback:function(t){e.isTransparent=t},expression:"isTransparent"}},[e._v(e._s(e.$t("export.isTransparent")))])],1)]),t("div",{staticClass:"downloadTypeList"},e._l(e.downTypeList,(function(i){return t("div",{key:i.type,staticClass:"downloadTypeItem",class:{active:e.exportType===i.type},on:{click:function(t){e.exportType=i.type}}},[t("div",{staticClass:"icon iconfont",class:[i.icon,i.type]}),t("div",{staticClass:"info"},[t("div",{staticClass:"name"},[e._v(e._s(i.name))]),t("div",{staticClass:"desc"},[e._v(e._s(i.desc))])])])})),0),t("div",{staticClass:"tip"},[e._v(e._s(e.$t("export.tips")))])]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("dialog.cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("dialog.confirm")))])],1)])},W=[],U=i("2f62"),K=i("f121"),Y={name:"Export",data(){return{dialogVisible:!1,exportType:"smm",fileName:this.$t("export.defaultFileName"),widthConfig:!0,isTransparent:!1,loading:!1,loadingText:"",paddingX:10,paddingY:10,extraText:"",isMobile:Object(d["V"])()}},computed:{...Object(U["d"])({openNodeRichText:e=>e.localConfig.openNodeRichText,isDark:e=>e.localConfig.isDark}),downTypeList(){return K["h"][this.$i18n.locale]||K["h"].zh}},created(){this.$bus.$on("showExport",this.handleShowExport)},beforeDestroy(){this.$bus.$off("showExport",this.handleShowExport)},methods:{...Object(U["c"])(["setExtraTextOnExport"]),handleShowExport(){this.dialogVisible=!0},onPaddingChange(){this.$bus.$emit("paddingChange",{exportPaddingX:Number(this.paddingX),exportPaddingY:Number(this.paddingY)})},cancel(){this.dialogVisible=!1},confirm(){this.setExtraTextOnExport(this.extraText),"svg"===this.exportType?this.$bus.$emit("export",this.exportType,!0,this.fileName,"* {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }"):["smm","json"].includes(this.exportType)?this.$bus.$emit("export",this.exportType,!0,this.fileName,this.widthConfig):"png"===this.exportType||"pdf"===this.exportType?this.$bus.$emit("export",this.exportType,!0,this.fileName,this.isTransparent):this.$bus.$emit("export",this.exportType,!0,this.fileName),this.$notify.info({title:this.$t("export.notifyTitle"),message:this.$t("export.notifyMessage")}),this.cancel()}}},X=Y,G=(i("eedc"),Object(m["a"])(X,H,W,!1,null,"760e584f",null)),Z=G.exports,q=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"nodeImportDialog",attrs:{title:e.$t("import.title"),visible:e.dialogVisible,width:"450px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-upload",{ref:"upload",attrs:{action:"x","file-list":e.fileList,"auto-upload":!1,multiple:!1,"on-change":e.onChange,limit:1,"on-exceed":e.onExceed}},[t("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(e._s(e.$t("import.selectFile")))]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" "+e._s(e.$t("import.supportFile"))+" ")])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancel}},[e._v(e._s(e.$t("dialog.cancel")))]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("dialog.confirm")))])],1)],1)},J=[],Q=i("ad8c"),ee=i("0908"),te=i("ed08"),ie=i("25ca"),se=i("4744"),ae={name:"Import",data(){return{dialogVisible:!1,fileList:[],exportFrom:{type:"导入",operateOn:"用例",caseid:"",casename:"",beforeoperation:"",afteroperation:"",switch:""}}},watch:{dialogVisible(e,t){!e&&t&&(this.fileList=[])}},created(){this.$bus.$on("showImport",this.handleShowImport),this.$bus.$on("handle_file_url",this.handleFileURL)},beforeDestroy(){this.$bus.$off("showImport",this.handleShowImport),this.$bus.$off("handle_file_url",this.handleFileURL)},methods:{handleShowImport(){this.dialogVisible=!0},async handleFileURL(){try{const e=this.$route.query.fileURL;if(!e)return;const t=/\.(smm|json|xmind|md|xlsx)$/.exec(e);if(!t)return;const i=t[1],s=await fetch(e),a=await s.blob(),n={raw:a};"smm"===i||"json"===i?this.handleSmm(n):"xmind"===i?this.handleXmind(n):"xlsx"===i?this.handleExcel(n):"md"===i&&this.handleMd(n)}catch(e){console.log(e)}},onChange(e){let t=/\.(smm|xmind|json|xlsx|md)$/;t.test(e.name)?this.fileList.push(e):(this.$message.error("请选择.smm、.json、.xmind、.xlsx、.md文件"),this.fileList=[])},onExceed(){this.$message.error("最多只能选择一个文件")},cancel(){this.dialogVisible=!1},confirm(){if(this.fileList.length<=0)return this.$message.error("请选择要导入的文件");this.$store.commit("setIsHandleLocalFile",!1);let e=this.fileList[0];/\.(smm|json)$/.test(e.name)?this.handleSmm(e):/\.xmind$/.test(e.name)?this.handleXmind(e):/\.xlsx$/.test(e.name)?this.handleExcel(e):/\.md$/.test(e.name)&&this.handleMd(e),this.cancel()},handleSmm(e){this.$loading({lock:!0,text:"正在导入，请稍后......",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});let t=new FileReader;t.readAsText(e.raw),t.onload=e=>{try{let t=JSON.parse(e.target.result);if("object"!==typeof t)throw new Error(this.$t("import.fileContentError"));this.$bus.$emit("setData",t),this.$message.success(this.$t("import.importSuccess"))}catch(t){console.log(t),this.$message.error(this.$t("import.fileParsingFailed"))}};var i="TMIND"+Date.now();sessionStorage.setItem("caseid",i),sessionStorage.setItem("name",e.raw.name),sessionStorage.setItem("switch","1"),this.$emit("sendData",{caseid:"",name:e.raw.name})},async handleXmind(e){try{let t=await Q["a"].parseXmindFile(e.raw);this.$bus.$emit("setData",t),this.$message.success(this.$t("import.importSuccess"))}catch(i){console.log(i),this.$message.error(this.$t("import.fileParsingFailed"))}var t="TMIND"+Date.now();sessionStorage.setItem("caseid",t),sessionStorage.setItem("name",e.raw.name),sessionStorage.setItem("switch",""),this.$emit("sendData",{caseid:"",name:e.raw.name})},async handleExcel(e){try{const t=Object(ie["a"])(await Object(te["b"])(e.raw)),i=ie["b"].sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1});if(i.length<=0)return;let s=0;i.forEach(e=>{e.length>s&&(s=e.length)});let a=[],n=e=>{a[e]||(a[e]=[]);for(let t=0;t<i.length;t++)if(i[t][e]){let s={data:{text:i[t][e]},children:[],_row:t};a[e].push(s)}e<s-1&&n(e+1)};n(0);let o=(e,t)=>{for(let i=e.length-1;i>=0;i--)if(t>=e[i]._row)return e[i]};for(let e=1;e<a.length;e++){let t=a[e];for(let i=0;i<t.length;i++){let s=t[i],n=o(a[e-1],s._row);n&&n.children.push(s)}}this.$bus.$emit("setData",a[0][0]),this.$message.success(this.$t("import.importSuccess"))}catch(i){console.log(i),this.$message.error(this.$t("import.fileParsingFailed"))}var t="TMIND"+Date.now();sessionStorage.setItem("caseid",t),sessionStorage.setItem("name",e.raw.name),sessionStorage.setItem("switch",""),this.$emit("sendData",{caseid:"",name:e.raw.name})},async handleMd(e){let t=new FileReader;t.readAsText(e.raw),t.onload=async e=>{try{let t=await ee["a"].transformMarkdownTo(e.target.result);this.$bus.$emit("setData",t),this.$message.success(this.$t("import.importSuccess"))}catch(t){console.log(t),this.$message.error(this.$t("import.fileParsingFailed"))}};var i="TMIND"+Date.now();sessionStorage.setItem("caseid",i),sessionStorage.setItem("name",e.raw.name),sessionStorage.setItem("switch",""),this.$emit("sendData",{caseid:"",name:e.raw.name})}}},ne=ae,oe=(i("012be"),Object(m["a"])(ne,q,J,!1,null,"214ba14a",null)),le=oe.exports,re=i("5c96"),ce=i("5848"),de=i("365c"),he=function(){var e=this,t=e._self._c;return t("div",{staticClass:"toolbarNodeBtnList",class:[e.dir,{isDark:e.isDark}]},[e._l(e.list,(function(i){return["back"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.readonly||e.backEnd},on:{click:function(t){return e.$bus.$emit("execCommand","BACK")}}},[t("span",{staticClass:"icon iconfont iconhoutui-shi"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.undo")))])]):e._e(),"forward"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.readonly||e.forwardEnd},on:{click:function(t){return e.$bus.$emit("execCommand","FORWARD")}}},[t("span",{staticClass:"icon iconfont iconqianjin1"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.redo")))])]):e._e(),"siblingNode"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0||e.hasRoot||e.hasGeneralization},on:{click:function(t){return e.$bus.$emit("execCommand","INSERT_NODE")}}},[t("span",{staticClass:"icon iconfont iconjiedian"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.insertSiblingNode")))])]):e._e(),"childNode"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0||e.hasGeneralization},on:{click:function(t){return e.$bus.$emit("execCommand","INSERT_CHILD_NODE")}}},[t("span",{staticClass:"icon iconfont icontianjiazijiedian"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.insertChildNode")))])]):e._e(),"deleteNode"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0},on:{click:function(t){return e.$bus.$emit("execCommand","REMOVE_NODE")}}},[t("span",{staticClass:"icon iconfont iconshanchu"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.deleteNode")))])]):e._e(),"image"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0},on:{click:function(t){return e.$bus.$emit("showNodeImage")}}},[t("span",{staticClass:"icon iconfont iconimage"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.image")))])]):e._e(),"icon"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0},on:{click:e.showNodeIcon}},[t("span",{staticClass:"icon iconfont iconxiaolian"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.icon")))])]):e._e(),"link"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0},on:{click:function(t){return e.$bus.$emit("showNodeLink")}}},[t("span",{staticClass:"icon iconfont iconchaolianjie"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.link")))])]):e._e(),"note"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0},on:{click:function(t){return e.$bus.$emit("showNodeNote")}}},[t("span",{staticClass:"icon iconfont iconflow-Mark"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.note")))])]):e._e(),"tag"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0},on:{click:function(t){return e.$bus.$emit("showNodeTag")}}},[t("span",{staticClass:"icon iconfont iconbiaoqian"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.tag")))])]):e._e(),"summary"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0||e.hasRoot||e.hasGeneralization},on:{click:function(t){return e.$bus.$emit("execCommand","ADD_GENERALIZATION")}}},[t("span",{staticClass:"icon iconfont icongaikuozonglan"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.summary")))])]):e._e(),"associativeLine"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0||e.hasGeneralization},on:{click:function(t){return e.$bus.$emit("createAssociativeLine")}}},[t("span",{staticClass:"icon iconfont iconlianjiexian"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.associativeLine")))])]):e._e(),"formula"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0||e.hasGeneralization},on:{click:e.showFormula}},[t("span",{staticClass:"icon iconfont icongongshi"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.formula")))])]):e._e(),"attachment"===i?t("div",{staticClass:"toolbarBtn",class:{disabled:e.activeNodes.length<=0||e.hasGeneralization},on:{click:e.selectAttachmentFile}},[t("span",{staticClass:"icon iconfont iconfujian"}),t("span",{staticClass:"text"},[e._v(e._s(e.$t("toolbar.attachment")))])]):e._e()]}))],2)},ue=[],me={props:{dir:{type:String,default:"h"},list:{type:Array,default(){return[]}}},data(){return{activeNodes:[],backEnd:!0,forwardEnd:!0,readonly:!1,isFullDataFile:!1,timer:null,isInPainter:!1}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark}),hasRoot(){return-1!==this.activeNodes.findIndex(e=>e.isRoot)},hasGeneralization(){return-1!==this.activeNodes.findIndex(e=>e.isGeneralization)}},created(){this.$bus.$on("mode_change",this.onModeChange),this.$bus.$on("node_active",this.onNodeActive),this.$bus.$on("back_forward",this.onBackForward),this.$bus.$on("painter_start",this.onPainterStart),this.$bus.$on("painter_end",this.onPainterEnd)},beforeDestroy(){this.$bus.$off("mode_change",this.onModeChange),this.$bus.$off("node_active",this.onNodeActive),this.$bus.$off("back_forward",this.onBackForward),this.$bus.$off("painter_start",this.onPainterStart),this.$bus.$off("painter_end",this.onPainterEnd)},methods:{...Object(U["c"])(["setActiveSidebar"]),onModeChange(e){this.readonly="readonly"===e},onNodeActive(...e){this.activeNodes=[...e[1]]},onBackForward(e,t){this.backEnd=e<=0,this.forwardEnd=e>=t-1},onPainterStart(){this.isInPainter=!0},onPainterEnd(){this.isInPainter=!1},showNodeIcon(){this.$bus.$emit("close_node_icon_toolbar"),this.setActiveSidebar("nodeIconSidebar")},showFormula(){this.setActiveSidebar("formulaSidebar")},selectAttachmentFile(){this.$bus.$emit("selectAttachment",this.activeNodes)}}},pe=me,ge=(i("92bc"),Object(m["a"])(pe,he,ue,!1,null,"a9c0eb1c",null)),fe=ge.exports,be=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"统计和日志",visible:e.logDialogVisible,width:"90%",center:""},on:{"update:visible":function(t){e.logDialogVisible=t}}},[t("el-divider",[t("span",[e._v("导图统计")])]),t("el-row",{staticClass:"panel-group",attrs:{gutter:40}},[t("el-col",{staticClass:"card-panel-col",attrs:{xs:12,sm:12,lg:6}},[t("div",{staticClass:"card-panel"},[t("div",{staticClass:"card-panel-icon-wrapper icon-people"},[t("span",{staticClass:"icon iconfont icondaohang"})]),t("div",{staticClass:"card-panel-description"},[t("div",{staticClass:"card-panel-text"},[e._v(" 用例总数 ")]),t("count-to",{staticClass:"card-panel-num",attrs:{"start-val":0,"end-val":e.statistics.tmindSunm,duration:2600}})],1)])]),t("el-col",{staticClass:"card-panel-col",attrs:{xs:12,sm:12,lg:6}},[t("div",{staticClass:"card-panel"},[t("div",{staticClass:"card-panel-icon-wrapper icon-shopping"},[t("span",{staticClass:"icon iconfont icondaohang"})]),t("div",{staticClass:"card-panel-description"},[t("div",{staticClass:"card-panel-text"},[e._v(" 我的用例 ")]),t("count-to",{staticClass:"card-panel-num",attrs:{"start-val":0,"end-val":e.statistics.mycreterSunm,duration:3600}})],1)])]),t("el-col",{staticClass:"card-panel-col",attrs:{xs:12,sm:12,lg:6}},[t("div",{staticClass:"card-panel"},[t("div",{staticClass:"card-panel-icon-wrapper icon-message"},[t("span",{staticClass:"icon iconfont icondaohang"})]),t("div",{staticClass:"card-panel-description"},[t("div",{staticClass:"card-panel-text"},[e._v(" 仅读总数 ")]),t("count-to",{staticClass:"card-panel-num",attrs:{"start-val":0,"end-val":e.statistics.privateSunm,duration:3e3}})],1)])]),t("el-col",{staticClass:"card-panel-col",attrs:{xs:12,sm:12,lg:6}},[t("div",{staticClass:"card-panel"},[t("div",{staticClass:"card-panel-icon-wrapper icon-money"},[t("span",{staticClass:"icon iconfont icondaohang"})]),t("div",{staticClass:"card-panel-description"},[t("div",{staticClass:"card-panel-text"},[e._v(" 读写总数 ")]),t("count-to",{staticClass:"card-panel-num",attrs:{"start-val":0,"end-val":e.statistics.sharedSunm,duration:3200}})],1)])])],1),t("el-divider",[t("span",[e._v("温馨提示：系统每分钟自动保存一次,为防止保存不及时丢数据,建议点击保存按钮~~")])]),t("el-container",[t("el-main",[t("el-input",{staticStyle:{width:"30%","margin-left":"1px"},attrs:{placeholder:"请输入用例ID",clearable:""},on:{clear:function(t){return e.getMindMapLog()}},model:{value:e.caseid,callback:function(t){e.caseid="string"===typeof t?t.trim():t},expression:"caseid"}}),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",type:"success",plain:""},on:{click:function(t){return e.getMindMapLog()}}},[e._v("查询")]),t("div",{staticStyle:{height:"15px"}}),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData.results,border:"",stripe:"","header-cell-style":{color:"#000000"},"element-loading-text":"拼命加载中"}},[t("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"100"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"200",label:"用例ID",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.caseid))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"250",label:"用例名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.casename))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"100",label:"用例数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.casesum))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"90",label:"保存类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return["系统保存"==i.row.SaveType?t("div",{staticStyle:{color:"blue"}},[e._v(" 系统保存 ")]):"手动保存"==i.row.SaveType?t("div",{staticStyle:{color:"green"},attrs:{type:"success"}},[e._v("手动保存 ")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"日志描述",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.operationremarks))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"操作人",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.creter))])]}}])}),t("el-table-column",{attrs:{align:"center",prop:"create_time",label:"操作时间",formatter:e.formatTime,width:"180"}}),t("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-row",[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.enterMimdMap(i.row)}}},[e._v("查看 ")])],1)]}}])})],1),t("div",{staticStyle:{height:"40px"}}),t("el-col",{staticStyle:{"margin-left":"550px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.tableData.count,expression:"tableData.count !== 0"}],attrs:{"page-size":20,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.tableData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)],1)],1)],1)},ve=[],ye=i("ec1b"),Ce=i.n(ye),we={components:{CountTo:Ce.a},data(){return{loading:!1,caseid:"",logDialogVisible:!1,tableData:{count:0,results:[]},currentRow:"",currentPage:1,statistics:{tmindSunm:0,privateSunm:0,sharedSunm:0,mycreterSunm:0}}},beforeDestroy(){this.$bus.$off("showLog",this.handleOpenPanelDialog)},created(){this.$bus.$on("showLog",this.handleOpenPanelDialog),this.$bus.$on("show-login-dialog",()=>{this.logDialogVisible=!1})},watch:{},methods:{handleOpenPanelDialog(){this.currentPage=1,this.caseid="",this.getMindMapLog(),this.getStatistics(),this.logDialogVisible=!0},enterMimdMap(e){window.sessionStorage.setItem("logcase",e.caseid),window.sessionStorage.setItem("logid",e.id),this.$router.push("/log")},formatTime(e,t){let i=e[t.property],s=new Date(i);const a=s.getFullYear();let n=s.getMonth()+1;n<10&&(n="0"+n);let o=s.getDate();o<10&&(o="0"+o);let l=s.getHours();l<10&&(l="0"+l);let r=s.getMinutes();r<10&&(r="0"+r);let c=s.getSeconds();return c<10&&(c="0"+c),a+"-"+n+"-"+o+" "+l+":"+r+":"+c},async getMindMapLog(){this.loading=!0,this.treeid="";Object(se["e"])({pagenum:"20",page:this.currentPage,id:"",caseid:this.caseid}).then(e=>{this.tableData=e,this.loading=!1})},async getStatistics(){Object(se["f"])({}).then(e=>{this.statistics.tmindSunm=e.data.tmindSunm,this.statistics.privateSunm=e.data.privateSunm,this.statistics.sharedSunm=e.data.sharedSunm,this.statistics.mycreterSunm=e.data.mycreterSunm})},cellMouseEnter(e){this.currentRow=e},cellMouseLeave(e){this.currentRow=""},handleCurrentChange(e){this.loading=!0,Object(se["e"])({pagenum:"20",page:this.currentPage,id:"",caseid:this.caseid}).then(e=>{this.tableData=e,this.loading=!1})}},mounted(){}},_e=we,xe=(i("c4f8"),Object(m["a"])(_e,be,ve,!1,null,"7c91009c",null)),ke=xe.exports,Se=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{"close-on-click-modal":!1,"show-close":!1,visible:e.loginDialogVisible,center:""},on:{"update:visible":function(t){e.loginDialogVisible=t}}},[t("div",{staticClass:"transparent-background"},[t("div",{staticClass:"main-box"},[t("div",{class:["container","container-login",{"is-txl is-z200":e.isLogin}]},[t("form",{attrs:{model:e.loginForm}},[t("h2",{staticClass:"title"},[e._v("欢迎登录")]),t("span",{staticClass:"text",staticStyle:{color:"black"}},[e._v("请输入用户和密码登录~")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.username,expression:"loginForm.username"}],staticClass:"form__input",attrs:{type:"text",placeholder:"用户"},domProps:{value:e.loginForm.username},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"username",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginForm.password,expression:"loginForm.password"}],staticClass:"form__input",attrs:{type:"password",placeholder:"密码"},domProps:{value:e.loginForm.password},on:{input:function(t){t.target.composing||e.$set(e.loginForm,"password",t.target.value)}}}),t("div",{staticClass:"primary-btn",on:{click:e.login}},[e._v("立即登录")])])]),t("div",{class:["container","container-register",{"is-txl":e.isLogin}]},[t("form",[t("h2",{staticClass:"title"},[e._v("创建账号")]),t("span",{staticClass:"text",staticStyle:{color:"black"}},[e._v("用户建议使用工号注册~")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.username,expression:"registerForm.username"}],staticClass:"form__input",attrs:{maxlength:"10",type:"text",placeholder:"用户"},domProps:{value:e.registerForm.username},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"username",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.password,expression:"registerForm.password"}],staticClass:"form__input",attrs:{maxlength:"20",type:"password",placeholder:"密码"},domProps:{value:e.registerForm.password},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"password",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.registerForm.email,expression:"registerForm.email"}],staticClass:"form__input",attrs:{type:"text",placeholder:"邮箱"},domProps:{value:e.registerForm.email},on:{input:function(t){t.target.composing||e.$set(e.registerForm,"email",t.target.value)}}}),t("div",{staticClass:"primary-btn",on:{click:e.register}},[e._v("立即注册")])])]),t("div",{class:["switch",{login:e.isLogin}]},[t("div",{staticClass:"switch__circle"}),t("div",{staticClass:"switch__circle switch__circle_top"}),t("div",{staticClass:"switch__container"},[t("h2",[e._v(e._s(e.isLogin?"注册账号 ":"Tmind欢迎你~"))]),t("p",{staticStyle:{color:"black"}},[e._v(" "+e._s(e.isLogin?"若还没账号，下面按钮快速注册~":"格力电商测试用例管理系统~")+" ")]),t("div",{staticClass:"primary-btn",on:{click:function(t){e.isLogin=!e.isLogin}}},[e._v(" "+e._s(e.isLogin?"立即注册":"立即登录")+" ")])])])])])])],1)},$e=[],De=i("7fbf"),Te=i("c24f"),Ne={components:{},data(){return{loginDialogVisible:!1,isLogin:!0,loginForm:{username:"",password:""},registerForm:{username:"",email:"",password:""}}},created(){"false"!=sessionStorage.getItem("loginDialogVisible")?this.loginDialogVisible=!0:this.loginDialogVisible=!1,this.$bus.$on("show-login-dialog",()=>{this.loginDialogVisible=!0})},watch:{filterText(e){this.$refs.tree.filter(e)}},methods:{login(){if(""==this.loginForm.username)this.$message.error({message:"请输入用户~",center:!0});else if(""==this.loginForm.password)this.$message.error({message:"请输入密码~",center:!0});else{Object(Te["e"])(this.loginForm).then(e=>{if(e.success){this.$message.success({message:"Tmind，欢迎你~",type:"success",center:!0}),sessionStorage.setItem("username",this.loginForm.username),sessionStorage.setItem("token",e.token),sessionStorage.setItem("loginDialogVisible",!1),this.loginDialogVisible=!1;Object(De["d"])({caseid:"",latest:!0}).then(e=>{e.success&&(this.$bus.$emit("setData",JSON.parse(e.content)),sessionStorage.setItem("caseid",e.caseid),sessionStorage.setItem("name",e.name),this.$emit("sendData",{name:e.name,caseid:e.caseid}))}).catch(e=>{let t=getData();this.mindMapData=t,this.init()})}else this.$message.error({message:"抱歉，账号或密码~",center:!0})})}},register(){if(""==this.registerForm.username||void 0==this.registerForm.username)this.$message.error({message:"请输入用户~",center:!0});else if(""==this.registerForm.password||void 0==this.registerForm.password)this.$message.error({message:"请输入密码~",center:!0});else if(""==this.registerForm.email||void 0==this.registerForm.email)this.$message.error({message:"请输入邮箱~",center:!0});else{Object(Te["f"])(this.registerForm).then(e=>{if(e.success){Object(Te["e"])(this.registerForm).then(e=>{this.$message.success({message:"Tmind，欢迎你~",type:"success",center:!0}),sessionStorage.setItem("username",this.registerForm.username),sessionStorage.setItem("token",e.token),sessionStorage.setItem("loginDialogVisible",!1),this.loginDialogVisible=!1})}else this.$message.error({message:e.msg,center:!0})})}}},mounted(){}},Le=Ne,Me=(i("2e7a"),Object(m["a"])(Le,Se,$e,!1,null,"82a32168",null)),Ie=Me.exports,Oe=function(){var e=this,t=e._self._c;return t("div",[t("el-drawer",{attrs:{"with-header":!1,visible:e.personalcenter,direction:"ltr",size:"25%"},on:{"update:visible":function(t){e.personalcenter=t}}},[t("el-divider",[t("i",{staticClass:"el-icon-user"})]),t("el-descriptions",{staticStyle:{"margin-left":"5%"},attrs:{title:"个人基础信息"}},[t("template",{slot:"extra"},[t("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.logout}},[e._v("退出")])],1),t("el-descriptions-item",{attrs:{label:"用户名",span:2}},[e._v(e._s(this.username))]),t("el-descriptions-item",{attrs:{label:"密码"}},[t("el-tag",{attrs:{size:"small"},on:{click:function(t){e.centerDialogVisible=!0}}},[e._v("修改")])],1)],2),t("el-button",{staticStyle:{width:"100%"},attrs:{plain:"",icon:"el-icon-circle-plus",type:"success"},on:{click:function(t){e.AddLabelDialogVisible=!0}}},[e._v("新建分组")]),t("el-table",{attrs:{data:e.lableData.results}},[t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"name",label:"名称"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"num",label:"人数数量"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{label:"操作",fixed:"right",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"danger",size:"mini",circle:""},on:{click:function(t){return e.remove(i.row)}}},[e._v("移除")]),t("el-button",{attrs:{type:"success",size:"mini",circle:""},on:{click:function(t){return e.addMembers(i.row)}}},[e._v("添加")]),t("el-button",{attrs:{type:"primary",size:"mini",circle:""},on:{click:function(t){return e.lookMembers(i.row)}}},[e._v("查看")])]}}])})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.lableData.count,expression:"lableData.count !== 0"}],attrs:{"page-size":20,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.lableData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1),t("el-dialog",{attrs:{title:"新建分组",visible:e.AddLabelDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.AddLabelDialogVisible=t}}},[t("el-input",{attrs:{placeholder:"请输入分组名称",maxlength:"20"},on:{input:e.labelhandleInput},model:{value:e.labelname,callback:function(t){e.labelname=t},expression:"labelname"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.AddLabelDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",disabled:!e.isButtonEnabled},on:{click:e.addLabel}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加人员",visible:e.AddMembersDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.AddMembersDialogVisible=t}}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.membersData.results},on:{"selection-change":e.handleSelectionChange_add}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{prop:"id",label:"ID"}}),t("el-table-column",{attrs:{prop:"username",label:"名称",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.membersData.count,expression:"membersData.count !== 0"}],attrs:{"page-size":20,background:"","current-page":e.addcurrentPage,layout:"total, prev, pager, next, jumper",total:e.membersData.count},on:{"current-change":e.handleCurrentChange3,"update:currentPage":function(t){e.addcurrentPage=t},"update:current-page":function(t){e.addcurrentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.AddMembersDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitData}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"移除人员",visible:e.RemoveMembersDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.RemoveMembersDialogVisible=t}}},[t("el-link",{attrs:{type:"danger"},on:{click:e.removeMembers}},[e._v("批量移除")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.membersData.results},on:{"selection-change":e.handleSelectionChange_remove}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{prop:"id",label:"ID"}}),t("el-table-column",{attrs:{prop:"username",label:"名称",align:"center"}}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.removeMembersId(i.row)}}},[e._v("移除")])]}}])})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.membersData.count,expression:"membersData.count !== 0"}],attrs:{"page-size":20,background:"","current-page":e.removecurrentPage,layout:"total, prev, pager, next, jumper",total:e.membersData.count},on:{"current-change":e.handleCurrentChange4,"update:currentPage":function(t){e.removecurrentPage=t},"update:current-page":function(t){e.removecurrentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.RemoveMembersDialogVisible=!1}}},[e._v("取 消")])],1)],1),t("el-dialog",{attrs:{title:"查看分组人员",visible:e.LookMembersDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.LookMembersDialogVisible=t}}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.membersData.results}},[t("el-table-column",{attrs:{prop:"id",label:"ID"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{prop:"username",label:"名称",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.membersData.count,expression:"membersData.count !== 0"}],attrs:{"page-size":20,background:"","current-page":e.lookcurrentPage,layout:"total, prev, pager, next, jumper",total:e.membersData.count},on:{"current-change":e.handleCurrentChange2,"update:currentPage":function(t){e.lookcurrentPage=t},"update:current-page":function(t){e.lookcurrentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.LookMembersDialogVisible=!1}}},[e._v("取 消")])],1)],1),t("el-dialog",{attrs:{title:"修改密码",visible:e.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[t("el-input",{attrs:{placeholder:"请输入修改密码",maxlength:"20"},on:{input:e.handleInput},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",disabled:!e.isButtonEnabled},on:{click:e.editMembers}},[e._v("确 定")])],1)],1)],1)},Ee=[],Pe=i("34cd"),Fe={inject:["reload"],components:{},data(){return{centerDialogVisible:!1,password:"",isButtonEnabled:!1,AddMembersDialogVisible:!1,RemoveMembersDialogVisible:!1,LookMembersDialogVisible:!1,AddLabelDialogVisible:!1,adduser:"",username:sessionStorage.getItem("username"),personalcenter:!1,dialog:!1,loading:!1,lableData:[],currentPage:1,addcurrentPage:1,lookcurrentPage:1,removecurrentPage:1,labelname:"",membersData:[],userid:"",addmultipleSelection:[],removemultipleSelection:[]}},created(){this.$bus.$on("showCollaborate",()=>{this.personalcenter=!0,this.username=sessionStorage.getItem("username"),this.getLabelList()})},watch:{},methods:{handleSelectionChange_add(e){this.addmultipleSelection=e},handleSelectionChange_remove(e){this.removemultipleSelection=e},submitData(){if(""!=this.addmultipleSelection){Object(Pe["b"])({userid:this.userid,userdata:this.addmultipleSelection}).then(e=>{e.success?(this.getLabelList(),this.AddMembersDialogVisible=!1,this.$message.success({message:"添加成功~",type:"success",center:!0})):this.$message.error({message:e.msg,type:"success",center:!0})}).catch(e=>{this.$message.error({message:"添加失败，稍后再试~",type:"success",center:!0})})}else this.$message.error({message:"请勾选添加人员",type:"success",center:!0})},removeMembersId(e){Object(Pe["c"])({userid:e.id,labelid:this.userid,userdata:this.removemultipleSelection}).then(e=>{if(e.success){this.getLabelList(),this.AddMembersDialogVisible=!1,this.$message.success({message:"移除成功~",type:"success",center:!0}),this.removecurrentPage=1;Object(Te["d"])({page:this.removecurrentPage,type:1,label:this.userid}).then(e=>{this.membersData=e})}else this.$message.error({message:e.msg,type:"success",center:!0})}).catch(e=>{this.$message.error({message:"移除失败，稍后再试~",type:"success",center:!0})})},removeMembers(e){if(""!=this.removemultipleSelection){Object(Pe["c"])({userid:"",labelid:this.userid,userdata:this.removemultipleSelection}).then(e=>{e.success?(this.getLabelList(),this.RemoveMembersDialogVisible=!1,this.$message.success({message:"移除成功~",type:"success",center:!0})):this.$message.error({message:e.msg,type:"success",center:!0})}).catch(e=>{this.$message.error({message:"移除失败，稍后再试~",type:"success",center:!0})})}else this.$message.error({message:"请勾选移除人员",type:"success",center:!0})},async getLabelList(){Object(Pe["d"])({page:this.currentPage,type:"",caseid:""}).then(e=>{this.lableData=e})},formatTime(e,t){let i=e[t.property],s=new Date(i);const a=s.getFullYear();let n=s.getMonth()+1;n<10&&(n="0"+n);let o=s.getDate();return o<10&&(o="0"+o),a+"-"+n+"-"+o},handleInput(){this.isButtonEnabled=this.password.length>0},labelhandleInput(){this.isButtonEnabled=this.labelname.length>0},addMembers(e){this.userid=e.id,this.AddMembersDialogVisible=!0,this.lookcurrentPage=1,this.addcurrentPage=1,this.removecurrentPage=1;Object(Te["d"])({page:this.addcurrentPage,type:2,label:e.id}).then(e=>{this.membersData=e})},addLabel(){if(""!=this.labelname){Object(Pe["a"])({name:this.labelname}).then(e=>{e.success?(this.getLabelList(),this.AddLabelDialogVisible=!1,this.$message.success({message:"添加成功~",type:"success",center:!0})):this.$message.error({message:e.msg,type:"success",center:!0})}).catch(e=>{this.$message.error({message:"添加失败，稍后再试~",type:"success",center:!0})})}else this.$message.error({message:"请输入分组名称",type:"success",center:!0})},editMembers(){Object(Te["b"])({password:this.password}).then(e=>{this.centerDialogVisible=!1,this.$message.success({message:"修改成功，重新登录后生效~",type:"success",center:!0})}).catch(e=>{this.$message.error({message:"修改失败，稍后再试~",type:"success",center:!0})})},remove(e){this.userid=e.id,this.RemoveMembersDialogVisible=!0,this.lookcurrentPage=1,this.addcurrentPage=1,this.removecurrentPage=1;Object(Te["d"])({page:this.removecurrentPage,type:1,label:e.id}).then(e=>{this.membersData=e,0==e.results.length&&this.$message.error({message:"该组暂无数据~",type:"success",center:!0})})},lookMembers(e){this.userid=e.id,this.LookMembersDialogVisible=!0,this.lookcurrentPage=1,this.addcurrentPage=1,this.removecurrentPage=1;Object(Te["d"])({page:this.lookcurrentPage,type:1,label:e.id}).then(e=>{this.membersData=e,0==e.results.length&&this.$message.error({message:"该组暂无数据~",type:"success",center:!0})})},logout(){sessionStorage.clear(),this.reload()},handleCurrentChange(e){Object(Pe["d"])({page:this.currentPage,type:"",caseid:""}).then(e=>{this.lableData=e})},handleCurrentChange2(e){Object(Te["d"])({page:this.lookcurrentPage,type:1,label:this.userid}).then(e=>{this.membersData=e})},handleCurrentChange3(e){Object(Te["d"])({page:this.addcurrentPage,type:2,label:this.userid}).then(e=>{this.membersData=e})},handleCurrentChange4(e){Object(Te["d"])({page:this.removecurrentPage,type:1,label:this.userid}).then(e=>{this.membersData=e})}},mounted(){}},je=Fe,Re=(i("bcdf"),Object(m["a"])(je,Oe,Ee,!1,null,null,null)),ze=Re.exports,Ae=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:"用例管理",visible:e.centerDialogVisible,width:"95%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t},close:e.handleDialogClose}},[t("el-container",{staticStyle:{height:"640px",border:"1px solid #eee"}},[t("el-aside",[t("div",[t("div",{staticClass:"button-container"},[t("el-button",{staticStyle:{width:"100%"},attrs:{size:"small",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAddTop}},[e._v("添加根目录")]),t("el-button",{staticStyle:{width:"100%"},attrs:{size:"small",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm()}}},[e._v("重置根目录")])],1),t("el-input",{attrs:{size:"small",placeholder:"输入关键字查询~"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e.isLoadingTree?t("el-tree",{ref:"expandMenuList",staticClass:"expand-tree",attrs:{data:e.setTree,"node-key":"id","highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"render-content":e.renderContent,"default-expanded-keys":e.defaultExpandKeys,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}}):e._e()],1)]),t("el-container",[t("el-main",[t("el-input",{staticStyle:{width:"20%"},attrs:{placeholder:"请输入用例ID",clearable:""},on:{clear:e.getCaseMindmapList},model:{value:e.caseid,callback:function(t){e.caseid="string"===typeof t?t.trim():t},expression:"caseid"}}),t("el-input",{staticStyle:{width:"20%","margin-left":"5px"},attrs:{placeholder:"请输入名称",clearable:""},on:{clear:e.getCaseMindmapList},model:{value:e.name,callback:function(t){e.name="string"===typeof t?t.trim():t},expression:"name"}}),t("el-select",{staticStyle:{width:"15%","margin-left":"5px"},attrs:{placeholder:"请选择权限"},model:{value:e.form.switch,callback:function(t){e.$set(e.form,"switch",t)},expression:"form.switch"}},[t("el-option",{attrs:{label:"仅读",value:"False"}}),t("el-option",{attrs:{label:"读写",value:"True"}})],1),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",type:"success",plain:""},on:{click:function(t){return e.getCaseMindmapListButton()}}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")]),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-download"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出")]),t("div",{staticStyle:{height:"5px"}}),t("el-checkbox",{on:{change:function(t){return e.getCaseMindmapListSelf()}},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("我的")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.results,border:""}},[t("el-table-column",{attrs:{type:"selection"},on:{"selection-change":e.handleSelectionChange_exportExcel}}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center",fixed:"left"}}),t("el-table-column",{attrs:{label:"用例ID",align:"center","show-overflow-tooltip":!0,width:"170",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.caseid))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"名称",width:"150",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.name))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"用例数量",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",[e._v(e._s(i.row.casenum.totalnum))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"待测数",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{type:"warning"}},[e._v(e._s(i.row.casenum.unknown))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"通过数",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{type:"success"}},[e._v(e._s(i.row.casenum.passnum))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"失败数",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{type:"danger"}},[e._v(e._s(i.row.casenum.failnum))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"通过率",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{type:"success"}},[e._v(e._s(i.row.casenum.passrate))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"失败率",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tag",{attrs:{type:"danger"}},[e._v(e._s(i.row.casenum.failrate))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"测试进度",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return["0%"==i.row.casenum.schedule?t("div",{attrs:{type:"success"}},[e._v("待测试")]):"0%"!=i.row.casenum.schedule?t("el-tag",{attrs:{type:"success"}},[e._v(e._s(i.row.casenum.schedule))]):e._e()]}}])}),t("el-table-column",{attrs:{label:"测试结果",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.casenum.totalnum==i.row.casenum.unknown?t("div",{attrs:{type:"danger"}},[e._v(" 待测试 ")]):"0"!=i.row.casenum.unknown?t("div",{staticStyle:{color:"yellowgreen"},attrs:{type:"success"}},[e._v("测试中 ")]):"100%"==i.row.casenum.passrate?t("div",{staticStyle:{color:"green"},attrs:{type:"success"}},[e._v("通过 ")]):"100%"!=i.row.casenum.passrate?t("div",{staticStyle:{color:"red"},attrs:{type:"danger"}},[e._v("失败 ")]):e._e()]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"用例目录",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.treename))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"case_write_time",label:"用例编写完成时间",formatter:e.formatTime,width:"160"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"case_review_time",label:"用例评审结束时间",formatter:e.formatTime,width:"160"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"case_start_time",label:"用例开始执行时间",formatter:e.formatTime,width:"160"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"case_end_time",label:"用例执行完成时间",formatter:e.formatTime,width:"160"}}),t("el-table-column",{attrs:{label:"共享模式",align:"center",width:"100","render-header":e.renderTipsHeader2},scopedSlots:e._u([{key:"default",fn:function(i){return["True"==i.row.switch?t("div",{staticStyle:{color:"#67C23A"},attrs:{type:"success"}},[e._v("读写 ")]):"False"==i.row.switch?t("div",{staticStyle:{color:"red"},attrs:{type:"danger"}},[e._v("仅读 ")]):e._e()]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"创建人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(e._s(i.row.creter))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,align:"center",prop:"create_time",label:"创建时间",formatter:e.formatTime2,width:"160"}}),t("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-row",[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.enterMimdMap(i.row)}}},[e._v("打开 ")]),i.row.creter===e.columnPermissions?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.updateAuth(i.row)}}},[e._v("设置共享 ")]):e._e(),t("el-popover",{staticStyle:{"margin-left":"10px"},model:{value:i.visible,callback:function(t){e.$set(i,"visible",t)},expression:"scope.visible"}},[t("div",{staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.copyMimdMap(i.row.caseid)}}},[e._v("复制 ")]),i.row.creter===e.columnPermissions?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.updateMimdMap(i.row)}}},[e._v("编辑 ")]):e._e(),i.row.creter===e.columnPermissions?t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.preview(i.row)}}},[e._v("查看共享成员 ")]):e._e()],1),t("el-button",{attrs:{slot:"reference",icon:"el-icon-more",title:"更多",circle:"",size:"mini"},on:{click:function(e){i.row.visible=!i.row.visible}},slot:"reference"})],1)],1)]}}])})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"250px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.tableData.count,expression:"tableData.count !== 0"}],attrs:{"page-size":10,background:"","current-page":e.casecurrentPage,layout:"total, prev, pager, next, jumper",total:e.tableData.count},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.casecurrentPage=t},"update:current-page":function(t){e.casecurrentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1)],1)],1)],1),t("el-dialog",{attrs:{title:"编辑用例",visible:e.dialogFormVisible,width:"30%",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{placeholder:"输入名称",label:"名称:"}},[t("el-input",{attrs:{maxlength:"25",minlength:"2",autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"用例编写完成时间:"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择用例编写完成时间"},model:{value:e.case_write_time,callback:function(t){e.case_write_time=t},expression:"case_write_time"}})],1),t("el-form-item",{attrs:{label:"用例评审结束时间:"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择用例评审结束时间"},model:{value:e.case_review_time,callback:function(t){e.case_review_time=t},expression:"case_review_time"}})],1),t("el-form-item",{attrs:{label:"用例开始执行时间:"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择用例开始执行时间"},model:{value:e.case_start_time,callback:function(t){e.case_start_time=t},expression:"case_start_time"}})],1),t("el-form-item",{attrs:{label:"用例执行完成时间:"}},[t("el-date-picker",{attrs:{type:"date",placeholder:"选择用例执行完成时间"},model:{value:e.case_end_time,callback:function(t){e.case_end_time=t},expression:"case_end_time"}})],1),t("el-form-item",{attrs:{label:"共享模式:"}},[t("el-switch",{attrs:{"active-text":"读写","inactive-text":"仅读"},model:{value:e.readwrite,callback:function(t){e.readwrite=t},expression:"readwrite"}})],1),t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"移除共享人员",name:"first"}},[t("el-input",{staticStyle:{width:"50%","margin-left":"1px"},attrs:{placeholder:"请输入姓名",clearable:""},on:{clear:function(t){return e.getuserList2()}},model:{value:e.removeSharedUsers,callback:function(t){e.removeSharedUsers="string"===typeof t?t.trim():t},expression:"removeSharedUsers"}}),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",type:"success",plain:""},on:{click:function(t){return e.getuserList2()}}},[e._v("查询")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.membersData.results},on:{"selection-change":e.handleSelectionChange_remove}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{prop:"id",label:"用户ID",align:"center"}}),t("el-table-column",{attrs:{prop:"username",label:"名称",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.membersData.count,expression:"membersData.count !== 0"}],attrs:{"page-size":10,background:"","current-page":e.addcurrentPage,layout:"total, prev, pager, next, jumper",total:e.membersData.count},on:{"current-change":e.handleCurrentChange4,"update:currentPage":function(t){e.addcurrentPage=t},"update:current-page":function(t){e.addcurrentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1),t("el-tab-pane",{attrs:{label:"移除共享分组",name:"second"}},[t("el-table",{attrs:{data:e.lableData.results},on:{"selection-change":e.handleSelectionChange_label_romeve}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"name",label:"名称",align:"center"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"num",label:"分组人数",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.lableData.count,expression:"lableData.count !== 0"}],attrs:{"page-size":10,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.lableData.count},on:{"current-change":e.handleCurrentChange_label2,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关 闭")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fromMimdMap()}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"共享设置",visible:e.authdialogFormVisible,width:"30%",center:""},on:{"update:visible":function(t){e.authdialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"指定共享人员",name:"first"}},[t("el-input",{staticStyle:{width:"50%","margin-left":"1px"},attrs:{placeholder:"请输入姓名",clearable:""},on:{clear:function(t){return e.getuserList()}},model:{value:e.addSharedUsers,callback:function(t){e.addSharedUsers="string"===typeof t?t.trim():t},expression:"addSharedUsers"}}),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",type:"success",plain:""},on:{click:function(t){return e.getuserList()}}},[e._v("查询")]),t("div",{staticStyle:{height:"15px"}}),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.membersData.results},on:{"selection-change":e.handleSelectionChange_add}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{prop:"id",label:"用户ID",align:"center"}}),t("el-table-column",{attrs:{prop:"username",label:"姓名",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.membersData.count,expression:"membersData.count !== 0"}],attrs:{"page-size":10,background:"","current-page":e.addcurrentPage,layout:"total, prev, pager, next, jumper",total:e.membersData.count},on:{"current-change":e.handleCurrentChange3,"update:currentPage":function(t){e.addcurrentPage=t},"update:current-page":function(t){e.addcurrentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1),t("el-tab-pane",{attrs:{label:"指定共享分组",name:"second"}},[t("el-table",{attrs:{data:e.lableData.results},on:{"selection-change":e.handleSelectionChange_label}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"name",label:"名称",align:"center"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"num",label:"分组人数",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.lableData.count,expression:"lableData.count !== 0"}],attrs:{"page-size":10,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.lableData.count},on:{"current-change":e.handleCurrentChange_label,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.authdialogFormVisible=!1}}},[e._v("关 闭")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitData()}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"查看已共享人员",visible:e.previewauthdialogFormVisible,width:"30%",center:""},on:{"update:visible":function(t){e.previewauthdialogFormVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-input",{staticStyle:{width:"50%","margin-left":"1px"},attrs:{placeholder:"请输入姓名",clearable:""},on:{clear:function(t){return e.getuserList2()}},model:{value:e.removeSharedUsers,callback:function(t){e.removeSharedUsers="string"===typeof t?t.trim():t},expression:"removeSharedUsers"}}),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",type:"success",plain:""},on:{click:function(t){return e.getuserList2()}}},[e._v("查询")]),t("el-tab-pane",{attrs:{label:"已共享人员",name:"first"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.membersData.results},on:{"selection-change":e.handleSelectionChange_remove}},[t("el-table-column",{attrs:{prop:"id",label:"用户ID",align:"center"}}),t("el-table-column",{attrs:{prop:"username",label:"名称",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.membersData.count,expression:"membersData.count !== 0"}],attrs:{"page-size":10,background:"","current-page":e.addcurrentPage,layout:"total, prev, pager, next, jumper",total:e.membersData.count},on:{"current-change":e.handleCurrentChange4,"update:currentPage":function(t){e.addcurrentPage=t},"update:current-page":function(t){e.addcurrentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1),t("el-tab-pane",{attrs:{label:"已共享分组",name:"second"}},[t("el-table",{attrs:{data:e.lableData.results},on:{"selection-change":e.handleSelectionChange_label_romeve}},[t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"name",label:"名称",align:"center"}}),t("el-table-column",{staticStyle:{width:"100%"},attrs:{property:"num",label:"分组人数",align:"center"}})],1),t("div",{staticStyle:{height:"25px"}}),t("el-col",{staticStyle:{"margin-left":"5px"},attrs:{span:7}},[t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:0!==e.lableData.count,expression:"lableData.count !== 0"}],attrs:{"page-size":10,background:"","current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.lableData.count},on:{"current-change":e.handleCurrentChange_label2,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),t("div",{staticStyle:{height:"50px"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.previewauthdialogFormVisible=!1}}},[e._v("关闭")])],1)],1)],1)},Be=[],Ve=i("1f82"),He=i("89c2"),We=i("6a87"),Ue=i("d72f"),Ke=(i("5c81"),{inject:["reload"],name:"tree",components:{ElCol:Ve["a"]},watch:{filterText(e){this.$refs.expandMenuList.filter(e)}},data(){return{data:[{name:"Alice",age:20},{name:"Bob",age:25},{name:"Charlie",age:30}],case_write_time:"",case_review_time:"",case_start_time:"",case_end_time:"",authority:"",addSharedUsers:"",removeSharedUsers:"",viewSharedUsers:"",columnPermissions:"",showDateArray:["薛公侯","何少军","泊毓燊","吴雪雯"],centerDialogVisible:!1,maxexpandId:He["a"].maxexpandId,non_maxexpandId:He["a"].maxexpandId,isLoadingTree:!1,setTree:[],defaultProps:{children:"children",label:"name"},defaultExpandKeys:[],tableData:[],filterText:"",treetype:"",operateOn:"",operationContent:"",beforeoperation:"",dialogFormVisible:!1,authdialogFormVisible:!1,previewauthdialogFormVisible:!1,form:{name:"",switch:"",type:"",caseid:"",beforeoperation:"",readwrite:"",creter:"",usermultipleSelection:[],labemultipleSelection:[]},formLabelWidth:"120px",checked:!1,visible:!1,name:"",caseid:"",treeid:"",centerDialogVisible:!1,eleId:"",isShow:!1,tableData:{count:0,results:[]},currentRow:"",casecurrentPage:1,menuVisible:!1,firstLevel:!1,maxexpandId:4,treeData:[],defaultProps:{children:"children",label:"label"},activeName:"first",readwrite:!0,sharecaseid:"",isButtonEnabled:!1,AddMembersDialogVisible:!1,RemoveMembersDialogVisible:!1,LookMembersDialogVisible:!1,AddLabelDialogVisible:!1,adduser:"",personalcenter:!1,loading:!1,lableData:[],currentPage:1,addcurrentPage:1,lookcurrentPage:1,removecurrentPage:1,labelname:"",membersData:[],userid:"",addmultipleSelection:[],labemultipleSelection:[],exportExcelSelection:[]}},computed:{shouldShowDateColumn(){return this.tableData.results.some(e=>this.showDateArray.includes(e.creter))}},beforeDestroy(){this.$bus.$off("showCaseNavigation",this.handleOpenPanelDialog)},created(){this.$bus.$on("showCaseNavigation",this.handleOpenPanelDialog),this.$bus.$on("show-login-dialog",()=>{this.centerDialogVisible=!1})},methods:{saveLocalFile(){Object(De["m"])({content:window.sessionStorage.getItem("SIMPLE_MIND_MAP_DATA"),caseid:window.sessionStorage.getItem("caseid"),name:window.sessionStorage.getItem("name"),switch:!0}).then(e=>{0==e.success?window.sessionStorage.setItem("switch","False"):window.sessionStorage.setItem("switch","True")}).catch(e=>{})},handleDialogClose(){},handleOpenPanelDialog(){this.saveLocalFile(),this.centerDialogVisible=!0,this.getCaseTree(),this.resetForm(),this.columnPermissions=window.sessionStorage.getItem("username")},submitData(){if(0!=this.addmultipleSelection.length||0!=this.labemultipleSelection.length){Object(De["c"])({name:"",caseid:this.sharecaseid,type:1,switch:!1,readwrite:this.readwrite,treename:"",beforeoperation:"",userlist:this.addmultipleSelection,labellist:this.labemultipleSelection}).then(e=>{e.success?(this.authdialogFormVisible=!1,this.$message.success({message:"添加成功~",type:"success",center:!0})):this.$message.error({message:e.msg,type:"success",center:!0})}).catch(e=>{this.$message.error({message:"添加失败，稍后再试~",type:"success",center:!0})})}else this.$message.error({message:"请勾选要添加数据",type:"success",center:!0})},handleSelectionChange_add(e){this.addmultipleSelection=e},handleSelectionChange_remove(e){this.form.usermultipleSelection=e},handleSelectionChange_label(e){this.labemultipleSelection=e},handleSelectionChange_label_romeve(e){this.form.labemultipleSelection=e},async getLabelList(){Object(Pe["d"])({page:this.currentPage,type:4,caseid:this.sharecaseid}).then(e=>{this.lableData=e})},getuserList(){this.lookcurrentPage=1,this.addcurrentPage=1,this.removecurrentPage=1;Object(Te["d"])({page:this.addcurrentPage,type:3,caseid:this.sharecaseid,username:this.addSharedUsers}).then(e=>{this.membersData=e})},getuserList2(){this.lookcurrentPage=1,this.addcurrentPage=1,this.removecurrentPage=1;Object(Te["d"])({page:this.addcurrentPage,type:4,caseid:this.sharecaseid,username:this.removeSharedUsers}).then(e=>{this.membersData=e})},async getLabelList2(){this.lookcurrentPage=1,this.addcurrentPage=1,this.removecurrentPage=1;Object(Pe["d"])({page:this.currentPage,type:5,caseid:this.sharecaseid}).then(e=>{this.lableData=e})},handleCurrentChange_label(e){Object(Pe["d"])({page:this.currentPage,type:4,caseid:this.sharecaseid}).then(e=>{this.lableData=e})},handleCurrentChange_label2(e){Object(Pe["d"])({page:this.currentPage,type:5,caseid:this.sharecaseid}).then(e=>{this.lableData=e})},handleCurrentChange3(e){Object(Te["d"])({page:this.addcurrentPage,type:3,label:"",caseid:this.sharecaseid,username:this.addSharedUsers}).then(e=>{this.membersData=e})},handleCurrentChange4(e){Object(Te["d"])({page:this.addcurrentPage,type:4,caseid:this.sharecaseid,username:this.removeSharedUsers}).then(e=>{this.membersData=e})},formatTime(e,t){let i=e[t.property];if(!i||isNaN(new Date(i)))return"";let s=new Date(i);const a=s.getFullYear();let n=s.getMonth()+1;n<10&&(n="0"+n);let o=s.getDate();o<10&&(o="0"+o);let l=s.getHours();l<10&&(l="0"+l);let r=s.getMinutes();r<10&&(r="0"+r);let c=s.getSeconds();return c<10&&(c="0"+c),a+"-"+n+"-"+o},formatTime2(e,t){let i=e[t.property];if(!i||isNaN(new Date(i)))return"";let s=new Date(i);const a=s.getFullYear();let n=s.getMonth()+1;n<10&&(n="0"+n);let o=s.getDate();o<10&&(o="0"+o);let l=s.getHours();l<10&&(l="0"+l);let r=s.getMinutes();r<10&&(r="0"+r);let c=s.getSeconds();return c<10&&(c="0"+c),a+"-"+n+"-"+o+" "+l+":"+r+":"+c},filterNode(e,t){return!e||-1!==t.name.indexOf(e)},async getCaseTree(){Object(Ue["b"])({}).then(e=>{this.setTree=e})},renderTipsHeader2(e,{column:t}){return e("div",[e("span",t.label),e("el-tooltip",{props:{effect:"dark",content:"读写:共享时内容读写不限制；仅读：共享时他人仅读不可修改内容~",placement:"top"}},[e("i",{class:"el-icon-question",style:"color:#409EFF;margin-left:5px;"})])])},updateAuth(e){this.currentPage=1,this.activeName="first",this.sharecaseid=e.caseid,this.authdialogFormVisible=!0,this.addSharedUsers="",this.removeSharedUsers="",this.getLabelList(),this.getuserList()},updateMimdMap(e){this.currentPage=1,this.activeName="first",this.sharecaseid=e.caseid,this.form.caseid=e.caseid,this.form.name=e.name,this.form.type=e.type,this.form.switch=e.switch,this.form.readwrite=e.switch,this.form.beforeoperation="",this.form.creter=e.creter,"True"==e.switch?this.readwrite=!0:this.readwrite=!1,this.dialogFormVisible=!0,this.getLabelList2(),this.getuserList2()},preview(e){this.previewauthdialogFormVisible=!0,this.currentPage=1,this.activeName="first",this.sharecaseid=e.caseid,this.form.caseid=e.caseid,this.form.name=e.name,this.form.type=e.type,this.form.switch=e.switch,this.form.beforeoperation="",this.getLabelList2(),this.getuserList2()},fromMimdMap(e){if(this.case_write_time){let e=new Date(this.case_write_time).getFullYear(),t=("0"+(new Date(this.case_write_time).getMonth()+1)).slice(-2),i=("0"+new Date(this.case_write_time).getDate()).slice(-2),s=`${e}-${t}-${i}`;this.case_write_time=s}else this.case_write_time=null;if(this.case_review_time){let e=new Date(this.case_review_time).getFullYear(),t=("0"+(new Date(this.case_review_time).getMonth()+1)).slice(-2),i=("0"+new Date(this.case_review_time).getDate()).slice(-2),s=`${e}-${t}-${i}`;this.case_review_time=s}else this.case_review_time=null;if(this.case_start_time){let e=new Date(this.case_start_time).getFullYear(),t=("0"+(new Date(this.case_start_time).getMonth()+1)).slice(-2),i=("0"+new Date(this.case_start_time).getDate()).slice(-2),s=`${e}-${t}-${i}`;this.case_start_time=s}else this.case_start_time=null;if(this.case_end_time){let e=new Date(this.case_end_time).getFullYear(),t=("0"+(new Date(this.case_end_time).getMonth()+1)).slice(-2),i=("0"+new Date(this.case_end_time).getDate()).slice(-2),s=`${e}-${t}-${i}`;this.case_end_time=s}else this.case_end_time=null;Object(De["o"])({name:this.form.name,caseid:this.form.caseid,type:this.form.type,switch:this.readwrite,treeid:"",treename:"",beforeoperation:"",labellist:this.form.labemultipleSelection,userlist:this.form.usermultipleSelection,case_write_time:this.case_write_time,case_review_time:this.case_review_time,case_start_time:this.case_start_time,case_end_time:this.case_end_time}).then(e=>{e.success?(this.$message.success({message:"编辑成功~",type:"success",center:!0}),this.dialogFormVisible=!1,this.form.type="",this.form.switch="",this.form.caseid==window.sessionStorage.getItem("caseid")&&(1==this.readwrite?(this.authority="读写",sessionStorage.setItem("switch","True")):(this.authority="仅读",sessionStorage.setItem("switch","False")),this.$emit("sendData",{caseid:this.form.caseid,name:this.form.name,authority:this.authority,creter:this.form.creter})),this.getCaseMindmapList()):this.$message.error(e.msg)}).catch(e=>{this.$message.error("编辑异常")})},handleSelectionChange_exportExcel(e){this.exportExcelSelection=e},exportExcel(){console.log(6)},deleteMimdMap(e){this.$confirm("此操作将会被监控，且永久删除该用例, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(De["h"])({caseid:e.caseid,name:e.name}).then(e=>{e.success,this.$message.error(e.msg)}).catch(e=>{this.$message.error("删除异常，请稍后删除。")})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},copyMimdMap(e){var t="TMIND"+Date.now();this.$confirm("复制后新ID:"+t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(De["g"])({copyid:t,caseid:e}).then(e=>{e.success?(this.getCaseMindmapList(),this.$message.success("复制成功，用例ID:"+t)):this.$message.error("复制失败。")}).catch(e=>{this.$message.error("复制异常，请稍后复制。")})}).catch(()=>{this.$message({type:"info",message:"已取消复制"})})},enterMimdMap(e){if(this.reload(),e.caseid!=window.sessionStorage.getItem("caseid")){Object(De["i"])({caseid:e.caseid,treeid:"",name:"",switch:""}).then(t=>{t.count>0?(sessionStorage.setItem("caseid",t.results[0].caseid),sessionStorage.setItem("switch",e.switch),sessionStorage.setItem("creter",e.creter),this.$bus.$emit("setData",JSON.parse(t.results[0].content)),"True"==e.switch?this.authority="读写":this.authority="仅读",this.$emit("sendData",{caseid:e.caseid,name:e.name,authority:this.authority,creter:e.creter}),this.centerDialogVisible=!1,this.reload()):this.$message.error("该用例已被删除，请刷新当前列表。"),sessionStorage.setItem("treename",e.treename)}).catch(e=>{})}else this.centerDialogVisible=!1,"True"==e.switch?(this.authority="读写",sessionStorage.setItem("switch","True")):(this.authority="仅读",sessionStorage.setItem("switch","False")),this.$emit("sendData",{caseid:e.caseid,name:e.name,authority:this.authority,creter:e.creter}),this.reload()},cellMouseEnter(e){this.currentRow=e},cellMouseLeave(e){this.currentRow=""},handleCurrentChange(e){Object(De["e"])({page:this.casecurrentPage,name:this.name,caseid:this.caseid,treeid:this.treeid,checked:this.checked,switch:this.form.switch,type:this.form.type}).then(e=>{this.tableData=e})},async editCaseTree(e){Object(Ue["a"])({id:"3",content:this.setTree,treetype:this.treetype,beforeoperation:this.beforeoperation,operationContent:this.operationContent,caseid:sessionStorage.getItem("caseid")}).then(e=>{})},async getCaseMindmapList(){this.treeid="";Object(De["j"])({name:this.name,treeid:"",caseid:this.caseid,checked:this.checked,page:this.casecurrentPage,switch:this.form.switch,type:""}).then(e=>{this.tableData=e}).catch(e=>{console.log("出错了")})},async getCaseMindmapListSelf(){this.treeid="",this.casecurrentPage=1;Object(De["j"])({name:this.name,treeid:"",caseid:this.caseid,checked:this.checked,page:this.casecurrentPage,switch:this.form.switch,type:this.form.type}).then(e=>{this.tableData=e})},async getCaseMindmapListButton(){this.treeid="",this.casecurrentPage=1;Object(De["j"])({name:this.name,treeid:"",caseid:this.caseid,checked:this.checked,page:1,switch:this.form.switch,type:this.form.type}).then(e=>{this.tableData=e})},resetForm(){this.filterText="",this.caseid="",this.name="",this.checked=!1,this.casecurrentPage=1,this.form.switch="",this.form.type="";Object(De["j"])({name:this.name,treeid:"",caseid:this.caseid,checked:!1,page:1,switch:this.form.switch,type:this.form.type}).then(e=>{this.tableData=e})},initExpand(){this.setTree.map(e=>{this.defaultExpandKeys.push(e.id)}),this.isLoadingTree=!0},handleNodeClick(e,t,i){e.isEdit=!1;var s=[];s.push(e.id);for(let a=0;a<e.children.length;a++){s.push(e.children[a].id);for(let t=0;t<e.children[a].children.length;t++){s.push(e.children[a].children[t].id);for(let i=0;i<e.children[a].children[t].children.length;i++)s.push(e.children[a].children[t].children[i].id)}}console.log(s);Object(De["n"])({name:"",treeid:s,caseid:"",checked:this.checked,switch:"",type:""}).then(e=>{this.tableData=e})},renderContent(e,{node:t,data:i,store:s}){let a=this;const n="el-icon-folder";return e("div",[e("i",{class:n}),e(We["a"],{props:{DATA:i,NODE:t,STORE:s,maxexpandId:a.non_maxexpandId},on:{nodeAdd:(e,t,i)=>a.handleAdd(e,t,i),nodeEdit:(e,t,i)=>a.handleEdit(e,t,i),nodeDel:(e,t,i)=>a.handleDelete(e,t,i)}})])},handleAddTop(){this.$prompt("请输入节点名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,20}$/,inputErrorMessage:"请输入1到20个字符"}).then(({value:e})=>{this.setTree.push({id:Date.now(),name:e,pid:"",isEdit:!1,children:[]}),this.editCaseTree(),this.$message.success({message:"添加成功~",type:"success",center:!0})}).catch(()=>{})},handleAdd(e,t,i){if(console.log(e,t,i),i.level>=4)return this.$message.error("最多只支持四级~"),!1;this.$prompt("请输入节点名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{1,20}$/,inputErrorMessage:"请输入1到20个字符"}).then(({value:e})=>{t.children.push({id:Date.now(),name:e,pid:t.id,isEdit:!1,children:[]}),this.editCaseTree(),this.$message.success({message:"添加成功~",type:"success",center:!0})}).catch(()=>{}),i.expanded||(i.expanded=!0)},handleEdit(e,t,i){t.isEdit=!1,this.$prompt("请输入节点名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:t.name,inputPattern:/^.{1,20}$/,inputErrorMessage:"请输入1到20个字符"}).then(({value:e})=>{t.name=e,t.isEdit=!1,this.treetype="编辑",this.beforeoperation=t.name,this.editCaseTree();Object(Ue["c"])({treeid:t.id,treename:e}).then(e=>{this.treeid=JSON.stringify(data.id)});this.$message.success({message:"编辑成功~",type:"success",center:!0})}).catch(()=>{})},handleDelete(e,t,i){console.log(e.name,t,i),console.log(e,t.name,i),console.log(e,t,i.name);let s=this;if(t.children&&0!==t.children.length)return this.$message.error("此节点有子级，不可删除！"),!1;Object(De["j"])({name:"",caseid:"",treeid:t.id,checked:"",switch:"",type:""}).then(e=>{if(0!=e.count)this.$message.error({message:"删除失败，目录下有关联用例~",type:"success",center:!0});else{let e=()=>{let e=i.parent.data.children||i.parent.data,s=999999;e.map((e,i)=>{t.id==e.id&&(s=i)});e.splice(s,1);this.treetype="删除",this.operationContent=t.name,this.editCaseTree(),this.$message.success({message:"删除成功~",type:"success",center:!0})},a=()=>{s.$confirm("名称：《"+t.name+"》，确定删除此目录？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{e()}).catch(()=>!1)};t.id==this.non_maxexpandId?e():a()}})}},mounted(){this.initExpand()}}),Ye=Ke,Xe=(i("ce56"),Object(m["a"])(Ye,Ae,Be,!1,null,null,null)),Ge=Xe.exports,Ze=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"新建",visible:e.addDialogVisible,width:"35%",center:""},on:{"update:visible":function(t){e.addDialogVisible=t}}},[t("div",[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用例名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入用例名称"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"用例目录",prop:"selectTreeName"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择","popper-append-to-body":!1},model:{value:e.ruleForm.selectTreeName,callback:function(t){e.$set(e.ruleForm,"selectTreeName",t)},expression:"ruleForm.selectTreeName"}},[t("el-option",{staticClass:"setstyle",staticStyle:{overflow:"auto",height:"100%",width:"100%"},attrs:{value:e.selectTree,disabled:""}},[t("div",{staticStyle:{height:"15px"}}),t("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),t("div",{staticStyle:{height:"15px"}}),t("el-tree",{ref:"tree",attrs:{data:e.setTree,"node-key":"id","highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"render-content":e.renderContent,"default-expanded-keys":e.defaultExpandKeys},on:{"node-click":e.handleNodeClick}})],1)],1)],1),t("el-form-item",[t("el-button",{staticStyle:{"margin-left":"15%"},on:{click:function(t){return e.resetForm()}}},[e._v("关闭")]),t("el-button",{attrs:{type:"success"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("新增")])],1)],1)],1)])],1)},qe=[],Je={inject:["reload"],components:{},data(){return{maxexpandId:He["a"].maxexpandId,non_maxexpandId:He["a"].maxexpandId,isLoadingTree:!1,setTree:He["a"].treelist,defaultProps:{children:"children",label:"name"},defaultExpandKeys:[],filterText:"",addFrom:{name:"",caseid:"",treename:"",treeid:"",type:"1",switch:!1,content:""},selectTreeName:"",selectTree:"",addDialogVisible:!1,ruleForm:{name:"",selectTreeName:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:25,message:"长度在 2 到 25 个字符",trigger:"blur"}],selectTreeName:[{required:!0,message:"请选中目录",trigger:"blur"}]}}},created(){this.$bus.$on("showAddcase",()=>{this.addDialogVisible=!0,this.getCaseTree(),this.ruleForm.name="",this.ruleForm.selectTreeName="导图目录",this.addFrom.treeid="",this.addFrom.treename=""})},watch:{filterText(e){this.$refs.tree.filter(e)}},methods:{initExpand(){this.setTree.map(e=>{this.defaultExpandKeys.push(e.id)}),this.isLoadingTree=!0},handleNodeClick(e,t,i){console.log(e.id),e.isEdit=!1,this.ruleForm.selectTreeName=e.name,this.addFrom.treeid=e.id,this.addFrom.treename=e.name,sessionStorage.setItem("treename",e.name)},renderContent(e,{node:t,data:i,store:s}){let a=this;return e(We["a"],{props:{DATA:i,NODE:t,STORE:s,maxexpandId:a.non_maxexpandId},on:{nodeAdd:(e,t,i)=>a.handleAdd(e,t,i),nodeEdit:(e,t,i)=>a.handleEdit(e,t,i),nodeDel:(e,t,i)=>a.handleDelete(e,t,i)}})},async getCaseTree(){Object(Ue["b"])({}).then(e=>{this.setTree=e})},submitForm(e){this.$refs[e].validate(e=>{if(!e)return console.log("新建发生了错误!!"),!1;{let e=Object(de["b"])(this.ruleForm.name);this.addFrom.name=this.ruleForm.name,this.addFrom.content=e,sessionStorage.setItem("name",this.ruleForm.name),this.$emit("sendData",this.addFrom);Object(De["a"])(this.addFrom).then(e=>{this.addFrom.caseid=e.caseid,this.$emit("sendData",this.addFrom),window.sessionStorage.setItem("caseid",e.caseid)});this.$bus.$emit("setData",e),this.$notify({title:"新建",message:"新建成功",type:"success",position:"top-left"}),this.addDialogVisible=!1}})},resetForm(){this.addDialogVisible=!1}},mounted(){this.initExpand()}},Qe=Je,et=(i("a976"),Object(m["a"])(Qe,Ze,qe,!1,null,"8710b1e8",null)),tt=et.exports;let it=null;var st={name:"Toolbar",components:{NodeImage:g,NodeHyperlink:w,NodeIcon:N,NodeNote:F,NodeTag:V,Export:Z,Import:le,ToolbarNodeBtnList:fe,AddCase:tt,Log:ke,CaseNavigation:Ge,Login:Ie,Collaborate:ze},data(){return{historicalDialogVisible:!1,ID:"",name:"",xuanzhong:"",activeNodes:[],backEnd:!1,forwardEnd:!0,readonly:!1,isFullDataFile:!1,timer:null,addDialogVisible:!1,filterText:"",maxexpandId:He["a"].maxexpandId,non_maxexpandId:He["a"].maxexpandId,isLoadingTree:!1,setTree:He["a"].treelist,defaultProps:{children:"children",label:"name"},defaultExpandKeys:[],list:["back","forward","painter","siblingNode","childNode","deleteNode","image","icon","link","note","tag","summary","associativeLine","formula"],horizontalList:[],verticalList:[],showMoreBtn:!0,popoverShow:!1,fileTreeProps:{label:"name",children:"children",isLeaf:"leaf"},fileTreeVisible:!1,rootDirName:"",fileTreeExpand:!0}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,isHandleLocalFile:e=>e.isHandleLocalFile}),hasRoot(){return-1!==this.activeNodes.findIndex(e=>e.isRoot)},hasGeneralization(){return-1!==this.activeNodes.findIndex(e=>e.isGeneralization)}},watch:{isHandleLocalFile(e){e||re["Notification"].closeAll()}},created(){this.$bus.$on("write_local_file",this.onWriteLocalFile),this.ID=window.sessionStorage.getItem("caseid"),this.name=window.sessionStorage.getItem("name")},mounted(){this.computeToolbarShow(),this.computeToolbarShowThrottle=Object(d["tb"])(this.computeToolbarShow,300),window.addEventListener("resize",this.computeToolbarShowThrottle),this.$bus.$on("lang_change",this.computeToolbarShowThrottle),this.initExpand()},beforeDestroy(){this.$bus.$off("write_local_file",this.onWriteLocalFile),window.removeEventListener("resize",this.computeToolbarShowThrottle),this.$bus.$off("lang_change",this.computeToolbarShowThrottle)},methods:{clickHistoricalDialogVisible(){Object(De["k"])({id:window.sessionStorage.getItem("logid"),caseid:window.sessionStorage.getItem("logcase")}).then(e=>{e.success?(this.historicalDialogVisible=!1,this.$message.success({message:"恢复成功~",type:"success",center:!0})):this.$message.error({message:"恢复失败~",type:"success",center:!0})})},goback(){"jumptolog"==window.sessionStorage.getItem("jumptocase")?this.$router.push("/logs"):this.$router.push("/caseNavigation"),window.sessionStorage.removeItem("logid"),window.sessionStorage.removeItem("logcase")},initExpand(){this.setTree.map(e=>{this.defaultExpandKeys.push(e.id)}),this.isLoadingTree=!0},handleNodeClick(e,t,i){console.log(e.id),e.isEdit=!1,this.xuanzhong=e.name,this.selectTreeId=e.id,this.selectTreeName=e.name},renderContent(e,{node:t,data:i,store:s}){let a=this;return e(We["a"],{props:{DATA:i,NODE:t,STORE:s,maxexpandId:a.non_maxexpandId},on:{nodeAdd:(e,t,i)=>a.handleAdd(e,t,i),nodeEdit:(e,t,i)=>a.handleEdit(e,t,i),nodeDel:(e,t,i)=>a.handleDelete(e,t,i)}})},async getCaseTree(){Object(Ue["b"])({}).then(e=>{this.setTree=e})},filterNode(e,t){return!e||-1!==t.name.indexOf(e)},computeToolbarShow(){const e=window.innerWidth-40,t=[...this.list];let i=1;const s=()=>{if(i>t.length)return a();this.horizontalList=t.slice(0,i),this.$nextTick(()=>{const n=this.$refs.toolbarRef.getBoundingClientRect().width;n<e?(i++,s()):i>0&&n>e&&(i--,this.horizontalList=t.slice(0,i),a())})},a=()=>{this.verticalList=t.slice(i),this.showMoreBtn=this.verticalList.length>0};s()},onWriteLocalFile(e){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.writeLocalFile(e)},1e3)},async loadFileTreeNode(e,t){try{let i;0===e.level?(i=await window.showDirectoryPicker(),this.rootDirName=i.name):i=e.data.handle;const s=[],a=[];for await(const[e,t]of i.entries()){const i="file"===t.kind;if(i&&!/\.(smm|xmind|md|json)$/.test(t.name))continue;const n=i&&/\.smm$/.test(t.name),o={id:e,name:t.name,type:t.kind,handle:t,leaf:i,enableEdit:n};i?a.push(o):s.push(o)}t([...s,...a])}catch(i){if(console.log(i),this.fileTreeVisible=!1,t([]),i.toString().includes("aborted"))return;this.$message.warning(this.$t("toolbar.notSupportTip"))}},openDirectory(){this.fileTreeVisible=!1,this.fileTreeExpand=!0,this.rootDirName="",this.$nextTick(()=>{this.fileTreeVisible=!0})},editLocalFile(e){e.handle&&(it=e.handle,this.readFile())},async importLocalFile(e){try{const t=await e.handle.getFile();this.$refs.ImportRef.onChange({raw:t,name:t.name}),this.$refs.ImportRef.confirm()}catch(t){console.log(t)}},async openLocalFile(){try{let[e]=await window.showOpenFilePicker({types:[{description:"",accept:{"application/json":[".smm"]}}],excludeAcceptAllOption:!0,multiple:!1});if(!e)return;if(it=e,"directory"===it.kind)return void this.$message.warning(this.$t("toolbar.selectFileTip"));this.readFile()}catch(e){if(console.log(e),e.toString().includes("aborted"))return;this.$message.warning(this.$t("toolbar.notSupportTip"))}},async readFile(){let e=await it.getFile(),t=new FileReader;t.onload=async()=>{this.$store.commit("setIsHandleLocalFile",!0),this.setData(t.result),re["Notification"].closeAll(),Object(re["Notification"])({title:this.$t("toolbar.tip"),message:`${this.$t("toolbar.editingLocalFileTipFront")}${e.name}${this.$t("toolbar.editingLocalFileTipEnd")}`,duration:0,showClose:!0})},t.readAsText(e)},setData(e){try{let t=JSON.parse(e);if("object"!==typeof t)throw new Error(this.$t("toolbar.fileContentError"));t.root?this.isFullDataFile=!0:(this.isFullDataFile=!1,t={...ce["a"],root:t}),this.$bus.$emit("setData",t)}catch(t){console.log(t),this.$message.error(this.$t("toolbar.fileOpenFailed"))}},async writeLocalFile(e){if(!it||!this.isHandleLocalFile)return;this.isFullDataFile||(e=e.root);let t=JSON.stringify(e);const i=await it.createWritable();await i.write(t),await i.close()},async createNewLocalFile(){await this.createLocalFile(ce["a"])},async createLocalFile(e){try{let t=await window.showSaveFilePicker({types:[{description:"",accept:{"application/json":[".smm"]}}],suggestedName:this.$t("toolbar.defaultFileName")});if(!t)return;const i=this.$loading({lock:!0,text:this.$t("toolbar.creatingTip"),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});it=t,this.$store.commit("setIsHandleLocalFile",!0),this.isFullDataFile=!0,await this.writeLocalFile(e),await this.readFile(),i.close()}catch(t){if(console.log(t),t.toString().includes("aborted"))return;this.$message.warning(this.$t("toolbar.notSupportTip"))}},async refreshLocalFile(){Object(De["d"])({caseid:sessionStorage.getItem("caseid"),latest:!0}).then(e=>{e.success?(this.mindMapData=JSON.parse(e.content),this.$bus.$emit("setData",JSON.parse(e.content)),this.$message.success({message:"数据同步成功~",type:"success",center:!0})):this.$message.error("没有同步数据，请稍后再试~")}).catch(e=>{})},async copyLocalFile(){var e="TMIND"+Date.now();Object(De["f"])({copyid:e,caseid:window.sessionStorage.getItem("caseid"),content:window.sessionStorage.getItem("SIMPLE_MIND_MAP_DATA")}).then(t=>{this.$message.success("复制成功~"),sessionStorage.setItem("caseid",e),this.reload()}).catch(e=>{this.$message.error("复制失败，初始化数据不能复制~")})},async saveLocalFile(){Object(De["m"])({content:window.sessionStorage.getItem("SIMPLE_MIND_MAP_DATA"),caseid:window.sessionStorage.getItem("caseid"),name:window.sessionStorage.getItem("name")}).then(e=>{e.success?this.$notify({title:"成功",message:"保存成功",type:"success",position:"top-left"}):this.$confirm("该用例创建人设置仅读，不可读写，你可以在该基础上点击复制，系统则为你复制一份属于你修改后的用例，是否复制？","温馨提示",{distinguishCancelAndClose:!0,confirmButtonText:"复制",cancelButtonText:"放弃复制",type:"success"}).then(()=>{this.copyLocalFile()}).catch(e=>{this.$message({type:"info",message:"放弃复制"})})}).catch(e=>{this.$message.error("保存失败")})},async saveAsLocalFile(){this.filterText="",this.xuanzhong="",this.selectTreeId="",this.addDialogVisible=!0,this.getCaseTree()},async savaAs(){if(""==this.selectTreeId)this.$message.error({message:"请先选中目录再保存~",center:!0});else{Object(De["o"])({name:"",caseid:window.sessionStorage.getItem("caseid"),type:"",switch:window.sessionStorage.getItem("switch"),treeid:this.selectTreeId,treename:this.selectTreeName,beforeoperation:window.sessionStorage.getItem("treename"),userlist:[],labellist:[]}).then(e=>{e.success?(this.addDialogVisible=!1,this.$message.success("另存为成功~")):this.$message.error(e.msg)}).catch(e=>{this.$message.error("另存为成功失败~")})}}}},at=st,nt=(i("f2ef"),Object(m["a"])(at,n,o,!1,null,"c32d42f4",null)),ot=nt.exports,lt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editContainer",on:{dragenter:function(t){return t.stopPropagation(),t.preventDefault(),e.onDragenter.apply(null,arguments)},dragleave:function(e){e.stopPropagation(),e.preventDefault()},dragover:function(e){e.stopPropagation(),e.preventDefault()},drop:function(e){e.stopPropagation(),e.preventDefault()}}},[t("div",{ref:"mindMapContainer",staticClass:"mindMapContainer",attrs:{id:"mindMapContainer"}}),e.mindMap?t("Contextmenu",{attrs:{mindMap:e.mindMap}}):e._e()],1)},rt=[],ct=i("7145"),dt=i("4db5"),ht=i("43cc"),ut=i("a832"),mt=i("364c"),pt=i("3041"),gt=i("67c2"),ft=i("99e0"),bt=i("cbc1"),vt=i("8dfd"),yt=i("5d70"),Ct=i("a87c"),wt=i("fa22"),_t=i("73c1"),xt=i("49ee"),kt=i("ee73"),St=i("f904"),$t=i("f136"),Dt=i("1e64"),Tt=i("3b44"),Nt=i("9d5a"),Lt=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("outline.title")}},[t("div",{staticClass:"changeBtn",class:{isDark:e.isDark},on:{click:e.onChangeToOutlineEdit}},[t("span",{staticClass:"icon iconfont iconquanping1"})]),"outline"===e.activeSidebar?t("Outline",{attrs:{mindMap:e.mindMap},on:{scrollTo:e.onScrollTo}}):e._e()],1)},Mt=[],It=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sidebarContainer",class:{show:e.show,isDark:e.isDark},style:{zIndex:e.zIndex},on:{click:function(e){e.stopPropagation()}}},[t("span",{staticClass:"closeBtn el-icon-close",on:{click:e.close}}),e.title?t("div",{staticClass:"sidebarHeader"},[e._v(" "+e._s(e.title)+" ")]):e._e(),t("div",{ref:"sidebarContent",staticClass:"sidebarContent"},[e._t("default")],2)])},Ot=[],Et={name:"Sidebar",props:{title:{type:String,default:""}},data(){return{show:!1,zIndex:0}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark})},watch:{show(e,t){e&&!t&&(this.zIndex=K["u"].sidebarZIndex++)}},created(){this.$bus.$on("closeSideBar",this.handleCloseSidebar)},beforeDestroy(){this.$bus.$off("closeSideBar",this.handleCloseSidebar)},methods:{...Object(U["c"])(["setActiveSidebar"]),handleCloseSidebar(){this.close()},close(){this.show=!1,this.setActiveSidebar("")},getEl(){return this.$refs.sidebarContent}}},Pt=Et,Ft=(i("3216"),Object(m["a"])(Pt,It,Ot,!1,null,"0dbbc36a",null)),jt=Ft.exports,Rt=function(){var e=this,t=e._self._c;return t("el-tree",{ref:"tree",staticClass:"outlineTree",class:{isDark:e.isDark},attrs:{"node-key":"uid",draggable:"","default-expand-all":"",data:e.data,props:e.defaultProps,"highlight-current":!0,"expand-on-click-node":!1,"allow-drag":e.checkAllowDrag},on:{"node-drop":e.onNodeDrop,"current-change":e.onCurrentChange},nativeOn:{mouseenter:function(t){e.isInTreArea=!0},mouseleave:function(t){e.isInTreArea=!1}},scopedSlots:e._u([{key:"default",fn:function({node:i,data:s}){return t("span",{staticClass:"customNode",attrs:{"data-id":s.uid},on:{click:function(t){return e.onClick(s)}}},[t("span",{key:e.getKey(),staticClass:"nodeEdit",attrs:{contenteditable:!e.isReadonly},domProps:{innerHTML:e._s(i.label)},on:{keydown:function(t){return t.stopPropagation(),e.onNodeInputKeydown(t,i)},keyup:function(e){e.stopPropagation()},blur:function(t){return e.onBlur(t,i)},paste:function(t){return e.onPaste(t,i)}}})])}}])})},zt=[],At=(i("5b81"),{name:"Outline",props:{mindMap:{type:Object}},data(){return{data:[],defaultProps:{label:"label"},currentData:null,notHandleDataChange:!1,isHandleNodeTreeRenderEnd:!1,beInsertNodeUid:"",insertType:"",isInTreArea:!1,isAfterCreateNewNode:!1}},computed:{...Object(U["d"])({isReadonly:e=>e.isReadonly,isDark:e=>e.localConfig.isDark})},created(){window.addEventListener("keydown",this.onKeyDown),this.$bus.$on("data_change",this.handleDataChange),this.$bus.$on("node_tree_render_end",this.handleNodeTreeRenderEnd),this.$bus.$on("hide_text_edit",this.handleHideTextEdit)},mounted(){this.refresh()},beforeDestroy(){window.removeEventListener("keydown",this.onKeyDown),this.$bus.$off("data_change",this.handleDataChange),this.$bus.$off("node_tree_render_end",this.handleNodeTreeRenderEnd),this.$bus.$off("hide_text_edit",this.handleHideTextEdit)},methods:{handleHideTextEdit(){this.notHandleDataChange&&(this.notHandleDataChange=!1,this.refresh())},handleDataChange(){if(this.notHandleDataChange)return this.notHandleDataChange=!1,void(this.isAfterCreateNewNode=!1);this.isAfterCreateNewNode?this.isAfterCreateNewNode=!1:this.refresh()},handleNodeTreeRenderEnd(){if(this.insertType)return this[this.insertType](),void(this.insertType="");this.isHandleNodeTreeRenderEnd&&(this.isHandleNodeTreeRenderEnd=!1,this.refresh(),this.$nextTick(()=>{this.afterCreateNewNode()}))},refresh(){let e=this.mindMap.getData();e.root=!0;let t=e=>{let i=e.data.richText?Object(d["eb"])(e.data.text):e.data.text;i=Object(d["T"])(i),i=i.replaceAll(/\n/g,"<br>"),e.textCache=i,e.label=i,e.uid=e.data.uid,e.children&&e.children.length>0&&e.children.forEach(e=>{t(e)})};t(e),this.data=[e]},afterCreateNewNode(){let e=this.beInsertNodeUid;if(e&&this.$refs.tree)try{this.isAfterCreateNewNode=!0,this.$refs.tree.setCurrentKey(e);let t=this.$refs.tree.getNode(e);this.onCurrentChange(t.data),this.onClick(t.data);const i=document.querySelector(`.customNode[data-id="${e}"] .nodeEdit`);if(i){let e=window.getSelection(),t=document.createRange();t.selectNodeContents(i),e.removeAllRanges(),e.addRange(t);let s=i.offsetTop;this.$emit("scrollTo",s)}}catch(t){console.log(t)}this.beInsertNodeUid=""},checkAllowDrag(e){return!e.data.root},onBlur(e,t){if(t.data.textCache===e.target.innerHTML)return void(this.insertType&&(this[this.insertType](),this.insertType=""));const i=t.data.data.richText,s=i?e.target.innerHTML:e.target.innerText,a=this.mindMap.renderer.findNodeByUid(t.data.uid);a&&(this.notHandleDataChange=!0,i?a.setText(Object(d["sb"])(s),!0,!0):a.setText(s))},onPaste(e){Object(d["R"])(e)},getKey(){return Math.random()},onNodeInputKeydown(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),this.insertType="insertNode",e.target.blur()),9===e.keyCode&&(e.preventDefault(),e.shiftKey?(this.insertType="moveUp",e.target.blur()):(this.insertType="insertChildNode",e.target.blur()))},moveUp(){this.mindMap.execCommand("MOVE_UP_ONE_LEVEL")},insertNode(){this.notHandleDataChange=!0,this.isHandleNodeTreeRenderEnd=!0,this.beInsertNodeUid=Object(d["q"])(),this.mindMap.execCommand("INSERT_NODE",!1,[],{uid:this.beInsertNodeUid})},insertChildNode(){this.notHandleDataChange=!0,this.isHandleNodeTreeRenderEnd=!0,this.beInsertNodeUid=Object(d["q"])(),this.mindMap.execCommand("INSERT_CHILD_NODE",!1,[],{uid:this.beInsertNodeUid})},onClick(e){this.notHandleDataChange=!0;const t=this.mindMap.renderer.findNodeByUid(e.uid);t&&t.nodeData.data.isActive||this.mindMap.execCommand("GO_TARGET_NODE",e.uid,()=>{this.notHandleDataChange=!1})},onNodeDrop(e,t,i){this.notHandleDataChange=!0;const s=this.mindMap.renderer.findNodeByUid(e.data.uid),a=this.mindMap.renderer.findNodeByUid(t.data.uid);if(s&&a)switch(i){case"before":this.mindMap.execCommand("INSERT_BEFORE",s,a);break;case"after":this.mindMap.execCommand("INSERT_AFTER",s,a);break;case"inner":this.mindMap.execCommand("MOVE_NODE_TO",s,a);break;default:break}},onCurrentChange(e){this.currentData=e},onKeyDown(e){if(this.isInTreArea&&[46,8].includes(e.keyCode)&&this.currentData){e.stopPropagation(),this.mindMap.renderer.textEdit.hideEditTextBox();const t=this.mindMap.renderer.findNodeByUid(this.currentData.uid);t&&!t.isRoot&&(this.notHandleDataChange=!0,this.$refs.tree.remove(this.currentData),this.mindMap.execCommand("REMOVE_NODE",[t]))}}}}),Bt=At,Vt=(i("aefb"),Object(m["a"])(Bt,Rt,zt,!1,null,"116b8384",null)),Ht=Vt.exports,Wt={name:"OutlineSidebar",components:{Sidebar:jt,Outline:Ht},props:{mindMap:{type:Object}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,activeSidebar:e=>e.activeSidebar})},watch:{activeSidebar(e){this.$refs.sidebar.show="outline"===e}},methods:{...Object(U["c"])(["setIsOutlineEdit","setActiveSidebar"]),onChangeToOutlineEdit(){this.setActiveSidebar(""),this.setIsOutlineEdit(!0)},onScrollTo(e){let t=this.$refs.sidebar.getEl(),i=t.offsetHeight,s=t.scrollTop;e>s+i&&t.scrollTo(0,e-i/2)}}},Ut=Wt,Kt=(i("d104"),Object(m["a"])(Ut,Lt,Mt,!1,null,"86589586",null)),Yt=Kt.exports,Xt=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("style.title")}},[e.activeNodes.length>0?t("div",{staticClass:"styleBox",class:{isDark:e.isDark}},[t("div",{staticClass:"sidebarContent"},[t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("style.text")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.fontFamily")))]),t("el-select",{attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("fontFamily")}},model:{value:e.style.fontFamily,callback:function(t){e.$set(e.style,"fontFamily",t)},expression:"style.fontFamily"}},e._l(e.fontFamilyList,(function(e){return t("el-option",{key:e.value,style:{fontFamily:e.value},attrs:{label:e.name,value:e.value}})})),1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.fontSize")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("fontSize")}},model:{value:e.style.fontSize,callback:function(t){e.$set(e.style,"fontSize",t)},expression:"style.fontSize"}},e._l(e.fontSizeList,(function(e){return t("el-option",{key:e,style:{fontSize:e+"px"},attrs:{label:e,value:e}})})),1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.lineHeight")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("lineHeight")}},model:{value:e.style.lineHeight,callback:function(t){e.$set(e.style,"lineHeight",t)},expression:"style.lineHeight"}},e._l(e.lineHeightList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"btnGroup"},[t("el-tooltip",{attrs:{content:e.$t("style.color"),placement:"bottom"}},[t("div",{directives:[{name:"popover",rawName:"v-popover:popover",arg:"popover"}],staticClass:"styleBtn"},[e._v(" A "),t("span",{staticClass:"colorShow",style:{backgroundColor:e.style.color||"#eee"}})])]),t("el-tooltip",{attrs:{content:e.$t("style.addFontWeight"),placement:"bottom"}},[t("div",{staticClass:"styleBtn",class:{actived:"bold"===e.style.fontWeight},on:{click:e.toggleFontWeight}},[e._v(" B ")])]),t("el-tooltip",{attrs:{content:e.$t("style.italic"),placement:"bottom"}},[t("div",{staticClass:"styleBtn i",class:{actived:"italic"===e.style.fontStyle},on:{click:e.toggleFontStyle}},[e._v(" I ")])]),t("el-tooltip",{attrs:{content:e.$t("style.textDecoration"),placement:"bottom"}},[t("div",{directives:[{name:"popover",rawName:"v-popover:popover2",arg:"popover2"}],staticClass:"styleBtn u",style:{textDecoration:e.style.textDecoration||"none"}},[e._v(" U ")])])],1),t("el-popover",{ref:"popover",attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.style.color},on:{change:e.changeFontColor}})],1),t("el-popover",{ref:"popover2",attrs:{placement:"bottom",trigger:"hover"}},[t("el-radio-group",{attrs:{size:"mini"},on:{change:function(t){return e.update("textDecoration")}},model:{value:e.style.textDecoration,callback:function(t){e.$set(e.style,"textDecoration",t)},expression:"style.textDecoration"}},[t("el-radio-button",{attrs:{label:"none"}},[e._v(e._s(e.$t("style.none")))]),t("el-radio-button",{attrs:{label:"underline"}},[e._v(e._s(e.$t("style.underline")))]),t("el-radio-button",{attrs:{label:"line-through"}},[e._v(e._s(e.$t("style.lineThrough")))]),t("el-radio-button",{attrs:{label:"overline"}},[e._v(e._s(e.$t("style.overline")))])],1)],1)],1),t("div",{staticClass:"title"},[e._v(e._s(e.$t("style.border")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.color")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover3",arg:"popover3"}],staticClass:"block",style:{width:"80px",backgroundColor:e.style.borderColor}}),t("el-popover",{ref:"popover3",attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.style.borderColor},on:{change:e.changeBorderColor}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.style")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("borderDasharray")}},model:{value:e.style.borderDasharray,callback:function(t){e.$set(e.style,"borderDasharray",t)},expression:"style.borderDasharray"}},e._l(e.borderDasharrayList,(function(i){return t("el-option",{key:i.value,attrs:{label:i.name,value:i.value}},[t("svg",{attrs:{width:"120",height:"34"}},[t("line",{attrs:{x1:"10",y1:"17",x2:"110",y2:"17","stroke-width":"2",stroke:e.style.borderDasharray===i.value?"#409eff":e.isDark?"#fff":"#000","stroke-dasharray":i.value}})])])})),1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.width")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("borderWidth")}},model:{value:e.style.borderWidth,callback:function(t){e.$set(e.style,"borderWidth",t)},expression:"style.borderWidth"}},e._l(e.borderWidthList,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[i>0?t("span",{staticClass:"borderLine",class:{isDark:e.isDark},style:{height:i+"px"}}):e._e()])})),1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"rectangle"===e.style.shape,expression:"style.shape === 'rectangle'"}],staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.borderRadius")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("borderRadius")}},model:{value:e.style.borderRadius,callback:function(t){e.$set(e.style,"borderRadius",t)},expression:"style.borderRadius"}},e._l(e.borderRadiusList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)]),t("div",{staticClass:"title"},[e._v(e._s(e.$t("style.background")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.color")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover4",arg:"popover4"}],staticClass:"block",style:{backgroundColor:e.style.fillColor}}),t("el-popover",{ref:"popover4",attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.style.fillColor},on:{change:e.changeFillColor}})],1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.gradientStyle")))]),t("el-checkbox",{on:{change:function(t){return e.update("gradientStyle")}},model:{value:e.style.gradientStyle,callback:function(t){e.$set(e.style,"gradientStyle",t)},expression:"style.gradientStyle"}})],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.startColor")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover6",arg:"popover6"}],staticClass:"block",style:{backgroundColor:e.style.startColor}}),t("el-popover",{ref:"popover6",attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.style.startColor},on:{change:e.changeStartColor}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.endColor")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover7",arg:"popover7"}],staticClass:"block",style:{backgroundColor:e.style.endColor}}),t("el-popover",{ref:"popover7",attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.style.endColor},on:{change:e.changeEndColor}})],1)],1)]),t("div",{staticClass:"title"},[e._v(e._s(e.$t("style.shape")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.shape")))]),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("shape")}},model:{value:e.style.shape,callback:function(t){e.$set(e.style,"shape",t)},expression:"style.shape"}},e._l(e.shapeList,(function(i){return t("el-option",{key:i.value,attrs:{label:i.name,value:i.value}},[t("svg",{staticStyle:{"margin-top":"5px"},attrs:{width:"60",height:"26"}},[t("path",{attrs:{d:e.shapeListMap[i.value],fill:"none",stroke:e.style.shape===i.value?"#409eff":e.isDark?"#fff":"#000","stroke-width":"2"}})])])})),1)],1)]),t("div",{staticClass:"title"},[e._v(e._s(e.$t("style.line")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.color")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover5",arg:"popover5"}],staticClass:"block",style:{width:"80px",backgroundColor:e.style.lineColor}}),t("el-popover",{ref:"popover5",attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.style.lineColor},on:{change:e.changeLineColor}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.style")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("lineDasharray")}},model:{value:e.style.lineDasharray,callback:function(t){e.$set(e.style,"lineDasharray",t)},expression:"style.lineDasharray"}},e._l(e.borderDasharrayList,(function(i){return t("el-option",{key:i.value,attrs:{label:i.name,value:i.value}},[t("svg",{attrs:{width:"120",height:"34"}},[t("line",{attrs:{x1:"10",y1:"17",x2:"110",y2:"17","stroke-width":"2",stroke:e.style.lineDasharray===i.value?"#409eff":e.isDark?"#fff":"#000","stroke-dasharray":i.value}})])])})),1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.width")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("lineWidth")}},model:{value:e.style.lineWidth,callback:function(t){e.$set(e.style,"lineWidth",t)},expression:"style.lineWidth"}},e._l(e.borderWidthList,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[i>0?t("span",{staticClass:"borderLine",class:{isDark:e.isDark},style:{height:i+"px"}}):e._e()])})),1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.arrowDir")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("lineMarkerDir")}},model:{value:e.style.lineMarkerDir,callback:function(t){e.$set(e.style,"lineMarkerDir",t)},expression:"style.lineMarkerDir"}},[t("el-option",{key:"start",attrs:{label:e.$t("style.arrowDirStart"),value:"start"}}),t("el-option",{key:"end",attrs:{label:e.$t("style.arrowDirEnd"),value:"end"}})],1)],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("style.nodePadding")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.horizontal")))]),t("el-slider",{staticStyle:{width:"200px"},on:{change:function(t){return e.update("paddingX")}},model:{value:e.style.paddingX,callback:function(t){e.$set(e.style,"paddingX",t)},expression:"style.paddingX"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("style.vertical")))]),t("el-slider",{staticStyle:{width:"200px"},on:{change:function(t){return e.update("paddingY")}},model:{value:e.style.paddingY,callback:function(t){e.$set(e.style,"paddingY",t)},expression:"style.paddingY"}})],1)])])]):t("div",{staticClass:"tipBox"},[t("div",{staticClass:"tipIcon iconfont icontianjiazijiedian"}),t("div",{staticClass:"tipText"},[e._v("请选择一个节点")])])])},Gt=[],Zt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"colorContainer",class:{isDark:e.isDark}},[t("div",{staticClass:"colorList"},e._l(e.colorList,(function(i){return t("span",{key:i,staticClass:"colorItem iconfont",class:{icontouming:"transparent"===i},style:{backgroundColor:i},on:{click:function(t){return e.clickColorItem(i)}}})})),0),t("div",{staticClass:"moreColor"},[t("span",[e._v(e._s(e.$t("color.moreColor")))]),t("el-color-picker",{attrs:{size:"mini"},on:{change:e.changeColor},model:{value:e.selectColor,callback:function(t){e.selectColor=t},expression:"selectColor"}})],1)])},qt=[],Jt={name:"Color",props:{color:{type:String,default:""}},data(){return{colorList:K["g"],selectColor:""}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark})},watch:{color(){this.selectColor=this.color}},created(){this.selectColor=this.color},methods:{clickColorItem(e){this.$emit("change",e)},changeColor(){this.$emit("change",this.selectColor)}}},Qt=Jt,ei=(i("9c45"),Object(m["a"])(Qt,Zt,qt,!1,null,"1828fe16",null)),ti=ei.exports,ii={name:"Style",components:{Sidebar:jt,Color:ti},data(){return{fontSizeList:K["j"],borderWidthList:K["f"],borderRadiusList:K["e"],lineHeightList:K["l"],activeNodes:[],style:{shape:"",paddingX:0,paddingY:0,color:"",fontFamily:"",fontSize:"",lineHeight:"",textDecoration:"",fontWeight:"",fontStyle:"",borderWidth:"",borderColor:"",fillColor:"",borderDasharray:"",borderRadius:"",lineColor:"",lineDasharray:"",lineWidth:"",lineMarkerDir:"",gradientStyle:!1,startColor:"",endColor:""}}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,activeSidebar:e=>e.activeSidebar}),fontFamilyList(){return K["i"][this.$i18n.locale]||K["i"].zh},borderDasharrayList(){return K["d"][this.$i18n.locale]||K["d"].zh},shapeList(){return K["q"][this.$i18n.locale]||K["q"].zh},shapeListMap(){return K["r"][this.$i18n.locale]||K["r"].zh}},watch:{activeSidebar(e){this.$refs.sidebar.show="nodeStyle"===e}},created(){this.$bus.$on("node_active",this.onNodeActive)},beforeDestroy(){this.$bus.$off("node_active",this.onNodeActive)},methods:{onNodeActive(...e){this.$nextTick(()=>{this.activeNodes=[...e[1]],this.initNodeStyle()})},initNodeStyle(){this.activeNodes.length<=0||["shape","paddingX","paddingY","color","fontFamily","fontSize","lineHeight","textDecoration","fontWeight","fontStyle","borderWidth","borderColor","fillColor","borderDasharray","borderRadius","lineColor","lineDasharray","lineWidth","lineMarkerDir","gradientStyle","startColor","endColor"].forEach(e=>{this.style[e]=this.activeNodes[0].getStyle(e,!1)})},update(e){this.activeNodes.forEach(t=>{t.setStyle(e,this.style[e])})},toggleFontWeight(){"bold"===this.style.fontWeight?this.style.fontWeight="normal":this.style.fontWeight="bold",this.update("fontWeight")},toggleFontStyle(){"italic"===this.style.fontStyle?this.style.fontStyle="normal":this.style.fontStyle="italic",this.update("fontStyle")},changeFontColor(e){this.style.color=e,this.update("color")},changeBorderColor(e){this.style.borderColor=e,this.update("borderColor")},changeLineColor(e){this.style.lineColor=e,this.update("lineColor")},changeFillColor(e){this.style.fillColor=e,this.update("fillColor")},changeStartColor(e){this.style.startColor=e,this.update("startColor")},changeEndColor(e){this.style.endColor=e,this.update("endColor")}}},si=ii,ai=(i("3876"),i("c9b7"),Object(m["a"])(si,Xt,Gt,!1,null,"e08cca7a",null)),ni=ai.exports,oi=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("baseStyle.title")}},[e.data?t("div",{staticClass:"sidebarContent",class:{isDark:e.isDark}},[t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.background")))]),t("div",{staticClass:"row"},[t("el-tabs",{staticClass:"tab",model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:e.$t("baseStyle.color"),name:"color"}},[t("Color",{attrs:{color:e.style.backgroundColor},on:{change:t=>{e.update("backgroundColor",t)}}})],1),t("el-tab-pane",{attrs:{label:e.$t("baseStyle.image"),name:"image"}},[t("ImgUpload",{staticClass:"imgUpload",on:{change:t=>{e.update("backgroundImage",t)}},model:{value:e.style.backgroundImage,callback:function(t){e.$set(e.style,"backgroundImage",t)},expression:"style.backgroundImage"}}),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.imageRepeat")))]),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("backgroundRepeat",t)}},model:{value:e.style.backgroundRepeat,callback:function(t){e.$set(e.style,"backgroundRepeat",t)},expression:"style.backgroundRepeat"}},e._l(e.backgroundRepeatList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.imagePosition")))]),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("backgroundPosition",t)}},model:{value:e.style.backgroundPosition,callback:function(t){e.$set(e.style,"backgroundPosition",t)},expression:"style.backgroundPosition"}},e._l(e.backgroundPositionList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.imageSize")))]),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("backgroundSize",t)}},model:{value:e.style.backgroundSize,callback:function(t){e.$set(e.style,"backgroundSize",t)},expression:"style.backgroundSize"}},e._l(e.backgroundSizeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1)],1)],1),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.line")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.color")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover",arg:"popover"}],staticClass:"block",style:{backgroundColor:e.style.lineColor}}),t("el-popover",{ref:"popover",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.style.lineColor},on:{change:t=>{e.update("lineColor",t)}}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.width")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("lineWidth",t)}},model:{value:e.style.lineWidth,callback:function(t){e.$set(e.style,"lineWidth",t)},expression:"style.lineWidth"}},e._l(e.lineWidthList,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[i>0?t("span",{staticClass:"borderLine",class:{isDark:e.isDark},style:{height:i+"px"}}):e._e()])})),1)],1)]),t("div",{staticClass:"row"},[e.lineStyleListShow.length>1?t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.style")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("lineStyle",t)}},model:{value:e.style.lineStyle,callback:function(t){e.$set(e.style,"lineStyle",t)},expression:"style.lineStyle"}},e._l(e.lineStyleListShow,(function(i){return t("el-option",{key:i.value,staticClass:"lineStyleOption",class:{isDark:e.isDark,isSelected:e.style.lineStyle===i.value},attrs:{label:i.name,value:i.value},domProps:{innerHTML:e._s(e.lineStyleMap[i.value])}})})),1)],1):e._e(),"curve"===e.style.lineStyle&&e.showRootLineKeepSameInCurveLayouts?t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.rootStyle")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("rootLineKeepSameInCurve",t)}},model:{value:e.style.rootLineKeepSameInCurve,callback:function(t){e.$set(e.style,"rootLineKeepSameInCurve",t)},expression:"style.rootLineKeepSameInCurve"}},e._l(e.rootLineKeepSameInCurveList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1):e._e(),e.showLineRadius?t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.lineRadius")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("lineRadius",t)}},model:{value:e.style.lineRadius,callback:function(t){e.$set(e.style,"lineRadius",t)},expression:"style.lineRadius"}},e._l([0,2,5,7,10,12,15],(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1):e._e()]),t("div",{staticClass:"row"},["curve"===e.style.lineStyle&&e.showRootLineKeepSameInCurveLayouts?t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.rootLineStartPos")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("rootLineStartPositionKeepSameInCurve",t)}},model:{value:e.style.rootLineStartPositionKeepSameInCurve,callback:function(t){e.$set(e.style,"rootLineStartPositionKeepSameInCurve",t)},expression:"style.rootLineStartPositionKeepSameInCurve"}},[t("el-option",{key:"center",attrs:{label:e.$t("baseStyle.center"),value:!1}}),t("el-option",{key:"right",attrs:{label:e.$t("baseStyle.right"),value:!0}})],1)],1):e._e()]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-checkbox",{on:{change:t=>{e.update("showLineMarker",t)}},model:{value:e.style.showLineMarker,callback:function(t){e.$set(e.style,"showLineMarker",t)},expression:"style.showLineMarker"}},[e._v(e._s(e.$t("baseStyle.showArrow")))])],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.rainbowLines")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-popover",{attrs:{placement:"right",trigger:"click"},model:{value:e.rainbowLinesPopoverVisible,callback:function(t){e.rainbowLinesPopoverVisible=t},expression:"rainbowLinesPopoverVisible"}},[t("div",{staticClass:"rainbowLinesOptionsBox",class:{isDark:e.isDark}},e._l(e.rainbowLinesOptions,(function(i){return t("div",{key:i.value,staticClass:"optionItem"},[i.list?t("div",{staticClass:"colorsBar",on:{click:function(t){return e.updateRainbowLinesConfig(i)}}},e._l(i.list,(function(e){return t("span",{staticClass:"colorItem",style:{backgroundColor:e}})})),0):t("span",{on:{click:function(t){return e.updateRainbowLinesConfig(i)}}},[e._v(e._s(e.$t("baseStyle.notUseRainbowLines")))])])})),0),t("div",{staticClass:"curRainbowLine",attrs:{slot:"reference"},slot:"reference"},[e.curRainbowLineColorList?t("div",{staticClass:"colorsBar"},e._l(e.curRainbowLineColorList,(function(e){return t("span",{staticClass:"colorItem",style:{backgroundColor:e}})})),0):t("span",[e._v(e._s(e.$t("baseStyle.notUseRainbowLines")))])])])],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.lineOfOutline")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.color")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover2",arg:"popover2"}],staticClass:"block",style:{backgroundColor:e.style.generalizationLineColor}}),t("el-popover",{ref:"popover2",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.style.generalizationLineColor},on:{change:t=>{e.update("generalizationLineColor",t)}}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.width")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("generalizationLineWidth",t)}},model:{value:e.style.generalizationLineWidth,callback:function(t){e.$set(e.style,"generalizationLineWidth",t)},expression:"style.generalizationLineWidth"}},e._l(e.lineWidthList,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[i>0?t("span",{staticClass:"borderLine",class:{isDark:e.isDark},style:{height:i+"px"}}):e._e()])})),1)],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.associativeLine")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.associativeLineColor")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover4",arg:"popover4"}],staticClass:"block",style:{backgroundColor:e.style.associativeLineColor}}),t("el-popover",{ref:"popover4",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.style.associativeLineColor},on:{change:t=>{e.update("associativeLineColor",t)}}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.associativeLineWidth")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("associativeLineWidth",t)}},model:{value:e.style.associativeLineWidth,callback:function(t){e.$set(e.style,"associativeLineWidth",t)},expression:"style.associativeLineWidth"}},e._l(e.lineWidthList,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[i>0?t("span",{staticClass:"borderLine",class:{isDark:e.isDark},style:{height:i+"px"}}):e._e()])})),1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.associativeLineActiveColor")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover5",arg:"popover5"}],staticClass:"block",style:{backgroundColor:e.style.associativeLineActiveColor}}),t("el-popover",{ref:"popover5",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.style.associativeLineActiveColor},on:{change:t=>{e.update("associativeLineActiveColor",t)}}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.associativeLineActiveWidth")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.update("associativeLineActiveWidth",t)}},model:{value:e.style.associativeLineActiveWidth,callback:function(t){e.$set(e.style,"associativeLineActiveWidth",t)},expression:"style.associativeLineActiveWidth"}},e._l(e.lineWidthList,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[i>0?t("span",{staticClass:"borderLine",class:{isDark:e.isDark},style:{height:i+"px"}}):e._e()])})),1)],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.associativeLineText")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.fontFamily")))]),t("el-select",{attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("associativeLineTextFontFamily",t)}},model:{value:e.style.associativeLineTextFontFamily,callback:function(t){e.$set(e.style,"associativeLineTextFontFamily",t)},expression:"style.associativeLineTextFontFamily"}},e._l(e.fontFamilyList,(function(e){return t("el-option",{key:e.value,style:{fontFamily:e.value},attrs:{label:e.name,value:e.value}})})),1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.color")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover6",arg:"popover6"}],staticClass:"block",style:{backgroundColor:e.style.associativeLineTextColor}}),t("el-popover",{ref:"popover6",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.style.associativeLineTextColor},on:{change:t=>{e.update("associativeLineTextColor",t)}}})],1)],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.fontSize")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:function(t){return e.update("associativeLineTextFontSize",t)}},model:{value:e.style.associativeLineTextFontSize,callback:function(t){e.$set(e.style,"associativeLineTextFontSize",t)},expression:"style.associativeLineTextFontSize"}},e._l(e.fontSizeList,(function(e){return t("el-option",{key:e,style:{fontSize:e+"px"},attrs:{label:e,value:e}})})),1)],1)]),e.showNodeUseLineStyle?[t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.nodeBorderType")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-checkbox",{on:{change:t=>{e.update("nodeUseLineStyle",t)}},model:{value:e.style.nodeUseLineStyle,callback:function(t){e.$set(e.style,"nodeUseLineStyle",t)},expression:"style.nodeUseLineStyle"}},[e._v(e._s(e.$t("baseStyle.nodeUseLineStyle")))])],1)])]:e._e(),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.nodePadding")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.horizontal")))]),t("el-slider",{staticStyle:{width:"200px"},on:{change:t=>{e.update("paddingX",t)}},model:{value:e.style.paddingX,callback:function(t){e.$set(e.style,"paddingX",t)},expression:"style.paddingX"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.vertical")))]),t("el-slider",{staticStyle:{width:"200px"},on:{change:t=>{e.update("paddingY",t)}},model:{value:e.style.paddingY,callback:function(t){e.$set(e.style,"paddingY",t)},expression:"style.paddingY"}})],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.image")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.maximumWidth")))]),t("el-slider",{staticStyle:{width:"140px"},attrs:{min:10,max:300},on:{change:t=>{e.update("imgMaxWidth",t)}},model:{value:e.style.imgMaxWidth,callback:function(t){e.$set(e.style,"imgMaxWidth",t)},expression:"style.imgMaxWidth"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.maximumHeight")))]),t("el-slider",{staticStyle:{width:"140px"},attrs:{min:10,max:300},on:{change:t=>{e.update("imgMaxHeight",t)}},model:{value:e.style.imgMaxHeight,callback:function(t){e.$set(e.style,"imgMaxHeight",t)},expression:"style.imgMaxHeight"}})],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.icon")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.size")))]),t("el-slider",{staticStyle:{width:"200px"},attrs:{min:12,max:50},on:{change:t=>{e.update("iconSize",t)}},model:{value:e.style.iconSize,callback:function(t){e.$set(e.style,"iconSize",t)},expression:"style.iconSize"}})],1)]),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.nodeMargin")))]),t("div",{staticClass:"row column"},[t("el-tabs",{staticClass:"tab",on:{"tab-click":e.initMarginStyle},model:{value:e.marginActiveTab,callback:function(t){e.marginActiveTab=t},expression:"marginActiveTab"}},[t("el-tab-pane",{attrs:{label:e.$t("baseStyle.level2Node"),name:"second"}}),t("el-tab-pane",{attrs:{label:e.$t("baseStyle.belowLevel2Node"),name:"node"}})],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.horizontal")))]),t("el-slider",{staticStyle:{width:"200px"},attrs:{max:200},on:{change:t=>{e.updateMargin("marginX",t)}},model:{value:e.style.marginX,callback:function(t){e.$set(e.style,"marginX",t)},expression:"style.marginX"}})],1),t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.vertical")))]),t("el-slider",{staticStyle:{width:"200px"},attrs:{max:200},on:{change:t=>{e.updateMargin("marginY",t)}},model:{value:e.style.marginY,callback:function(t){e.$set(e.style,"marginY",t)},expression:"style.marginY"}})],1)],1),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.watermark")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-checkbox",{on:{change:e.watermarkShowChange},model:{value:e.watermarkConfig.show,callback:function(t){e.$set(e.watermarkConfig,"show",t)},expression:"watermarkConfig.show"}},[e._v(e._s(e.$t("baseStyle.showWatermark")))])],1)]),e.watermarkConfig.show?[t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-checkbox",{on:{change:e.updateWatermarkConfig},model:{value:e.watermarkConfig.onlyExport,callback:function(t){e.$set(e.watermarkConfig,"onlyExport",t)},expression:"watermarkConfig.onlyExport"}},[e._v(e._s(e.$t("baseStyle.onlyExport")))])],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.watermarkText")))]),t("el-input",{attrs:{size:"small"},on:{change:e.updateWatermarkConfig},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.watermarkConfig.text,callback:function(t){e.$set(e.watermarkConfig,"text",t)},expression:"watermarkConfig.text"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.watermarkTextColor")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover3",arg:"popover3"}],staticClass:"block",style:{backgroundColor:e.watermarkConfig.textStyle.color}}),t("el-popover",{ref:"popover3",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.watermarkConfig.textStyle.color},on:{change:t=>{e.watermarkConfig.textStyle.color=t,e.updateWatermarkConfig()}}})],1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.watermarkTextOpacity")))]),t("el-slider",{staticStyle:{width:"170px"},attrs:{min:0,max:1,step:.1},on:{change:e.updateWatermarkConfig},model:{value:e.watermarkConfig.textStyle.opacity,callback:function(t){e.$set(e.watermarkConfig.textStyle,"opacity",t)},expression:"watermarkConfig.textStyle.opacity"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.watermarkTextFontSize")))]),t("el-input-number",{attrs:{size:"small",min:0,max:50,step:1},on:{change:e.updateWatermarkConfig},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.watermarkConfig.textStyle.fontSize,callback:function(t){e.$set(e.watermarkConfig.textStyle,"fontSize",t)},expression:"watermarkConfig.textStyle.fontSize"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.watermarkAngle")))]),t("el-input-number",{attrs:{size:"small",min:0,max:90,step:10},on:{change:e.updateWatermarkConfig},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.watermarkConfig.angle,callback:function(t){e.$set(e.watermarkConfig,"angle",t)},expression:"watermarkConfig.angle"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.watermarkLineSpacing")))]),t("el-input-number",{attrs:{size:"small",step:10},on:{change:e.updateWatermarkConfig},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.watermarkConfig.lineSpacing,callback:function(t){e.$set(e.watermarkConfig,"lineSpacing",t)},expression:"watermarkConfig.lineSpacing"}})],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.watermarkTextSpacing")))]),t("el-input-number",{attrs:{size:"small",step:10},on:{change:e.updateWatermarkConfig},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.watermarkConfig.textSpacing,callback:function(t){e.$set(e.watermarkConfig,"textSpacing",t)},expression:"watermarkConfig.textSpacing"}})],1)])]:e._e(),t("div",{staticClass:"title noTop"},[e._v(e._s(e.$t("baseStyle.otherConfig")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-checkbox",{on:{change:t=>{e.updateOtherConfig("enableFreeDrag",t)}},model:{value:e.config.enableFreeDrag,callback:function(t){e.$set(e.config,"enableFreeDrag",t)},expression:"config.enableFreeDrag"}},[e._v(e._s(e.$t("baseStyle.enableFreeDrag")))])],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-checkbox",{on:{change:e.enableNodeRichTextChange},model:{value:e.enableNodeRichText,callback:function(t){e.enableNodeRichText=t},expression:"enableNodeRichText"}},[e._v(e._s(e.$t("baseStyle.isEnableNodeRichText")))])],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.mousewheelAction")))]),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.updateOtherConfig("mousewheelAction",t)}},model:{value:e.config.mousewheelAction,callback:function(t){e.$set(e.config,"mousewheelAction",t)},expression:"config.mousewheelAction"}},[t("el-option",{attrs:{label:e.$t("baseStyle.zoomView"),value:"zoom"}}),t("el-option",{attrs:{label:e.$t("baseStyle.moveViewUpDown"),value:"move"}})],1)],1)]),"zoom"===e.config.mousewheelAction?t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.mousewheelZoomActionReverse")))]),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.updateOtherConfig("mousewheelZoomActionReverse",t)}},model:{value:e.config.mousewheelZoomActionReverse,callback:function(t){e.$set(e.config,"mousewheelZoomActionReverse",t)},expression:"config.mousewheelZoomActionReverse"}},[t("el-option",{attrs:{label:e.$t("baseStyle.mousewheelZoomActionReverse1"),value:!1}}),t("el-option",{attrs:{label:e.$t("baseStyle.mousewheelZoomActionReverse2"),value:!0}})],1)],1)]):e._e(),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("baseStyle.createNewNodeBehavior")))]),t("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.updateOtherConfig("createNewNodeBehavior",t)}},model:{value:e.config.createNewNodeBehavior,callback:function(t){e.$set(e.config,"createNewNodeBehavior",t)},expression:"config.createNewNodeBehavior"}},[t("el-option",{attrs:{label:e.$t("baseStyle.default"),value:"default"}}),t("el-option",{attrs:{label:e.$t("baseStyle.notActive"),value:"notActive"}}),t("el-option",{attrs:{label:e.$t("baseStyle.activeOnly"),value:"activeOnly"}})],1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("el-checkbox",{on:{change:function(t){return e.updateLocalConfig("isShowScrollbar",t)}},model:{value:e.localConfigs.isShowScrollbar,callback:function(t){e.$set(e.localConfigs,"isShowScrollbar",t)},expression:"localConfigs.isShowScrollbar"}},[e._v(e._s(e.$t("baseStyle.isShowScrollbar")))])],1)])],2):e._e()])},li=[],ri=i("358c"),ci={name:"BaseStyle",components:{Sidebar:jt,Color:ti,ImgUpload:c["a"]},props:{data:{type:[Object,null],default:null},mindMap:{type:Object}},data(){return{rainbowLinesOptions:ri["c"],lineWidthList:K["o"],fontSizeList:K["j"],activeTab:"color",marginActiveTab:"second",style:{backgroundColor:"",lineColor:"",lineWidth:"",lineStyle:"",showLineMarker:"",rootLineKeepSameInCurve:"",rootLineStartPositionKeepSameInCurve:"",lineRadius:0,generalizationLineWidth:"",generalizationLineColor:"",associativeLineColor:"",associativeLineWidth:0,associativeLineActiveWidth:0,associativeLineActiveColor:"",associativeLineTextFontSize:0,associativeLineTextColor:"",associativeLineTextFontFamily:"",paddingX:0,paddingY:0,imgMaxWidth:0,imgMaxHeight:0,iconSize:0,backgroundImage:"",backgroundRepeat:"no-repeat",backgroundPosition:"",backgroundSize:"",marginX:0,marginY:0,nodeUseLineStyle:!1},config:{enableFreeDrag:!1,mousewheelAction:"zoom",mousewheelZoomActionReverse:!1,createNewNodeBehavior:"default"},watermarkConfig:{show:!1,onlyExport:!1,text:"",lineSpacing:100,textSpacing:100,angle:30,textStyle:{color:"",opacity:0,fontSize:1}},rainbowLinesPopoverVisible:!1,curRainbowLineColorList:null,updateWatermarkTimer:null,enableNodeRichText:!0,localConfigs:{isShowScrollbar:!1,isUseHandDrawnLikeStyle:!1},currentLayout:""}},computed:{...Object(U["d"])({activeSidebar:e=>e.activeSidebar,localConfig:e=>e.localConfig,isDark:e=>e.localConfig.isDark}),lineStyleList(){return K["m"][this.$i18n.locale]||K["m"].zh},rootLineKeepSameInCurveList(){return K["p"][this.$i18n.locale]||K["p"].zh},backgroundRepeatList(){return K["b"][this.$i18n.locale]||K["b"].zh},backgroundPositionList(){return K["a"][this.$i18n.locale]||K["a"].zh},backgroundSizeList(){return K["c"][this.$i18n.locale]||K["c"].zh},fontFamilyList(){return K["i"][this.$i18n.locale]||K["i"].zh},lineStyleMap(){return K["n"][this.$i18n.locale]||K["n"].zh},showNodeUseLineStyle(){return ri["f"].includes(this.currentLayout)},showLineRadius(){return"straight"===this.style.lineStyle&&ri["d"].includes(this.currentLayout)},lineStyleListShow(){const e=[];return this.lineStyleList.forEach(t=>{const i=ri["e"][t.value];i?i.includes(this.currentLayout)&&e.push(t):e.push(t)}),e},showRootLineKeepSameInCurveLayouts(){return ri["g"].includes(this.currentLayout)}},watch:{activeSidebar(e){"baseStyle"===e?(this.$refs.sidebar.show=!0,this.initStyle(),this.initConfig(),this.initWatermark(),this.initRainbowLines(),this.currentLayout=this.mindMap.getLayout()):this.$refs.sidebar.show=!1},lineStyleListShow:{deep:!0,handler(){const e=this.lineStyleListShow.find(e=>e.value===this.style.lineStyle);e||(this.style.lineStyle=this.lineStyleListShow[0].value)}}},created(){this.initLoacalConfig(),this.$bus.$on("setData",this.onSetData)},beforeDestroy(){this.$bus.$off("setData",this.onSetData)},methods:{...Object(U["c"])(["setLocalConfig"]),onSetData(){"baseStyle"===this.activeSidebar&&setTimeout(()=>{this.initStyle()},0)},initStyle(){["backgroundColor","lineWidth","lineStyle","showLineMarker","rootLineKeepSameInCurve","rootLineStartPositionKeepSameInCurve","lineRadius","lineColor","generalizationLineWidth","generalizationLineColor","associativeLineColor","associativeLineWidth","associativeLineActiveWidth","associativeLineActiveColor","associativeLineTextFontSize","associativeLineTextColor","associativeLineTextFontFamily","paddingX","paddingY","imgMaxWidth","imgMaxHeight","iconSize","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","nodeUseLineStyle"].forEach(e=>{this.style[e]=this.mindMap.getThemeConfig(e),"backgroundImage"===e&&"none"===this.style[e]&&(this.style[e]="")}),this.initMarginStyle()},initConfig(){["enableFreeDrag","mousewheelAction","mousewheelZoomActionReverse","createNewNodeBehavior"].forEach(e=>{this.config[e]=this.mindMap.getConfig(e)})},initLoacalConfig(){this.enableNodeRichText=this.localConfig.openNodeRichText,this.mousewheelAction=this.localConfig.mousewheelAction,this.mousewheelZoomActionReverse=this.localConfig.mousewheelZoomActionReverse,["isShowScrollbar","isUseHandDrawnLikeStyle"].forEach(e=>{this.localConfigs[e]=this.localConfig[e]})},initWatermark(){let e=this.mindMap.getConfig("watermarkConfig");["text","lineSpacing","textSpacing","angle","onlyExport"].forEach(t=>{this.watermarkConfig[t]=e[t]}),this.watermarkConfig.show=!!e.text,this.watermarkConfig.textStyle={...e.textStyle}},initRainbowLines(){const e=this.mindMap.getConfig("rainbowLinesConfig")||{};this.curRainbowLineColorList=e.open&&this.mindMap.rainbowLines?this.mindMap.rainbowLines.getColorsList():null},initMarginStyle(){["marginX","marginY"].forEach(e=>{this.style[e]=this.mindMap.getThemeConfig()[this.marginActiveTab][e]})},update(e,t){this.style[e]="backgroundImage"===e&&"none"===t?"":t,this.data.theme.config[e]=t,this.$bus.$emit("showLoading"),this.mindMap.setThemeConfig(this.data.theme.config),Object(de["e"])({theme:{template:this.mindMap.getTheme(),config:this.data.theme.config}})},updateOtherConfig(e,t){this.mindMap.updateConfig({[e]:t}),this.data.config=this.data.config||{},this.data.config[e]=t,Object(de["e"])({config:this.data.config})},updateWatermarkConfig(){clearTimeout(this.updateWatermarkTimer),this.updateWatermarkTimer=setTimeout(()=>{let{show:e,...t}=this.watermarkConfig;this.mindMap.watermark.updateWatermark({...t}),this.data.config=this.data.config||{},this.data.config.watermarkConfig=this.mindMap.getConfig("watermarkConfig"),Object(de["e"])({config:this.data.config})},300)},updateRainbowLinesConfig(e){this.rainbowLinesPopoverVisible=!1,this.curRainbowLineColorList=e.list||null,this.data.config=this.data.config||{};let t=null;t=e.list?{open:!0,colorsList:e.list}:{open:!1},this.data.config.rainbowLinesConfig=t,this.mindMap.rainbowLines.updateRainLinesConfig(t),Object(de["e"])({config:this.data.config})},updateMargin(e,t){this.style[e]=t,this.data.theme.config[this.marginActiveTab]||(this.data.theme.config[this.marginActiveTab]={}),this.data.theme.config[this.marginActiveTab][e]=t,this.mindMap.setThemeConfig(this.data.theme.config),Object(de["e"])({theme:{template:this.mindMap.getTheme(),config:this.data.theme.config}})},watermarkShowChange(e){if(e){let e=this.watermarkConfig.text||this.$t("baseStyle.watermarkDefaultText");this.watermarkConfig.text=e}else this.watermarkConfig.text="";this.updateWatermarkConfig()},enableNodeRichTextChange(e){this.mindMap.renderer.textEdit.hideEditTextBox(),this.setLocalConfig({openNodeRichText:e})},updateLocalConfig(e,t){this.setLocalConfig({[e]:t})}}},di=ci,hi=(i("29e4"),i("9454"),Object(m["a"])(di,oi,li,!1,null,"1a7ed1ae",null)),ui=hi.exports,mi=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("theme.title")}},[t("div",{staticClass:"themeList",class:{isDark:e.isDark}},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.groupList,(function(e){return t("el-tab-pane",{key:e.name,attrs:{label:e.name,name:e.name}})})),1),e._l(e.currentList,(function(i){return t("div",{key:i.value,staticClass:"themeItem",class:{active:i.value===e.theme},on:{click:function(t){return e.useTheme(i)}}},[t("div",{staticClass:"imgBox"},[t("img",{attrs:{src:e.themeMap[i.value],alt:""}})]),t("div",{staticClass:"name"},[e._v(e._s(i.name))])])}))],2)])},pi=[],gi=i("4013"),fi=i("e7f4"),bi={name:"Theme",components:{Sidebar:jt},props:{mindMap:{type:Object}},data(){return{themeList:[...gi["i"],...fi["a"]].reverse(),themeMap:ri["h"],theme:"",activeName:"",groupList:[]}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,activeSidebar:e=>e.activeSidebar}),currentList(){return this.groupList.find(e=>e.name===this.activeName).list}},watch:{activeSidebar(e){"theme"===e?(this.theme=this.mindMap.getTheme(),this.$refs.sidebar.show=!0):this.$refs.sidebar.show=!1}},created(){this.initGroup(),this.theme=this.mindMap.getTheme(),this.mindMap.on("view_theme_change",this.handleViewThemeChange)},beforeDestroy(){this.mindMap.off("view_theme_change",this.handleViewThemeChange)},methods:{...Object(U["c"])(["setLocalConfig"]),handleViewThemeChange(){this.theme=this.mindMap.getTheme(),this.handleDark()},initGroup(){let e=["default","skyGreen","classic2","classic3","classicGreen","classicBlue","blueSky","brainImpairedPink","earthYellow","freshGreen","freshRed","romanticPurple","pinkGrape","mint"],t=[],i=[];this.themeList.forEach(s=>{e.includes(s.value)?t.push(s):s.dark||i.push(s)}),this.groupList=[{name:this.$t("theme.classics"),list:i},{name:this.$t("theme.dark"),list:this.themeList.filter(e=>e.dark)},{name:this.$t("theme.simple"),list:t}],this.activeName=this.groupList[0].name},useTheme(e){if(e.value===this.theme)return;this.theme=e.value,this.handleDark();const t=this.mindMap.getCustomThemeConfig(),i=Object.keys(t).length>0;i?this.$confirm(this.$t("theme.coverTip"),this.$t("theme.tip"),{confirmButtonText:this.$t("theme.cover"),cancelButtonText:this.$t("theme.reserve"),type:"warning",distinguishCancelAndClose:!0,callback:i=>{"confirm"===i?(this.mindMap.setThemeConfig({},!0),this.changeTheme(e,{})):"cancel"===i&&this.changeTheme(e,t)}}):this.changeTheme(e,t)},changeTheme(e,t){this.$bus.$emit("showLoading"),this.mindMap.setTheme(e.value),Object(de["e"])({theme:{template:e.value,config:t}})},handleDark(){let e=this.themeList.find(e=>e.value===this.theme);this.setLocalConfig({isDark:e.dark})}}},vi=bi,yi=(i("200a7"),Object(m["a"])(vi,mi,pi,!1,null,"32dd4985",null)),Ci=yi.exports,wi=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("strusture.title")}},[t("div",{staticClass:"layoutList",class:{isDark:e.isDark}},e._l(e.layoutList,(function(i){return t("div",{key:i.value,staticClass:"layoutItem",class:{active:i.value===e.layout},on:{click:function(t){return e.useLayout(i)}}},[t("div",{staticClass:"imgBox"},[t("img",{attrs:{src:e.layoutImgMap[i.value],alt:""}})]),t("div",{staticClass:"name"},[e._v(e._s(i.name))])])})),0)])},_i=[],xi={name:"Structure",components:{Sidebar:jt},props:{mindMap:{type:Object}},data(){return{layoutList:gi["e"],layoutImgMap:ri["b"],layout:""}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,activeSidebar:e=>e.activeSidebar})},watch:{activeSidebar(e){"structure"===e?(this.layout=this.mindMap.getLayout(),this.$refs.sidebar.show=!0):this.$refs.sidebar.show=!1}},methods:{useLayout(e){this.layout=e.value,this.mindMap.setLayout(e.value),Object(de["e"])({layout:e.value})}}},ki=xi,Si=(i("46ce"),Object(m["a"])(ki,wi,_i,!1,null,"e1168162",null)),$i=Si.exports,Di=function(){var e=this,t=e._self._c;return t("div",{staticClass:"countContainer",class:{isDark:e.isDark}},[t("div",{staticClass:"item"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("count.words")))]),t("span",{staticClass:"value"},[e._v(e._s(e.words))])]),t("div",{staticClass:"item"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("count.nodes")))]),t("span",{staticClass:"value"},[e._v(e._s(e.num))])])])},Ti=[];function Ni(e){let t=e;const i=e.match(/<(\S*?)[^>]*>.*?|<.*? \/>/g);if(null==i)return e;for(let s of i){const e=new RegExp(/(style|target|href)=["'][^"']*["']/g),i=new RegExp(/href=["']javascript:/g),a=s.replace(/([a-zA-Z-]+)\s*=\s*["']([^"']*)["']/g,t=>i.test(t)||!e.test(t)?"":t);t=t.replace(s,a)}return t}let Li=document.createElement("div");var Mi={name:"Count",props:{mindMap:{type:Object}},data(){return{textStr:"",words:0,num:0}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark})},created(){this.$bus.$on("data_change",this.onDataChange),this.mindMap&&this.onDataChange(this.mindMap.getData())},beforeDestroy(){this.$bus.$off("data_change",this.onDataChange)},methods:{onDataChange(e){this.textStr="",this.words=0,this.num=0,this.walk(e),Li.innerHTML=Ni(this.textStr),this.words=Li.textContent.length},walk(e){e&&(this.num++,this.textStr+=String(e.data.text)||"",e.children&&e.children.length>0&&e.children.forEach(e=>{this.walk(e)}))}}},Ii=Mi,Oi=(i("8936"),Object(m["a"])(Ii,Di,Ti,!1,null,"174c2f5b",null)),Ei=Oi.exports,Pi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"navigatorContainer",class:{isDark:e.isDark}},[t("div",{staticClass:"item"},[t("el-select",{staticStyle:{width:"100px"},attrs:{size:"small"},on:{change:e.onLangChange},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}},e._l(e.langList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),t("div",{staticClass:"item"},[t("el-tooltip",{attrs:{effect:"dark",content:e.$t("navigatorToolbar.backToRoot"),placement:"top"}},[t("div",{staticClass:"btn iconfont icondingwei",on:{click:e.backToRoot}})])],1),t("div",{staticClass:"item"},[t("div",{staticClass:"btn iconfont iconsousuo",on:{click:e.showSearch}})]),t("div",{staticClass:"item"},[t("MouseAction",{attrs:{isDark:e.isDark,mindMap:e.mindMap}})],1),t("div",{staticClass:"item"},[t("el-tooltip",{attrs:{effect:"dark",content:e.openMiniMap?e.$t("navigatorToolbar.closeMiniMap"):e.$t("navigatorToolbar.openMiniMap"),placement:"top"}},[t("div",{staticClass:"btn iconfont icondaohang1",on:{click:e.toggleMiniMap}})])],1),t("div",{staticClass:"item"},[t("el-tooltip",{attrs:{effect:"dark",content:e.isReadonly?e.$t("navigatorToolbar.edit"):e.$t("navigatorToolbar.readonly"),placement:"top"}},[t("div",{staticClass:"btn iconfont",class:[e.isReadonly?"iconyanjing":"iconbianji1"],on:{click:e.readonlyChange}})])],1),t("div",{staticClass:"item"},[t("Fullscreen",{attrs:{isDark:e.isDark,mindMap:e.mindMap}})],1),t("div",{staticClass:"item"},[t("Scale",{attrs:{isDark:e.isDark,mindMap:e.mindMap}})],1),t("div",{staticClass:"item"},[t("div",{staticClass:"btn iconfont",class:[e.isDark?"iconmoon_line":"iconlieri"],on:{click:e.toggleDark}})]),t("div",{staticClass:"item"},[t("el-tooltip",{attrs:{effect:"dark",content:e.$t("navigatorToolbar.changeSourceCodeEdit"),placement:"top"}},[t("div",{staticClass:"btn iconfont iconyuanma",on:{click:e.openSourceCodeEdit}})])],1),t("div",{staticClass:"item"},[t("Demonstrate",{attrs:{isDark:e.isDark,mindMap:e.mindMap}})],1),t("div",{staticClass:"item"},[t("el-dropdown",{on:{command:e.handleCommand}},[t("div",{staticClass:"btn iconfont iconbangzhu"}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"helpDoc"}},[e._v("使用文档")])],1)],1)],1)])},Fi=[],ji=function(){var e=this,t=e._self._c;return t("div",{staticClass:"scaleContainer",class:{isDark:e.isDark}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("scale.zoomOut"),placement:"top"}},[t("div",{staticClass:"btn el-icon-minus",on:{click:e.narrow}})]),t("div",{staticClass:"scaleInfo"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.scaleNum,expression:"scaleNum"}],attrs:{type:"text"},domProps:{value:e.scaleNum},on:{change:e.onScaleNumChange,focus:e.onScaleNumInputFocus,input:function(t){t.target.composing||(e.scaleNum=t.target.value)}}}),e._v("% ")]),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("scale.zoomIn"),placement:"top"}},[t("div",{staticClass:"btn el-icon-plus",on:{click:e.enlarge}})])],1)},Ri=[],zi={name:"Scale",props:{mindMap:{type:Object},isDark:{type:Boolean}},data(){return{scaleNum:100,cacheScaleNum:0}},watch:{mindMap(e,t){e&&!t&&(this.mindMap.on("scale",e=>{this.scaleNum=this.toPer(e)}),this.scaleNum=this.toPer(this.mindMap.view.scale))}},methods:{toPer(e){return(100*e).toFixed(0)},narrow(){this.mindMap.view.narrow()},enlarge(){this.mindMap.view.enlarge()},onScaleNumInputFocus(){this.cacheScaleNum=this.scaleNum},onScaleNumChange(){const e=Number(this.scaleNum);if(Number.isNaN(e)||e<=0)this.scaleNum=this.cacheScaleNum;else{const e=this.mindMap.width/2,t=this.mindMap.height/2;this.mindMap.view.setScale(this.scaleNum/100,e,t)}}}},Ai=zi,Bi=(i("9155"),Object(m["a"])(Ai,ji,Ri,!1,null,"12b9f8e2",null)),Vi=Bi.exports,Hi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"fullscreenContainer",class:{isDark:e.isDark}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("fullscreen.fullscreenShow"),placement:"top"}},[t("div",{staticClass:"btn iconfont iconquanping",on:{click:e.toFullscreenShow}})]),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("fullscreen.fullscreenEdit"),placement:"top"}},[t("div",{staticClass:"btn iconfont iconquanping1",on:{click:e.toFullscreenEdit}})])],1)},Wi=[],Ui={name:"Fullscreen",props:{mindMap:{type:Object},isDark:{type:Boolean}},data(){return{}},created(){document[te["d"]]=()=>{setTimeout(()=>{this.mindMap.resize()},1e3)}},methods:{toFullscreenShow(){Object(te["c"])(this.mindMap.el)},toFullscreenEdit(){Object(te["c"])(document.body)}}},Ki=Ui,Yi=(i("5f62"),Object(m["a"])(Ki,Hi,Wi,!1,null,"6358daa4",null)),Xi=Yi.exports,Gi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mouseActionContainer",class:{isDark:e.isDark}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.useLeftKeySelectionRightKeyDrag?e.$t("mouseAction.tip2"):e.$t("mouseAction.tip1"),placement:"top"}},[t("div",{staticClass:"btn iconfont",class:[e.useLeftKeySelectionRightKeyDrag?"iconmouseR":"iconmouseL"],on:{click:e.toggleAction}})])],1)},Zi=[],qi={name:"MouseAction",props:{mindMap:{type:Object},isDark:{type:Boolean}},data(){return{}},computed:{...Object(U["d"])({useLeftKeySelectionRightKeyDrag:e=>e.localConfig.useLeftKeySelectionRightKeyDrag})},methods:{...Object(U["c"])(["setLocalConfig"]),toggleAction(){let e=!this.useLeftKeySelectionRightKeyDrag;this.mindMap.updateConfig({useLeftKeySelectionRightKeyDrag:e}),this.setLocalConfig({useLeftKeySelectionRightKeyDrag:e})}}},Ji=qi,Qi=(i("98fe"),Object(m["a"])(Ji,Gi,Zi,!1,null,"961cc50e",null)),es=Qi.exports,ts=i("9225"),is=i("a06c"),ss=function(){var e=this,t=e._self._c;return t("div",{staticClass:"demonstrateContainer",class:{isDark:e.isDark}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("demonstrate.demonstrate"),placement:"top"}},[t("div",{staticClass:"btn iconfont iconyanshibofang",on:{click:e.enterDemoMode}})]),e.isEnterDemonstrate?t("div",{ref:"exitDemonstrateBtnRef",staticClass:"exitDemonstrateBtn",on:{click:e.exit}},[t("span",{staticClass:"icon iconfont iconguanbi"})]):e._e(),e.isEnterDemonstrate?t("div",{ref:"stepBoxRef",staticClass:"stepBox"},[t("div",{staticClass:"jump",class:{disabled:e.curStepIndex<=0},on:{click:e.prev}},[t("span",{staticClass:"icon el-icon-back"})]),t("div",{staticClass:"step"},[e._v(e._s(e.curStepIndex+1)+" / "+e._s(e.totalStep))]),t("div",{staticClass:"jump",class:{disabled:e.curStepIndex>=e.totalStep-1},on:{click:e.next}},[t("span",{staticClass:"icon el-icon-right"})]),t("div",{staticClass:"input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.inputStep,expression:"inputStep"}],attrs:{type:"text"},domProps:{value:e.inputStep},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.onEnter.apply(null,arguments))},keydown:function(e){e.stopPropagation()},input:function(t){t.target.composing||(e.inputStep=t.target.value)}}})])]):e._e()],1)},as=[],ns={props:{mindMap:{type:Object},isDark:{type:Boolean}},data(){return{isEnterDemonstrate:!1,curStepIndex:0,totalStep:0,inputStep:""}},created(){this.$bus.$on("demonstrate_jump",this.onJump),this.$bus.$on("exit_demonstrate",this.onExit)},methods:{enterDemoMode(){this.isEnterDemonstrate=!0,this.$nextTick(()=>{const e=document.querySelector("#mindMapContainer");e.appendChild(this.$refs.exitDemonstrateBtnRef),e.appendChild(this.$refs.stepBoxRef)}),this.mindMap.demonstrate.enter()},exit(){this.mindMap.demonstrate.exit()},onExit(){this.isEnterDemonstrate=!1,this.curStepIndex=0,this.totalStep=0},onJump(e,t){this.curStepIndex=e,this.totalStep=t},prev(){this.mindMap.demonstrate.prev()},next(){this.mindMap.demonstrate.next()},onEnter(){const e=Number(this.inputStep);Number.isNaN(e)?this.inputStep="":e>=1&&e<=this.totalStep&&this.mindMap.demonstrate.jump(e-1)}}},os=ns,ls=(i("64f0"),Object(m["a"])(os,ss,as,!1,null,"414c5cc8",null)),rs=ls.exports,cs={name:"NavigatorToolbar",components:{Scale:Vi,Fullscreen:Xi,MouseAction:es,Demonstrate:rs},props:{mindMap:{type:Object}},data(){return{version:is.version,langList:K["k"],lang:"",openMiniMap:!1}},computed:{...Object(U["d"])({isReadonly:e=>e.isReadonly,isDark:e=>e.localConfig.isDark})},created(){this.lang=Object(de["c"])()},methods:{...Object(U["c"])(["setLocalConfig","setIsReadonly","setIsSourceCodeEdit"]),readonlyChange(){this.setIsReadonly(!this.isReadonly),this.mindMap.setMode(this.isReadonly?"readonly":"edit")},toggleMiniMap(){this.openMiniMap=!this.openMiniMap,this.$bus.$emit("toggle_mini_map",this.openMiniMap)},onLangChange(e){ts["a"].locale=e,Object(de["g"])(e),this.$bus.$emit("lang_change")},showSearch(){this.$bus.$emit("show_search")},toggleDark(){this.setLocalConfig({isDark:!this.isDark})},handleCommand(e){let t="";switch(e){case"github":t="https://github.com/wanglin2/mind-map";break;case"helpDoc":t="https://docs.qq.com/doc/DYkNiekxtV3BwaW9m?u=2755f280259642feae5f6c877b6c5187/";break;case"devDoc":t="https://wanglin2.github.io/mind-map/#/doc/zh/introduction/";break;case"site":t="https://wanglin2.github.io/mind-map/#/index";break;case"issue":t="https://github.com/wanglin2/mind-map/issues/new";break;default:break}const i=document.createElement("a");i.href=t,i.target="_blank",i.click()},backToRoot(){this.mindMap.renderer.setRootNodeCenter()},openSourceCodeEdit(){this.setIsSourceCodeEdit(!0)}}},ds=cs,hs=(i("4ec7"),Object(m["a"])(ds,Pi,Fi,!1,null,"147deefe",null)),us=hs.exports,ms=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("shortcutKey.title")}},[t("div",{staticClass:"box",class:{isDark:e.isDark}},e._l(e.shortcutKeyList,(function(i){return t("div",{key:i.type},[t("div",{staticClass:"title"},[e._v(e._s(i.type))]),e._l(i.list,(function(i){return t("div",{key:i.value,staticClass:"list"},[t("div",{staticClass:"item"},[i.icon?t("span",{staticClass:"icon iconfont",class:[i.icon]}):e._e(),t("span",{staticClass:"name",attrs:{title:i.name}},[e._v(e._s(i.name))]),t("div",{staticClass:"value",attrs:{title:i.value}},[e._v(e._s(i.value))])])])}))],2)})),0)])},ps=[],gs={name:"ShortcutKey",components:{Sidebar:jt},data(){return{}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,activeSidebar:e=>e.activeSidebar}),shortcutKeyList(){return K["s"][this.$i18n.locale]||K["s"].zh}},watch:{activeSidebar(e){this.$refs.sidebar.show="shortcutKey"===e}}},fs=gs,bs=(i("91d9"),Object(m["a"])(fs,ms,ps,!1,null,"32fc4b52",null)),vs=bs.exports,ys=function(){var e=this,t=e._self._c;return e.isShow?t("div",{ref:"contextmenuRef",staticClass:"contextmenuContainer listBox",class:{isDark:e.isDark},style:{left:e.left+"px",top:e.top+"px"}},["node"===e.type?[t("div",{staticClass:"item",class:{disabled:e.insertNodeBtnDisabled},on:{click:function(t){return e.exec("INSERT_NODE",e.insertNodeBtnDisabled)}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.insertSiblingNode")))]),t("span",{staticClass:"desc"},[e._v("Enter")])]),t("div",{staticClass:"item",class:{disabled:e.isGeneralization},on:{click:function(t){return e.exec("INSERT_CHILD_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.insertChildNode")))]),t("span",{staticClass:"desc"},[e._v("Tab")])]),t("div",{staticClass:"item",class:{disabled:e.insertNodeBtnDisabled},on:{click:function(t){return e.exec("INSERT_PARENT_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.insertParentNode")))]),t("span",{staticClass:"desc"},[e._v("Shift + Tab")])]),t("div",{staticClass:"item",class:{disabled:e.insertNodeBtnDisabled},on:{click:function(t){return e.exec("ADD_GENERALIZATION")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.insertSummary")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + G")])]),t("div",{staticClass:"item",class:{disabled:e.upNodeBtnDisabled},on:{click:function(t){return e.exec("UP_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.moveUpNode")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + ↑")])]),t("div",{staticClass:"item",class:{disabled:e.downNodeBtnDisabled},on:{click:function(t){return e.exec("DOWN_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.moveDownNode")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + ↓")])]),t("div",{staticClass:"item danger",on:{click:function(t){return e.exec("REMOVE_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.deleteNode")))]),t("span",{staticClass:"desc"},[e._v("Delete")])]),t("div",{staticClass:"item danger",on:{click:function(t){return e.exec("REMOVE_CURRENT_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.deleteCurrentNode")))]),t("span",{staticClass:"desc"},[e._v("Shift + Backspace")])]),t("div",{staticClass:"item",class:{disabled:e.isGeneralization},on:{click:function(t){return e.exec("COPY_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.copyNode")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + C")])]),t("div",{staticClass:"item",class:{disabled:e.isGeneralization},on:{click:function(t){return e.exec("CUT_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.cutNode")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + X")])]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("PASTE_NODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.pasteNode")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + V")])]),e.hasHyperlink?t("div",{staticClass:"item",on:{click:function(t){return e.exec("REMOVE_HYPERLINK")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.removeHyperlink")))])]):e._e(),e.hasNote?t("div",{staticClass:"item",on:{click:function(t){return e.exec("REMOVE_NOTE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.removeNote")))])]):e._e(),t("div",{staticClass:"item",on:{click:function(t){return e.exec("REMOVE_CUSTOM_STYLES")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.removeCustomStyles")))])]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("EXPORT_CUR_NODE_TO_PNG")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.exportNodeToPng")))])])]:e._e(),"svg"===e.type?[t("div",{staticClass:"item",on:{click:function(t){return e.exec("RETURN_CENTER")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.backCenter")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + Enter")])]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("EXPAND_ALL")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.expandAll")))])]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("UNEXPAND_ALL")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.unExpandAll")))])]),t("div",{staticClass:"item"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.expandTo")))]),t("div",{staticClass:"subItems listBox",class:{isDark:e.isDark}},e._l(e.expandList,(function(i,s){return t("div",{key:i,staticClass:"item",on:{click:function(t){return e.exec("UNEXPAND_TO_LEVEL",!1,s+1)}}},[e._v(" "+e._s(i)+" ")])})),0)]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("RESET_LAYOUT")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.arrangeLayout")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + L")])]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("FIT_CANVAS")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.fitCanvas")))]),t("span",{staticClass:"desc"},[e._v("Ctrl + i")])]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("TOGGLE_ZEN_MODE")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.zenMode")))]),e._v(" "+e._s(e.isZenMode?"√":"")+" ")]),t("div",{staticClass:"item",on:{click:function(t){return e.exec("REMOVE_ALL_NODE_CUSTOM_STYLES")}}},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("contextmenu.removeAllNodeCustomStyles")))])])]:e._e()],2):e._e()},Cs=[],ws={name:"Contextmenu",props:{mindMap:{type:Object}},data(){return{isShow:!1,left:0,top:0,node:null,type:"",isMousedown:!1,mosuedownX:0,mosuedownY:0}},computed:{...Object(U["d"])({isZenMode:e=>e.localConfig.isZenMode,isDark:e=>e.localConfig.isDark}),expandList(){return[this.$t("contextmenu.level1"),this.$t("contextmenu.level2"),this.$t("contextmenu.level3"),this.$t("contextmenu.level4"),this.$t("contextmenu.level5"),this.$t("contextmenu.level6")]},insertNodeBtnDisabled(){return!this.node||this.node.isRoot||this.node.isGeneralization},upNodeBtnDisabled(){if(!this.node||this.node.isRoot||this.node.isGeneralization)return!0;let e=0===this.node.parent.children.findIndex(e=>e===this.node);return e},downNodeBtnDisabled(){if(!this.node||this.node.isRoot||this.node.isGeneralization)return!0;let e=this.node.parent.children,t=e.findIndex(e=>e===this.node)===e.length-1;return t},isGeneralization(){return this.node.isGeneralization},hasHyperlink(){return!!this.node.getData("hyperlink")},hasNote(){return!!this.node.getData("note")}},created(){this.$bus.$on("node_contextmenu",this.show),this.$bus.$on("node_click",this.hide),this.$bus.$on("draw_click",this.hide),this.$bus.$on("expand_btn_click",this.hide),this.$bus.$on("svg_mousedown",this.onMousedown),this.$bus.$on("mouseup",this.onMouseup),this.$bus.$on("translate",this.hide)},beforeDestroy(){this.$bus.$off("node_contextmenu",this.show),this.$bus.$off("node_click",this.hide),this.$bus.$off("draw_click",this.hide),this.$bus.$off("expand_btn_click",this.hide),this.$bus.$off("svg_mousedown",this.onMousedown),this.$bus.$off("mouseup",this.onMouseup),this.$bus.$off("translate",this.hide)},methods:{...Object(U["c"])(["setLocalConfig"]),getShowPosition(e,t){const i=this.$refs.contextmenuRef.getBoundingClientRect();return e+i.width>window.innerWidth&&(e=e-i.width-20),t+i.height>window.innerHeight&&(t=window.innerHeight-i.height-10),{x:e,y:t}},show(e,t){this.type="node",this.isShow=!0,this.node=t,this.$nextTick(()=>{const{x:t,y:i}=this.getShowPosition(e.clientX+10,e.clientY+10);this.left=t,this.top=i})},onMousedown(e){3===e.which&&(this.mosuedownX=e.clientX,this.mosuedownY=e.clientY,this.isMousedown=!0)},onMouseup(e){this.isMousedown&&(this.isMousedown=!1,Math.abs(this.mosuedownX-e.clientX)>3||Math.abs(this.mosuedownY-e.clientY)>3?this.hide():this.show2(e))},show2(e){this.type="svg",this.isShow=!0,this.$nextTick(()=>{const{x:t,y:i}=this.getShowPosition(e.clientX+10,e.clientY+10);this.left=t,this.top=i})},hide(){this.isShow=!1,this.left=-9999,this.top=-9999,this.type=""},exec(e,t,...i){if(!t){switch(e){case"COPY_NODE":this.mindMap.renderer.copy();break;case"CUT_NODE":this.mindMap.renderer.cut();break;case"PASTE_NODE":this.mindMap.renderer.paste();break;case"RETURN_CENTER":this.mindMap.renderer.setRootNodeCenter();break;case"TOGGLE_ZEN_MODE":this.setLocalConfig({isZenMode:!this.isZenMode});break;case"FIT_CANVAS":this.mindMap.view.fit();break;case"REMOVE_HYPERLINK":this.node.setHyperlink("","");break;case"REMOVE_NOTE":this.node.setNote("");break;case"EXPORT_CUR_NODE_TO_PNG":this.mindMap.export("png",!0,Object(d["L"])(this.node.getData("text")),!1,this.node);break;default:this.$bus.$emit("execCommand",e,...i);break}this.hide()}}}},_s=ws,xs=(i("f0d0"),Object(m["a"])(_s,ys,Cs,!1,null,"f2aef3d4",null)),ks=xs.exports,Ss=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showRichTextToolbar,expression:"showRichTextToolbar"}],ref:"richTextToolbar",staticClass:"richTextToolbar",class:{isDark:e.isDark},style:e.style,on:{"&click":function(e){e.stopPropagation()}}},[t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.bold"),placement:"top"}},[t("div",{staticClass:"btn",class:{active:e.formatInfo.bold},on:{click:e.toggleBold}},[t("span",{staticClass:"icon iconfont iconzitijiacu"})])]),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.italic"),placement:"top"}},[t("div",{staticClass:"btn",class:{active:e.formatInfo.italic},on:{click:e.toggleItalic}},[t("span",{staticClass:"icon iconfont iconzitixieti"})])]),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.underline"),placement:"top"}},[t("div",{staticClass:"btn",class:{active:e.formatInfo.underline},on:{click:e.toggleUnderline}},[t("span",{staticClass:"icon iconfont iconzitixiahuaxian"})])]),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.strike"),placement:"top"}},[t("div",{staticClass:"btn",class:{active:e.formatInfo.strike},on:{click:e.toggleStrike}},[t("span",{staticClass:"icon iconfont iconshanchuxian"})])]),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.fontFamily"),placement:"top"}},[t("el-popover",{attrs:{placement:"bottom",trigger:"hover"}},[t("div",{staticClass:"fontOptionsList",class:{isDark:e.isDark}},e._l(e.fontFamilyList,(function(i){return t("div",{key:i.value,staticClass:"fontOptionItem",class:{active:e.formatInfo.font===i.value},style:{fontFamily:i.value},on:{click:function(t){return e.changeFontFamily(i.value)}}},[e._v(" "+e._s(i.name)+" ")])})),0),t("div",{staticClass:"btn",attrs:{slot:"reference"},slot:"reference"},[t("span",{staticClass:"icon iconfont iconxingzhuang-wenzi"})])])],1),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.fontSize"),placement:"top"}},[t("el-popover",{attrs:{placement:"bottom",trigger:"hover"}},[t("div",{staticClass:"fontOptionsList",class:{isDark:e.isDark}},e._l(e.fontSizeList,(function(i){return t("div",{key:i,staticClass:"fontOptionItem",class:{active:e.formatInfo.size===i+"px"},style:{fontSize:i+"px"},on:{click:function(t){return e.changeFontSize(i)}}},[e._v(" "+e._s(i)+"px ")])})),0),t("div",{staticClass:"btn",attrs:{slot:"reference"},slot:"reference"},[t("span",{staticClass:"icon iconfont iconcase fontColor"})])])],1),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.color"),placement:"top"}},[t("el-popover",{attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.fontColor},on:{change:e.changeFontColor}}),t("div",{staticClass:"btn",style:{color:e.formatInfo.color},attrs:{slot:"reference"},slot:"reference"},[t("span",{staticClass:"icon iconfont iconzitiyanse"})])],1)],1),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.backgroundColor"),placement:"top"}},[t("el-popover",{attrs:{placement:"bottom",trigger:"hover"}},[t("Color",{attrs:{color:e.fontBackgroundColor},on:{change:e.changeFontBackgroundColor}}),t("div",{staticClass:"btn",attrs:{slot:"reference"},slot:"reference"},[t("span",{staticClass:"icon iconfont iconbeijingyanse"})])],1)],1),t("el-tooltip",{attrs:{content:e.$t("richTextToolbar.removeFormat"),placement:"top"}},[t("div",{staticClass:"btn",on:{click:e.removeFormat}},[t("span",{staticClass:"icon iconfont iconqingchu"})])])],1)},$s=[],Ds={name:"RichTextToolbar",components:{Color:ti},props:{mindMap:{type:Object}},data(){return{fontSizeList:K["j"],showRichTextToolbar:!1,style:{left:0,top:0},fontColor:"",fontBackgroundColor:"",formatInfo:{}}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark}),fontFamilyList(){return K["i"][this.$i18n.locale]||K["i"].zh}},created(){this.$bus.$on("rich_text_selection_change",this.onRichTextSelectionChange)},mounted(){document.body.append(this.$refs.richTextToolbar)},beforeDestroy(){this.$bus.$off("rich_text_selection_change",this.onRichTextSelectionChange)},methods:{onRichTextSelectionChange(e,t,i){e&&(this.style.left=t.left+t.width/2+"px",this.style.top=t.top-60+"px",this.formatInfo={...i||{}}),this.showRichTextToolbar=e},toggleBold(){this.formatInfo.bold=!this.formatInfo.bold,this.mindMap.richText.formatText({bold:this.formatInfo.bold})},toggleItalic(){this.formatInfo.italic=!this.formatInfo.italic,this.mindMap.richText.formatText({italic:this.formatInfo.italic})},toggleUnderline(){this.formatInfo.underline=!this.formatInfo.underline,this.mindMap.richText.formatText({underline:this.formatInfo.underline})},toggleStrike(){this.formatInfo.strike=!this.formatInfo.strike,this.mindMap.richText.formatText({strike:this.formatInfo.strike})},changeFontFamily(e){this.formatInfo.font=e,this.mindMap.richText.formatText({font:e})},changeFontSize(e){this.formatInfo.size=e,this.mindMap.richText.formatText({size:e+"px"})},changeFontColor(e){this.formatInfo.color=e,this.mindMap.richText.formatText({color:e})},changeFontBackgroundColor(e){this.formatInfo.background=e,this.mindMap.richText.formatText({background:e})},removeFormat(){this.mindMap.richText.removeFormat()}}},Ts=Ds,Ns=(i("e33c"),Object(m["a"])(Ts,Ss,$s,!1,null,"1153699e",null)),Ls=Ns.exports,Ms=function(){var e=this,t=e._self._c;return t("div",{ref:"noteContentViewer",staticClass:"noteContentViewer",style:{left:this.left+"px",top:this.top+"px",visibility:e.show?"visible":"hidden"},on:{click:function(e){e.stopPropagation()}}})},Is=[],Os=i("f059"),Es=i.n(Os),Ps=(i("fe5f"),{name:"NodeNoteContentShow",data(){return{editor:null,show:!1,left:0,top:0,node:null}},created(){this.$bus.$on("showNoteContent",this.onShowNoteContent),this.$bus.$on("hideNoteContent",this.hideNoteContent),document.body.addEventListener("click",this.hideNoteContent),this.$bus.$on("node_active",this.hideNoteContent),this.$bus.$on("scale",this.onScale),this.$bus.$on("translate",this.onScale),this.$bus.$on("svg_mousedown",this.hideNoteContent)},mounted(){this.initEditor()},beforeDestroy(){this.$bus.$off("showNoteContent",this.onShowNoteContent),this.$bus.$off("hideNoteContent",this.hideNoteContent),document.body.removeEventListener("click",this.hideNoteContent),this.$bus.$off("node_active",this.hideNoteContent),this.$bus.$off("scale",this.onScale),this.$bus.$off("translate",this.onScale),this.$bus.$off("svg_mousedown",this.hideNoteContent)},methods:{onShowNoteContent(e,t,i,s){this.node=s,this.editor.setMarkdown(e),this.updateNoteContentPosition(t,i),this.show=!0},updateNoteContentPosition(e,t){this.left=e,this.top=t},onScale(){if(!this.node||!this.show)return;const{left:e,top:t}=this.node.getNoteContentPosition();this.updateNoteContentPosition(e,t)},hideNoteContent(){this.show=!1},initEditor(){this.editor||(this.editor=new Es.a({el:this.$refs.noteContentViewer}))}}}),Fs=Ps,js=(i("ec72"),Object(m["a"])(Fs,Ms,Is,!1,null,"00067113",null)),Rs=js.exports,zs=function(){var e=this,t=e._self._c;return e.showMiniMap?t("div",{ref:"navigatorBox",staticClass:"navigatorBox",class:{isDark:e.isDark},style:{width:e.width+"px"},on:{mousedown:e.onMousedown,mousemove:e.onMousemove,mouseup:e.onMouseup}},[t("div",{ref:"svgBox",staticClass:"svgBox",style:{transform:`scale(${e.svgBoxScale})`,left:e.svgBoxLeft+"px",top:e.svgBoxTop+"px"}},[t("img",{attrs:{src:e.mindMapImg},on:{mousedown:function(e){e.preventDefault()}}})]),t("div",{staticClass:"windowBox",style:e.viewBoxStyle})]):e._e()},As=[],Bs={props:{mindMap:{type:Object}},data(){return{showMiniMap:!1,timer:null,boxWidth:0,boxHeight:0,svgBoxScale:1,svgBoxLeft:0,svgBoxTop:0,viewBoxStyle:{left:0,top:0,bottom:0,right:0},mindMapImg:"",width:0,setSizeTimer:null}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark})},mounted(){this.setSize(),window.addEventListener("resize",this.setSize),this.$bus.$on("toggle_mini_map",this.toggle_mini_map),this.$bus.$on("data_change",this.data_change),this.$bus.$on("view_data_change",this.data_change),this.$bus.$on("node_tree_render_end",this.data_change)},destroyed(){window.removeEventListener("resize",this.setSize),this.$bus.$off("toggle_mini_map",this.toggle_mini_map),this.$bus.$off("data_change",this.data_change),this.$bus.$off("view_data_change",this.data_change),this.$bus.$off("node_tree_render_end",this.data_change)},methods:{toggle_mini_map(e){this.showMiniMap=e,this.$nextTick(()=>{this.$refs.navigatorBox&&this.init(),this.$refs.svgBox&&this.drawMiniMap()})},data_change(){this.showMiniMap&&(clearTimeout(this.timer),this.timer=setTimeout(()=>{this.drawMiniMap()},500))},setSize(){clearTimeout(this.setSizeTimer),this.setSizeTimer=setTimeout(()=>{this.width=Math.min(window.innerWidth-80,370),this.$nextTick(()=>{this.showMiniMap&&(this.init(),this.drawMiniMap())})},300)},init(){let{width:e,height:t}=this.$refs.navigatorBox.getBoundingClientRect();this.boxWidth=e,this.boxHeight=t},drawMiniMap(){let{getImgUrl:e,viewBoxStyle:t,miniMapBoxScale:i,miniMapBoxLeft:s,miniMapBoxTop:a}=this.mindMap.miniMap.calculationMiniMap(this.boxWidth,this.boxHeight);e(e=>{this.mindMapImg=e}),this.viewBoxStyle=t,this.svgBoxScale=i,this.svgBoxLeft=s,this.svgBoxTop=a},onMousedown(e){this.mindMap.miniMap.onMousedown(e)},onMousemove(e){this.mindMap.miniMap.onMousemove(e)},onMouseup(e){this.mindMap.miniMap.onMouseup(e)}}},Vs=Bs,Hs=(i("8152"),Object(m["a"])(Vs,zs,As,!1,null,"47b65232",null)),Ws=Hs.exports,Us=function(){var e=this,t=e._self._c;return t("viewer",{attrs:{images:e.images}},e._l(e.images,(function(e){return t("img",{key:e,attrs:{src:e}})})),0)},Ks=[],Ys={props:{mindMap:{type:Object,default(){return null}}},data(){return{images:[]}},mounted(){this.mindMap.on("node_img_dblclick",this.onNodeTmgDblclick)},beforeDestroy(){this.mindMap.off("node_img_dblclick",this.onNodeTmgDblclick)},methods:{onNodeTmgDblclick(e,t){t.stopPropagation(),t.preventDefault(),this.images=[e.nodeData.data.image],this.$viewerApi({images:this.images})}}},Xs=Ys,Gs=Object(m["a"])(Xs,Us,Ks,!1,null,null,null),Zs=Gs.exports,qs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sidebarTriggerContainer",class:{hasActive:e.show&&e.activeSidebar,show:e.show,isDark:e.isDark},on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"toggleShowBtn",class:{hide:!e.show},on:{click:function(t){e.show=!e.show}}},[t("span",{staticClass:"iconfont iconjiantouyou"})]),t("div",{staticClass:"trigger"},e._l(e.triggerList,(function(i){return t("div",{key:i.value,staticClass:"triggerItem",class:{active:e.activeSidebar===i.value},on:{click:function(t){return e.trigger(i)}}},[t("div",{staticClass:"triggerIcon iconfont",class:[i.icon]}),t("div",{staticClass:"triggerName"},[e._v(e._s(i.name))])])})),0)])},Js=[],Qs={name:"SidebarTrigger",data(){return{show:!0}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,activeSidebar:e=>e.activeSidebar}),triggerList(){return K["t"][this.$i18n.locale]||K["t"].zh}},methods:{...Object(U["c"])(["setActiveSidebar"]),trigger(e){this.setActiveSidebar(e.value)}}},ea=Qs,ta=(i("d7a3"),Object(m["a"])(ea,qs,Js,!1,null,"6c35aebb",null)),ia=ta.exports,sa=function(){var e=this,t=e._self._c;return t("div",{staticClass:"customNodeContent"},[t("p",[e._v(e._s(e.title))]),t("p",{domProps:{innerHTML:e._s(e.html)}}),t("p",{style:{backgroundColor:e.color},on:{click:e.onClick}},[e._v("点击我会变色")])])},aa=[],na={props:{html:{type:String,default:""}},data(){return{title:"我是自定义节点",color:""}},methods:{onClick(){this.color="red"}}},oa=na,la=(i("f262"),Object(m["a"])(oa,sa,aa,!1,null,"147e9dca",null)),ra=(la.exports,i("41cb"),i("c0d6"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"searchContainer",class:{isDark:e.isDark,show:e.show},on:{mouseleave:e.onMouseleave}},[t("div",{staticClass:"closeBtnBox"},[t("span",{staticClass:"closeBtn el-icon-close",on:{click:e.close}})]),t("div",{staticClass:"searchInputBox"},[t("el-input",{ref:"searchInputRef",attrs:{placeholder:e.$t("search.searchPlaceholder"),size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.onSearchNext.apply(null,arguments))},keydown:function(e){e.stopPropagation()}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"}),e.isUndef(e.searchText)?e._e():t("el-button",{attrs:{slot:"append",size:"small"},on:{click:function(t){e.showReplaceInput=!0}},slot:"append"},[e._v(e._s(e.$t("search.replace")))])],1),e.showSearchInfo?t("div",{staticClass:"searchInfo"},[e._v(" "+e._s(e.currentIndex)+" / "+e._s(e.total)+" ")]):e._e()],1),e.showReplaceInput?t("el-input",{ref:"replaceInputRef",staticStyle:{margin:"12px 0"},attrs:{placeholder:e.$t("search.replacePlaceholder"),size:"small"},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.replaceText,callback:function(t){e.replaceText=t},expression:"replaceText"}},[t("i",{staticClass:"el-input__icon el-icon-edit",attrs:{slot:"prefix"},slot:"prefix"}),t("el-button",{attrs:{slot:"append",size:"small"},on:{click:e.hideReplaceInput},slot:"append"},[e._v(e._s(e.$t("search.cancel")))])],1):e._e(),e.showReplaceInput?t("div",{staticClass:"btnList"},[t("el-button",{attrs:{size:"small",disabled:e.isReadonly},on:{click:e.replace}},[e._v(e._s(e.$t("search.replace")))]),t("el-button",{attrs:{size:"small",disabled:e.isReadonly},on:{click:e.replaceAll}},[e._v(e._s(e.$t("search.replaceAll")))])],1):e._e()],1)}),ca=[],da={name:"Search",props:{mindMap:{type:Object}},data(){return{show:!1,searchText:"",replaceText:"",showReplaceInput:!1,currentIndex:0,total:0,showSearchInfo:!1}},computed:{...Object(U["d"])({isReadonly:e=>e.isReadonly,isDark:e=>e.localConfig.isDark})},watch:{searchText(){Object(d["Y"])(this.searchText)&&(this.currentIndex=0,this.total=0,this.showSearchInfo=!1)}},created(){this.$bus.$on("show_search",this.showSearch),this.mindMap.on("search_info_change",this.handleSearchInfoChange),this.mindMap.keyCommand.addShortcut("Control+f",this.showSearch)},beforeDestroy(){this.$bus.$off("show_search",this.showSearch),this.mindMap.off("search_info_change",this.handleSearchInfoChange),this.mindMap.keyCommand.removeShortcut("Control+f",this.showSearch)},methods:{isUndef:d["Y"],handleSearchInfoChange(e){this.currentIndex=e.currentIndex+1,this.total=e.total,this.showSearchInfo=!0},showSearch(){this.$bus.$emit("closeSideBar"),this.show=!0},hideReplaceInput(){this.showReplaceInput=!1,this.replaceText=""},onSearchNext(){this.mindMap.search.search(this.searchText,()=>{this.$refs.searchInputRef.focus()})},replace(){this.mindMap.search.replace(this.replaceText,!0)},replaceAll(){this.mindMap.search.replaceAll(this.replaceText)},close(){this.show=!1,this.showSearchInfo=!1,this.total=0,this.currentIndex=0,this.searchText="",this.hideReplaceInput(),this.mindMap.search.endSearch()},onMouseleave(){this.$refs.searchInputRef&&this.$refs.searchInputRef.blur(),this.$refs.replaceInputRef&&this.$refs.replaceInputRef.blur()}}},ha=da,ua=(i("d8f8"),Object(m["a"])(ha,ra,ca,!1,null,"285c8358",null)),ma=ua.exports,pa=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("nodeIconSidebar.title")}},[t("div",{staticClass:"box",class:{isDark:e.isDark}},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:e.$t("nodeIconSidebar.icon"),name:"icon"}}),t("el-tab-pane",{attrs:{label:e.$t("nodeIconSidebar.sticker"),name:"image"}})],1),t("div",{staticClass:"boxContent"},["icon"===e.activeName?t("div",{staticClass:"iconBox"},e._l(e.nodeIconList,(function(i){return t("div",{key:i.name,staticClass:"item"},[t("div",{staticClass:"title"},[e._v(e._s(i.name))]),t("div",{staticClass:"list"},e._l(i.list,(function(s){return t("div",{key:s.name,staticClass:"icon",class:{selected:e.iconList.includes(i.type+"_"+s.name)},domProps:{innerHTML:e._s(e.getHtml(s.icon))},on:{click:function(t){return e.setIcon(i.type,s.name)}}})})),0)])})),0):e._e()])],1)])},ga=[],fa=i("de42"),ba={name:"NodeIconSidebar",components:{Sidebar:jt},data(){return{activeName:"icon",nodeIconList:Object(d["cb"])([...k["b"],...S["a"]]),nodeImageList:[...fa["a"]],iconList:[],nodeImage:"",activeNodes:[]}},computed:{...Object(U["d"])({activeSidebar:e=>e.activeSidebar,isDark:e=>e.localConfig.isDark})},watch:{activeSidebar(e){this.$refs.sidebar.show="nodeIconSidebar"===e}},created(){this.$bus.$on("node_active",this.handleNodeActive),this.$bus.$on("showNodeIcon",this.handleShowNodeIcon)},beforeDestroy(){this.$bus.$off("node_active",this.handleNodeActive),this.$bus.$off("showNodeIcon",this.handleShowNodeIcon)},methods:{handleNodeActive(...e){if(this.activeNodes=[...e[1]],this.activeNodes.length>0)if(1===this.activeNodes.length){let e=this.activeNodes[0];this.nodeImage=e.getData("image")||"",this.iconList=e.getData("icon")||[]}else this.nodeImage=[],this.iconList=[];else this.iconList=[],this.nodeImage=""},handleShowNodeIcon(){this.dialogVisible=!0},getHtml(e){return/^<svg/.test(e)?e:`<img src="${e}" />`},setIcon(e,t){this.activeNodes.forEach(i=>{const s=[...i.getData("icon")||[]];let a=e+"_"+t,n=s.findIndex(e=>e===a);if(-1!==n)s.splice(n,1);else{let t=s.findIndex(t=>t.split("_")[0]===e);-1!==t?s.splice(t,1,a):s.push(a)}i.setIcon(s),1===this.activeNodes.length&&(this.iconList=s)})},setImage(e){this.activeNodes.forEach(t=>{this.nodeImage=e.url,t.setImage({...e})})}}},va=ba,ya=(i("f656"),Object(m["a"])(va,pa,ga,!1,null,"8c9dcee4",null)),Ca=ya.exports,wa=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showNodeIconToolbar,expression:"showNodeIconToolbar"}],ref:"nodeIconToolbar",staticClass:"nodeIconToolbar",style:e.style,on:{"&click":function(e){e.stopPropagation()}}},[t("div",{staticClass:"iconListBox"},e._l(e.iconList,(function(i){return t("div",{key:i.name,staticClass:"icon",class:{selected:e.nodeIconList.includes(e.iconType+"_"+i.name)},domProps:{innerHTML:e._s(e.getHtml(i.icon))},on:{click:function(t){return e.setIcon(i.name)}}})})),0),t("div",{staticClass:"btnBox"},[t("span",{staticClass:"btn iconfont iconshanchu",on:{click:e.deleteIcon}})])])},_a=[];const xa=[...k["b"],...S["a"]];var ka={name:"NodeIconToolbar",components:{},props:{mindMap:{type:Object}},data(){return{showNodeIconToolbar:!1,style:{left:0,top:0},node:null,iconType:"",iconName:"",nodeIconList:[],iconList:[]}},computed:{...Object(U["d"])(["activeSidebar"])},created(){this.mindMap.on("node_icon_click",this.show),this.mindMap.on("draw_click",this.close),this.mindMap.on("svg_mousedown",this.close),this.mindMap.on("node_dblclick",this.close),this.mindMap.on("node_active",this.onNodeActive),this.mindMap.on("scale",this.onScale),this.$bus.$on("close_node_icon_toolbar",this.close)},mounted(){document.body.append(this.$refs.nodeIconToolbar)},beforeDestroy(){this.mindMap.off("node_icon_click",this.show),this.mindMap.off("draw_click",this.close),this.mindMap.off("svg_mousedown",this.close),this.mindMap.off("node_dblclick",this.close),this.mindMap.off("node_active",this.onNodeActive),this.mindMap.off("scale",this.onScale),this.$bus.$off("close_node_icon_toolbar",this.close)},methods:{...Object(U["c"])(["setActiveSidebar"]),show(e,t){this.node=e,this.iconType=t.split("_")[0],this.iconName=t.split("_")[1],this.nodeIconList=e.getData("icon")||[],this.iconList=[...xa.find(e=>e.type===this.iconType).list],this.updatePos(),this.showNodeIconToolbar=!0,"nodeIconSidebar"===this.activeSidebar&&this.setActiveSidebar("")},close(){this.showNodeIconToolbar=!1,this.node=null,this.iconType="",this.iconName="",this.nodeIconList=[],this.iconList=[],this.style.left=0,this.style.top=0},updatePos(){if(!this.node)return;const e=this.node.getRect();this.style.left=e.x+"px",this.style.top=e.y+e.height+"px"},onScale(){this.updatePos()},onNodeActive(e){e!==this.node&&this.close()},deleteIcon(){this.setIcon(this.iconName),this.close()},getHtml(e){return/^<svg/.test(e)?e:`<img src="${e}" />`},setIcon(e){let t=this.iconType+"_"+e,i=this.nodeIconList.findIndex(e=>e===t);if(-1!==i)this.nodeIconList.splice(i,1);else{let i=this.nodeIconList.findIndex(e=>e.split("_")[0]===this.iconType);-1!==i?(this.nodeIconList.splice(i,1,t),this.iconName=e):this.nodeIconList.push(t)}this.node.setIcon([...this.nodeIconList])}}},Sa=ka,$a=(i("7e07"),Object(m["a"])(Sa,wa,_a,!1,null,"86412fc4",null)),Da=$a.exports,Ta=function(){var e=this,t=e._self._c;return e.isOutlineEdit?t("div",{ref:"outlineEditContainer",staticClass:"outlineEditContainer",class:{isDark:e.isDark}},[t("div",{staticClass:"closeBtn",on:{click:e.onClose}},[t("span",{staticClass:"icon iconfont iconguanbi"})]),t("div",{ref:"outlineEditBox",staticClass:"outlineEditBox"},[t("div",{staticClass:"outlineEdit"},[t("el-tree",{ref:"tree",staticClass:"outlineTree",class:{isDark:e.isDark},attrs:{"node-key":"uid",draggable:"","default-expand-all":"",data:e.data,props:e.defaultProps,"highlight-current":!0,"expand-on-click-node":!1,"allow-drag":e.checkAllowDrag},on:{"node-drop":e.onNodeDrop,"current-change":e.onCurrentChange},scopedSlots:e._u([{key:"default",fn:function({node:i,data:s}){return t("span",{staticClass:"customNode",attrs:{"data-id":s.uid}},[t("span",{key:e.getKey(),staticClass:"nodeEdit",attrs:{contenteditable:!e.isReadonly},domProps:{innerHTML:e._s(i.label)},on:{blur:function(t){return e.onBlur(t,i)},keydown:function(t){return t.stopPropagation(),e.onNodeInputKeydown(t,i)},keyup:function(e){e.stopPropagation()},paste:function(t){return e.onPaste(t,i)}}})])}}],null,!1,485109613)})],1)])]):e._e()},Na=[],La={name:"OutlineEdit",props:{mindMap:{type:Object}},data(){return{data:[],defaultProps:{label:"label"},currentData:null}},computed:{...Object(U["d"])({isReadonly:e=>e.isReadonly,isDark:e=>e.localConfig.isDark,isOutlineEdit:e=>e.isOutlineEdit})},watch:{isOutlineEdit(e){e&&(this.refresh(),this.$nextTick(()=>{document.body.appendChild(this.$refs.outlineEditContainer)}))}},created(){window.addEventListener("keydown",this.onKeyDown)},beforeDestroy(){window.removeEventListener("keydown",this.onKeyDown)},methods:{...Object(U["c"])(["setIsOutlineEdit"]),refresh(){let e=this.mindMap.getData();e.root=!0;let t=e=>{let i=e.data.richText?Object(d["eb"])(e.data.text):e.data.text;i=Object(d["T"])(i),i=i.replaceAll(/\n/g,"<br>"),e.textCache=i,e.label=i,e.uid=e.data.uid,e.children&&e.children.length>0&&e.children.forEach(e=>{t(e)})};t(e),this.data=[e]},checkAllowDrag(e){return!e.data.root},onNodeDrop(){this.save()},onCurrentChange(e){this.currentData=e},onBlur(e,t){if(t.data.textCache===e.target.innerHTML)return;const i=t.data.data.richText,s=i?e.target.innerHTML:e.target.innerText;t.data.data.text=i?Object(d["sb"])(s):s,i&&(t.data.data.resetRichText=!0),t.data.textCache=e.target.innerHTML,this.save()},onNodeInputKeydown(e,t){const i=!!t.data.data.richText,s=Object(d["q"])(),a=this.$t("outline.nodeDefaultText"),n={textCache:a,uid:s,label:a,data:{text:i?Object(d["sb"])(a):a,uid:s,richText:i},children:[]};if(i&&(n.data.resetRichText=!0),13===e.keyCode&&!e.shiftKey){if(e.preventDefault(),t.data.root)return;this.$refs.tree.insertAfter(n,t)}9===e.keyCode&&(e.preventDefault(),e.shiftKey?(this.$refs.tree.insertAfter(t.data,t.parent),this.$refs.tree.remove(t)):this.$refs.tree.append(n,t)),this.save(),this.$nextTick(()=>{this.$refs.tree.setCurrentKey(s);const e=document.querySelector(`.customNode[data-id="${s}"] .nodeEdit`);if(e){let t=window.getSelection(),i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i);let s=e.offsetTop;this.scrollTo(s)}})},onKeyDown(e){this.isOutlineEdit&&[46,8].includes(e.keyCode)&&this.currentData&&(e.stopPropagation(),this.$refs.tree.remove(this.currentData),this.currentData=null,this.save())},onPaste(e){Object(d["R"])(e)},getKey(){return Math.random()},onClose(){this.setIsOutlineEdit(!1),this.$bus.$emit("setData",this.getData())},scrollTo(e){let t=this.$refs.outlineEditBox,i=t.offsetHeight,s=t.scrollTop;e+=50,e>s+i&&t.scrollTo(0,e-i/2)},getData(){let e={},t=this.data[0],i=(e,t)=>{t.data=e.data,t.children=[],(e.children||[]).forEach(e=>{const s={};t.children.push(s),i(e,s)})};return i(t,e),Object(d["rb"])(e)},save(){Object(de["f"])(this.getData())}}},Ma=La,Ia=(i("aba9"),Object(m["a"])(Ma,Ta,Na,!1,null,"1a3e1af3",null)),Oa=Ia.exports,Ea=i("3908"),Pa=i("e1ba"),Fa=function(){var e=this,t=e._self._c;return t("div",{staticClass:"scrollbarContainer",class:{isDark:e.isDark}},[t("div",{ref:"verticalScrollbarRef",staticClass:"scrollbar verticalScrollbar",on:{click:e.onVerticalScrollbarClick}},[t("div",{staticClass:"scrollbarInner",style:e.verticalScrollbarStyle,on:{click:function(e){e.stopPropagation()},mousedown:e.onVerticalScrollbarMousedown}})]),t("div",{ref:"horizontalScrollbarRef",staticClass:"scrollbar horizontalScrollbar",on:{click:e.onHorizontalScrollbarClick}},[t("div",{staticClass:"scrollbarInner",style:e.horizontalScrollbarStyle,on:{click:function(e){e.stopPropagation()},mousedown:e.onHorizontalScrollbarMousedown}})])])},ja=[],Ra={props:{mindMap:{type:Object}},data(){return{timer:null,resizeTimer:null,verticalScrollbarStyle:{},horizontalScrollbarStyle:{}}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark})},mounted(){this.setScrollBarWrapSize(),this.$bus.$on("scrollbar_change",this.updateScrollbar),window.addEventListener("resize",this.onResize)},beforeDestroy(){this.$bus.$off("scrollbar_change",this.updateScrollbar),window.removeEventListener("resize",this.onResize)},methods:{setScrollBarWrapSize(){if(!this.mindMap.scrollbar)return;const{width:e}=this.$refs.horizontalScrollbarRef.getBoundingClientRect(),{height:t}=this.$refs.verticalScrollbarRef.getBoundingClientRect();this.mindMap.scrollbar.setScrollBarWrapSize(e,t)},onResize(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.setScrollBarWrapSize()},300)},updateScrollbar({vertical:e,horizontal:t}){this.verticalScrollbarStyle={top:e.top+"%",height:e.height+"%"},this.horizontalScrollbarStyle={left:t.left+"%",width:t.width+"%"}},onVerticalScrollbarMousedown(e){this.mindMap.scrollbar.onMousedown(e,"vertical")},onVerticalScrollbarClick(e){this.mindMap.scrollbar.onClick(e,"vertical")},onHorizontalScrollbarMousedown(e){this.mindMap.scrollbar.onMousedown(e,"horizontal")},onHorizontalScrollbarClick(e){this.mindMap.scrollbar.onClick(e,"horizontal")}}},za=Ra,Aa=(i("58ec"),Object(m["a"])(za,Fa,ja,!1,null,"1ba52cc9",null)),Ba=Aa.exports,Va=function(){var e=this,t=e._self._c;return t("Sidebar",{ref:"sidebar",attrs:{title:e.$t("formulaSidebar.title")}},[t("div",{staticClass:"box",class:{isDark:e.isDark}},[t("div",{staticClass:"formulaInputBox"},[t("el-input",{attrs:{rows:4,resize:"none",type:"textarea",placeholder:e.$t("formulaSidebar.placeholder")},nativeOn:{keydown:function(e){e.stopPropagation()}},model:{value:e.formulaText,callback:function(t){e.formulaText=t},expression:"formulaText"}}),t("el-button",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{size:"small"},on:{click:e.confirm}},[e._v(e._s(e.$t("formulaSidebar.confirm")))])],1),t("div",{staticClass:"title"},[e._v(e._s(e.$t("formulaSidebar.common")))]),t("div",{staticClass:"formulaList"},e._l(e.list,(function(i,s){return t("div",{key:s,staticClass:"formulaItem"},[t("div",{staticClass:"overview",domProps:{innerHTML:e._s(i.overview)}}),t("div",{staticClass:"text",on:{click:function(t){e.formulaText=i.text}}},[e._v(" "+e._s(i.text)+" ")])])})),0)])])},Ha=[],Wa=(i("be0f"),{name:"FormulaSidebar",components:{Sidebar:jt},props:{mindMap:{type:Object}},data(){return{formulaText:"",list:[]}},computed:{...Object(U["d"])({activeSidebar:e=>e.activeSidebar,isDark:e=>e.localConfig.isDark,localConfig:e=>e.localConfig})},watch:{activeSidebar(e){this.$refs.sidebar.show="formulaSidebar"===e}},created(){this.$bus.$on("node_active",this.handleNodeActive)},beforeDestroy(){this.$bus.$off("node_active",this.handleNodeActive)},mounted(){this.init()},methods:{...Object(U["c"])(["setActiveSidebar"]),init(){this.list=ri["a"].map(e=>({overview:window.katex.renderToString(e,this.mindMap.formula.getKatexConfig()),text:e}))},handleNodeActive(...e){this.activeNodes=[...e[1]],this.activeNodes.length<=0&&"formulaSidebar"===this.activeSidebar&&this.setActiveSidebar(null)},confirm(){if(!this.localConfig.openNodeRichText)return this.$message.warning(this.$t("formulaSidebar.tip"));let e=this.formulaText.trim();e&&this.mindMap.execCommand("INSERT_FORMULA",e)}}}),Ua=Wa,Ka=(i("2aa2"),Object(m["a"])(Ua,Va,Ha,!1,null,"41375afe",null)),Ya=Ka.exports,Xa=function(){var e=this,t=e._self._c;return e.isSourceCodeEdit?t("div",{ref:"sourceCodeEditContainer",staticClass:"sourceCodeEditContainer",class:{isDark:e.isDark}},[t("div",{staticClass:"closeBtn"},[t("el-tooltip",{attrs:{effect:"dark",content:e.$t("sourceCodeEdit.copy"),placement:"top"}},[t("span",{staticClass:"icon iconfont iconfuzhi",staticStyle:{"font-size":"26px"},on:{click:e.copy}})]),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("sourceCodeEdit.format"),placement:"top"}},[t("span",{staticClass:"icon iconfont icongeshihua",staticStyle:{"font-size":"24px"},on:{click:e.format}})]),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("sourceCodeEdit.sourceCodeTip"),placement:"top"}},[t("span",{staticClass:"icon el-icon-info"})]),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("sourceCodeEdit.confirm"),placement:"top"}},[t("span",{staticClass:"icon el-icon-circle-check",on:{click:e.onConfirm}})]),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("sourceCodeEdit.close"),placement:"top"}},[t("span",{staticClass:"icon iconfont iconguanbi",on:{click:e.onClose}})])],1),t("div",{staticClass:"sourceCodeEditBox"},[t("div",{ref:"outlineEditRef",staticClass:"outlineEdit",on:{keydown:function(e){e.stopPropagation()}}})])]):e._e()},Ga=[],Za=i("56b3"),qa=i.n(Za);i("f9d4"),i("a7be");let Ja=null;var Qa={name:"SourceCodeEdit",props:{mindMap:{type:Object}},data(){return{}},computed:{...Object(U["d"])({isReadonly:e=>e.isReadonly,isDark:e=>e.localConfig.isDark,isSourceCodeEdit:e=>e.isSourceCodeEdit})},watch:{isSourceCodeEdit(e){e&&this.$nextTick(()=>{document.body.appendChild(this.$refs.sourceCodeEditContainer),this.initEditor(),this.initData()})}},methods:{...Object(U["c"])(["setIsSourceCodeEdit"]),initEditor(){Ja=qa()(this.$refs.outlineEditRef,{mode:{name:"javascript",json:!0},lineWrapping:!0,lineNumbers:!0})},initData(){Ja.setValue(JSON.stringify(this.mindMap.getData(),null,2))},onConfirm(){try{const e=Ja.getValue(),t=JSON.parse(e);this.setIsSourceCodeEdit(!1),this.$bus.$emit("setData",t)}catch(e){console.log(e),this.$message.error(this.$t("sourceCodeEdit.formatErrorTip"))}},onClose(){this.setIsSourceCodeEdit(!1)},copy(){const e=Ja.getValue();Object(te["a"])(e),this.$message.success(this.$t("sourceCodeEdit.copyTip"))},format(){try{const e=Ja.getValue(),t=JSON.parse(e);Ja.setValue(JSON.stringify(t,null,2)),this.$message.success(this.$t("sourceCodeEdit.formatTip"))}catch(e){console.log(e),this.$message.error(this.$t("sourceCodeEdit.formatErrorTip"))}}}},en=Qa,tn=(i("7931"),Object(m["a"])(en,Xa,Ga,!1,null,"1582a7b5",null)),sn=tn.exports,an=function(){var e=this,t=e._self._c;return t("div",{staticClass:"nodeAttachmentContextMenu",style:{left:this.left+"px",top:this.top+"px",visibility:e.show?"visible":"hidden"},on:{click:function(t){return t.stopPropagation(),e.deleteAttachment.apply(null,arguments)}}},[t("div",{staticClass:"menuItem"},[e._v(e._s(e.$t("attachment.deleteAttachment")))])])},nn=[],on={props:{mindMap:{type:Object,default(){return null}}},data(){return{show:!1,left:0,top:0,node:null,icon:null}},created(){this.$bus.$on("node_attachmentClick",this.onNodeAttachmentClick),this.$bus.$on("selectAttachment",this.onSelectAttachment),this.$bus.$on("node_attachmentContextmenu",this.onNodeAttachmentContextmenu),this.$bus.$on("hide",this.hide),document.body.addEventListener("click",this.hide),this.$bus.$on("node_active",this.hide),this.$bus.$on("scale",this.onScale),this.$bus.$on("translate",this.onScale),this.$bus.$on("svg_mousedown",this.hide)},beforeDestroy(){this.$bus.$off("node_attachmentClick",this.onNodeAttachmentClick),this.$bus.$off("selectAttachment",this.onSelectAttachment),this.$bus.$off("node_attachmentContextmenu",this.onNodeAttachmentContextmenu),this.$bus.$off("hide",this.hide),document.body.removeEventListener("click",this.hide),this.$bus.$off("node_active",this.hide),this.$bus.$off("scale",this.onScale),this.$bus.$off("translate",this.onScale),this.$bus.$off("svg_mousedown",this.hide)},methods:{onSelectAttachment(e){},onNodeAttachmentClick(e,t,i){this.$message.info(this.$t("attachment.tip"))},onNodeAttachmentContextmenu(e,t,i){t.stopPropagation(),t.preventDefault(),this.node=e,this.icon=i,this.updatePosition(),this.show=!0},updatePosition(){const e=this.mindMap.themeConfig.iconSize,{x:t,y:i}=this.icon.rbox();this.left=t+e,this.top=i},onScale(){this.node&&this.show&&this.updatePosition()},deleteAttachment(){this.node&&this.show&&(this.node.setAttachment("",""),this.hide())},hide(){this.show=!1}}},ln=on,rn=(i("c089"),Object(m["a"])(ln,an,nn,!1,null,"1efd3b5c",null)),cn=rn.exports,dn=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],ref:"elRef",staticClass:"nodeOuterFrameContainer",class:{isDark:e.isDark},style:e.position},[t("div",{staticClass:"btn",on:{click:function(t){e.showPanel=!e.showPanel}}},[t("span",{staticClass:"iconfont iconjingzi"})]),e.showPanel?t("div",{staticClass:"panel"},[t("div",{staticClass:"panelHeader"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("nodeOuterFrame.outerFrameSetting")))]),t("span",{staticClass:"deleteBtn",on:{click:e.deleteOuterFrame}},[e._v(" "+e._s(e.$t("nodeOuterFrame.deleteOuterFrame"))+" "),t("span",{staticClass:"iconfont iconshanchu"})])]),t("div",{staticClass:"panelBody"},[t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("nodeOuterFrame.boxStyle")))]),t("el-select",{staticStyle:{width:"80px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.updateOuterFrame("strokeWidth",t)}},model:{value:e.styleConfig.strokeWidth,callback:function(t){e.$set(e.styleConfig,"strokeWidth",t)},expression:"styleConfig.strokeWidth"}},e._l(e.lineWidthList,(function(i){return t("el-option",{key:i,attrs:{label:i,value:i}},[i>0?t("span",{staticClass:"borderLine",class:{isDark:e.isDark},style:{height:i+"px"}}):e._e()])})),1),t("el-select",{staticStyle:{width:"80px","margin-left":"4px"},attrs:{size:"mini",placeholder:""},on:{change:t=>{e.updateOuterFrame("strokeDasharray",t)}},model:{value:e.styleConfig.strokeDasharray,callback:function(t){e.$set(e.styleConfig,"strokeDasharray",t)},expression:"styleConfig.strokeDasharray"}},e._l(e.borderDasharrayList,(function(i){return t("el-option",{key:i.value,attrs:{label:i.name,value:i.value}},[t("svg",{attrs:{width:"120",height:"34"}},[t("line",{attrs:{x1:"10",y1:"17",x2:"110",y2:"17","stroke-width":"2",stroke:e.styleConfig.strokeDasharray===i.value?"#409eff":e.isDark?"#fff":"#000","stroke-dasharray":i.value}})])])})),1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("nodeOuterFrame.boxColor")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover",arg:"popover"}],staticClass:"block",style:{backgroundColor:e.styleConfig.strokeColor}}),t("el-popover",{ref:"popover",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.styleConfig.strokeColor},on:{change:t=>{e.updateOuterFrame("strokeColor",t)}}})],1)],1)]),t("div",{staticClass:"row"},[t("div",{staticClass:"rowItem"},[t("span",{staticClass:"name"},[e._v(e._s(e.$t("nodeOuterFrame.fillColor")))]),t("span",{directives:[{name:"popover",rawName:"v-popover:popover2",arg:"popover2"}],staticClass:"block",style:{backgroundColor:e.styleConfig.fill}}),t("el-popover",{ref:"popover2",attrs:{placement:"bottom",trigger:"click"}},[t("Color",{attrs:{color:e.styleConfig.fill},on:{change:t=>{e.updateOuterFrame("fill",t)}}})],1)],1)])])]):e._e()])},hn=[],un={components:{Color:ti},props:{mindMap:{type:Object}},data(){return{lineWidthList:K["o"],show:!1,showPanel:!1,position:{left:0,top:0},styleConfig:{radius:5,strokeWidth:2,strokeColor:"#0984e3",strokeDasharray:"5,5",fill:"rgba(9,132,227,0.05)"}}},computed:{...Object(U["d"])({isDark:e=>e.localConfig.isDark,borderDasharrayList(){return K["d"][this.$i18n.locale]||K["d"].zh}})},created(){this.mindMap.on("outer_frame_active",this.onOuterFrameActive),this.mindMap.on("scale",this.hide),this.mindMap.on("translate",this.hide),this.mindMap.on("svg_mousedown",this.hide),this.mindMap.on("expand_btn_click",this.hide),this.mindMap.on("outer_frame_delete",this.hide)},beforeDestroy(){this.mindMap.off("outer_frame_active",this.onOuterFrameActive),this.mindMap.off("scale",this.hide),this.mindMap.off("translate",this.hide),this.mindMap.off("svg_mousedown",this.hide),this.mindMap.off("expand_btn_click",this.hide),this.mindMap.off("outer_frame_delete",this.hide)},mounted(){document.body.appendChild(this.$refs.elRef)},methods:{onOuterFrameActive(e,t,i){const s=t.children[i[0]],a=s.getData("outerFrame");Object.keys(a).forEach(e=>{this.styleConfig[e]=a[e]});const{x:n,y:o,width:l}=e.rbox();this.position.left=n+l+"px",this.position.top=o+"px",this.show=!0},updateOuterFrame(e,t){this.styleConfig[e]=t,this.mindMap.outerFrame.updateActiveOuterFrame({[e]:t}),this.hide()},deleteOuterFrame(){this.mindMap.outerFrame.removeActiveOuterFrame()},hide(){this.show=!1,this.showPanel=!1}}},mn=un,pn=(i("fcf2"),i("ca70"),Object(m["a"])(mn,dn,hn,!1,null,"5fffe246",null)),gn=pn.exports,fn=(i("2ef0"),i("6a66"));ct["a"].usePlugin(dt["a"]).usePlugin(ht["a"]).usePlugin(ft["a"]).usePlugin(ut["a"]).usePlugin(mt["a"]).usePlugin(pt["a"]).usePlugin(gt["a"]).usePlugin(bt["a"]).usePlugin(yt["a"]).usePlugin(wt["a"]).usePlugin(Ct["a"]).usePlugin(_t["a"]).usePlugin(xt["a"]).usePlugin(St["a"]).usePlugin($t["a"]).usePlugin(Dt["a"]).usePlugin(Tt["a"]).usePlugin(Nt["a"]),fi["a"].forEach(e=>{ct["a"].defineTheme(e.value,e.theme)});var bn={name:"Edit",components:{OutlineSidebar:Yt,Style:ni,BaseStyle:ui,Theme:Ci,Structure:$i,Count:Ei,NavigatorToolbar:us,ShortcutKey:vs,Contextmenu:ks,RichTextToolbar:Ls,NodeNoteContentShow:Rs,Navigator:Ws,NodeImgPreview:Zs,SidebarTrigger:ia,Search:ma,NodeIconSidebar:Ca,NodeIconToolbar:Da,OutlineEdit:Oa,Scrollbar:Ba,FormulaSidebar:Ya,SourceCodeEdit:sn,NodeAttachment:cn,NodeOuterFrame:gn},data(){return{enableShowLoading:!0,mindMap:null,mindMapData:null,prevImg:"",storeConfigTimer:null,showDragMask:!1,loading:!1}},computed:{...Object(U["d"])({isZenMode:e=>e.localConfig.isZenMode,openNodeRichText:e=>e.localConfig.openNodeRichText,isShowScrollbar:e=>e.localConfig.isShowScrollbar,useLeftKeySelectionRightKeyDrag:e=>e.localConfig.useLeftKeySelectionRightKeyDrag,isUseHandDrawnLikeStyle:e=>e.localConfig.isUseHandDrawnLikeStyle,extraTextOnExport:e=>e.extraTextOnExport})},watch:{openNodeRichText(){this.openNodeRichText?this.addRichTextPlugin():this.removeRichTextPlugin()},isShowScrollbar(){this.isShowScrollbar?this.addScrollbarPlugin():this.removeScrollbarPlugin()},isUseHandDrawnLikeStyle(){this.isUseHandDrawnLikeStyle?this.addHandDrawnLikeStylePlugin():this.removeHandDrawnLikeStylePlugin()}},mounted(){Object(Ea["b"])(),this.getData(),this.$bus.$on("execCommand",this.execCommand),this.$bus.$on("paddingChange",this.onPaddingChange),this.$bus.$on("export",this.export),this.$bus.$on("setData",this.setData),this.$bus.$on("startTextEdit",this.handleStartTextEdit),this.$bus.$on("endTextEdit",this.handleEndTextEdit),this.$bus.$on("createAssociativeLine",this.handleCreateLineFromActiveNode),this.$bus.$on("startPainter",this.handleStartPainter),this.$bus.$on("node_tree_render_end",this.handleHideLoading),this.$bus.$on("showLoading",this.handleShowLoading),window.addEventListener("resize",this.handleResize);let e=this;fn["a"].$on("demo",(function(t){e.casereadonly(t)}))},beforeDestroy(){this.$bus.$off("execCommand",this.execCommand),this.$bus.$off("paddingChange",this.onPaddingChange),this.$bus.$off("export",this.export),this.$bus.$off("setData",this.setData),this.$bus.$off("startTextEdit",this.handleStartTextEdit),this.$bus.$off("endTextEdit",this.handleEndTextEdit),this.$bus.$off("createAssociativeLine",this.handleCreateLineFromActiveNode),this.$bus.$off("startPainter",this.handleStartPainter),this.$bus.$off("node_tree_render_end",this.handleHideLoading),this.$bus.$off("showLoading",this.handleShowLoading),window.removeEventListener("resize",this.handleResize),this.mindMap.destroy()},methods:{casereadonly(e){this.mindMap.setMode(e)},handleStartTextEdit(){this.mindMap.renderer.startTextEdit()},handleEndTextEdit(){this.mindMap.renderer.endTextEdit()},handleCreateLineFromActiveNode(){this.mindMap.associativeLine.createLineFromActiveNode()},handleStartPainter(){this.mindMap.painter.startPainter()},handleResize(){this.mindMap.resize()},handleShowLoading(){this.enableShowLoading=!0,Object(Ea["b"])()},handleHideLoading(){this.enableShowLoading&&(this.enableShowLoading=!1,Object(Ea["a"])())},getData(){Object(se["e"])({pagenum:"20",page:1,id:window.sessionStorage.getItem("logid"),caseid:""}).then(e=>{this.mindMapData=JSON.parse(e.results[0].operationcontent),this.init()}).catch(e=>{this.$message.error("数据异常，联系管理员检查。")})},bindSaveEvent(){this.mindMap.setMode("readonly")},manualSave(){},init(){let e=this.hasFileURL(),{root:t,layout:s,theme:a,view:n,config:o}=this.mindMapData;e&&(t={data:{text:this.$t("edit.root")},children:[]},s=ce["a"].layout,a=ce["a"].theme,n=null),this.mindMap=new ct["a"]({el:this.$refs.mindMapContainer,data:t,fit:!1,layout:s,theme:a.template,themeConfig:a.config,viewData:n,nodeTextEditZIndex:1e3,nodeNoteTooltipZIndex:1e3,customNoteContentShow:{show:(e,t,i,s)=>{this.$bus.$emit("showNoteContent",e,t,i,s)},hide:()=>{}},...o||{},iconList:[...S["a"]],useLeftKeySelectionRightKeyDrag:this.useLeftKeySelectionRightKeyDrag,customInnerElsAppendTo:null,enableAutoEnterTextEditWhenKeydown:!0,customHandleClipboardText:Pa["a"],defaultNodeImage:i("24d1"),initRootNodePosition:["center","center"],handleIsSplitByWrapOnPasteCreateNewNode:()=>this.$confirm(this.$t("edit.splitByWrap"),this.$t("edit.tip"),{confirmButtonText:this.$t("edit.yes"),cancelButtonText:this.$t("edit.no"),type:"warning"}),errorHandler:(e,t)=>{switch(console.error(t),e){case"export_error":this.$message.error(this.$t("edit.exportError"));break;default:break}},addContentToFooter:()=>{const e=this.extraTextOnExport.trim();if(!e)return null;const t=document.createElement("div");t.className="footer",t.innerHTML=e;const i="\n\t            .footer {\n\t              width: 100%;\n\t              height: 30px;\n\t              display: flex;\n\t              justify-content: center;\n\t              align-items: center;\n\t              font-size: 12px;\n\t              color: #979797;\n\t            }\n\t          ";return{el:t,cssText:i,height:30}}}),this.openNodeRichText&&this.addRichTextPlugin(),this.isShowScrollbar&&this.addScrollbarPlugin(),this.isUseHandDrawnLikeStyle&&this.addHandDrawnLikeStylePlugin(),this.mindMap.keyCommand.addShortcut("Control+s",()=>{this.manualSave(),this.saveLocalFile()}),["node_active","data_change","view_data_change","back_forward","node_contextmenu","node_click","draw_click","expand_btn_click","svg_mousedown","mouseup","mode_change","node_tree_render_end","rich_text_selection_change","transforming-dom-to-images","generalization_node_contextmenu","painter_start","painter_end","scrollbar_change","scale","translate","node_attachmentClick","node_attachmentContextmenu","demonstrate_jump","exit_demonstrate"].forEach(e=>{this.mindMap.on(e,(...t)=>{this.$bus.$emit(e,...t)})}),this.bindSaveEvent(),this.testDynamicCreateNodes(),window.takeOverApp&&this.$bus.$emit("app_inited",this.mindMap),e&&this.$bus.$emit("handle_file_url")},hasFileURL(){const e=this.$route.query.fileURL;return!!e&&/\.(smm|json|xmind|md|xlsx)$/.test(e)},setData(e){},reRender(){this.mindMap.reRender()},execCommand(...e){this.mindMap.execCommand(...e)},async export(...e){try{Object(Ea["b"])(),await this.mindMap.export(...e),Object(Ea["a"])()}catch(t){console.log(t),Object(Ea["a"])()}},onPaddingChange(e){this.mindMap.updateConfig(e)},showNewFeatureInfo(){let e=sessionStorage.getItem("SIMPLE_MIND_MAP_NEW_FEATURE_TIP_1");e||this.$notify.info({title:this.$t("edit.newFeatureNoticeTitle"),message:this.$t("edit.newFeatureNoticeMessage"),duration:0,onClose:()=>{sessionStorage.setItem("SIMPLE_MIND_MAP_NEW_FEATURE_TIP_1",!0)}})},addRichTextPlugin(){this.mindMap&&this.mindMap.addPlugin(vt["a"])},removeRichTextPlugin(){this.mindMap.removePlugin(vt["a"])},addScrollbarPlugin(){this.mindMap&&this.mindMap.addPlugin(kt["a"])},removeScrollbarPlugin(){this.mindMap.removePlugin(kt["a"])},addHandDrawnLikeStylePlugin(){try{if(!this.mindMap)return;this.mindMap.addPlugin(HandDrawnLikeStyle),this.mindMap.reRender()}catch(e){console.log("手绘风格插件不存在")}},removeHandDrawnLikeStylePlugin(){try{this.mindMap.removePlugin(HandDrawnLikeStyle),this.mindMap.reRender()}catch(e){console.log("手绘风格插件不存在")}},testDynamicCreateNodes(){setTimeout(()=>{},5e3)},cooperateTest(){},onDragenter(){this.showDragMask=!0},onDragleave(){this.showDragMask=!1},onDrop(e){this.showDragMask=!1;const t=e.dataTransfer,i=t.files&&t.files[0];this.$bus.$emit("importFile",i)}}},vn=bn,yn=(i("1b84"),Object(m["a"])(vn,lt,rt,!1,null,"8200b8ce",null)),Cn=yn.exports,wn={name:"Index",components:{Toolbar:ot,Edit:Cn},data(){return{show:!1}},computed:{...Object(U["d"])({isZenMode:e=>e.localConfig.isZenMode,isDark:e=>e.localConfig.isDark,activeSidebar:e=>e.activeSidebar})},watch:{isDark(){this.setBodyDark()}},async created(){this.initLocalConfig();const e=this.$loading({lock:!0,text:this.$t("other.loading")});await this.getUserMindMapData(),this.show=!0,e.close(),this.setBodyDark()},methods:{...Object(U["b"])(["getUserMindMapData"]),...Object(U["c"])(["setLocalConfig"]),initLocalConfig(){let e=Object(de["d"])();e&&this.setLocalConfig({...this.$store.state.localConfig,...e})},setBodyDark(){this.isDark?document.body.classList.add("isDark"):document.body.classList.remove("isDark")}}},_n=wn,xn=(i("2c92"),Object(m["a"])(_n,s,a,!1,null,null,null));t["default"]=xn.exports},"98fe":function(e,t,i){"use strict";i("c962")},"9c45":function(e,t,i){"use strict";i("7506")},a8a4:function(e,t,i){},a976:function(e,t,i){"use strict";i("1431")},aba9:function(e,t,i){"use strict";i("b44d")},abb3:function(e,t,i){},ac23:function(e,t,i){},aefb:function(e,t,i){"use strict";i("8a65")},afd0:function(e,t,i){},affe:function(e,t,i){},b44d:function(e,t,i){},b8e2:function(e,t,i){},b94b:function(e,t,i){},baab:function(e,t,i){},bcdf:function(e,t,i){"use strict";i("d12f")},c089:function(e,t,i){"use strict";i("ea7a")},c0bb:function(e,t,i){},c1c8:function(e,t,i){},c4f8:function(e,t,i){"use strict";i("affe")},c962:function(e,t,i){},c9b7:function(e,t,i){"use strict";i("30b5")},ca46:function(e,t,i){},ca70:function(e,t,i){"use strict";i("9194")},cc2a:function(e,t,i){},ce56:function(e,t,i){"use strict";i("40a8")},d104:function(e,t,i){"use strict";i("f030")},d12f:function(e,t,i){},d7a3:function(e,t,i){"use strict";i("870a")},d8f8:function(e,t,i){"use strict";i("c0bb")},df21:function(e,t,i){},e33c:function(e,t,i){"use strict";i("3a41")},ea7a:function(e,t,i){},ec72:function(e,t,i){"use strict";i("4125")},eedc:function(e,t,i){"use strict";i("5193")},f030:function(e,t,i){},f0d0:function(e,t,i){"use strict";i("cc2a")},f262:function(e,t,i){"use strict";i("319b")},f2ef:function(e,t,i){"use strict";i("6c88")},f656:function(e,t,i){"use strict";i("b8e2")},fcf2:function(e,t,i){"use strict";i("6e1c")},fea5:function(e,t,i){},ffd8:function(e,t,i){}}]);